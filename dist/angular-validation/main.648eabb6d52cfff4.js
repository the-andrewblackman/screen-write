"use strict";var EW=Object.defineProperty,AW=Object.defineProperties,kW=Object.getOwnPropertyDescriptors,$A=Object.getOwnPropertySymbols,TW=Object.prototype.hasOwnProperty,IW=Object.prototype.propertyIsEnumerable,UA=(xe,Nt,sn)=>Nt in xe?EW(xe,Nt,{enumerable:!0,configurable:!0,writable:!0,value:sn}):xe[Nt]=sn,xn=(xe,Nt)=>{for(var sn in Nt||(Nt={}))TW.call(Nt,sn)&&UA(xe,sn,Nt[sn]);if($A)for(var sn of $A(Nt))IW.call(Nt,sn)&&UA(xe,sn,Nt[sn]);return xe},na=(xe,Nt)=>AW(xe,kW(Nt));(self.webpackChunkangular_validation=self.webpackChunkangular_validation||[]).push([[179],{712:()=>{function xe(n){return"function"==typeof n}function Nt(n){const t=n(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const sn=Nt(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ra(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Mr{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(xe(r))try{r()}catch(s){e=s instanceof sn?s.errors:[s]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const s of i)try{ky(s)}catch(o){e=null!=e?e:[],o instanceof sn?e=[...e,...o.errors]:e.push(o)}}if(e)throw new sn(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ky(e);else{if(e instanceof Mr){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ra(t,e)}remove(e){const{_teardowns:t}=this;t&&ra(t,e),e instanceof Mr&&e._removeParent(this)}}Mr.EMPTY=(()=>{const n=new Mr;return n.closed=!0,n})();const Ey=Mr.EMPTY;function Ay(n){return n instanceof Mr||n&&"closed"in n&&xe(n.remove)&&xe(n.add)&&xe(n.unsubscribe)}function ky(n){xe(n)?n():n.unsubscribe()}const rs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ql={setTimeout(...n){const{delegate:e}=ql;return((null==e?void 0:e.setTimeout)||setTimeout)(...n)},clearTimeout(n){const{delegate:e}=ql;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function Ty(n){ql.setTimeout(()=>{const{onUnhandledError:e}=rs;if(!e)throw n;e(n)})}function Kl(){}const WA=jf("C",void 0,void 0);function jf(n,e,t){return{kind:n,value:e,error:t}}let is=null;function Ql(n){if(rs.useDeprecatedSynchronousErrorHandling){const e=!is;if(e&&(is={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:r}=is;if(is=null,t)throw r}}else n()}class $f extends Mr{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ay(e)&&e.add(this)):this.destination=KA}static create(e,t,r){return new Uf(e,t,r)}next(e){this.isStopped?Gf(jf("N",e,void 0),this):this._next(e)}error(e){this.isStopped?Gf(jf("E",void 0,e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Gf(WA,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Uf extends $f{constructor(e,t,r){let i;if(super(),xe(e))i=e;else if(e){let s;({next:i,error:t,complete:r}=e),this&&rs.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,i=null==i?void 0:i.bind(s),t=null==t?void 0:t.bind(s),r=null==r?void 0:r.bind(s)}this.destination={next:i?Wf(i):Kl,error:Wf(null!=t?t:Iy),complete:r?Wf(r):Kl}}}function Wf(n,e){return(...t)=>{try{n(...t)}catch(r){rs.useDeprecatedSynchronousErrorHandling?function(n){rs.useDeprecatedSynchronousErrorHandling&&is&&(is.errorThrown=!0,is.error=n)}(r):Ty(r)}}}function Iy(n){throw n}function Gf(n,e){const{onStoppedNotification:t}=rs;t&&ql.setTimeout(()=>t(n,e))}const KA={closed:!0,next:Kl,error:Iy,complete:Kl},zf="function"==typeof Symbol&&Symbol.observable||"@@observable";function Oy(n){return n}let on=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){const s=function(n){return n&&n instanceof $f||function(n){return n&&xe(n.next)&&xe(n.error)&&xe(n.complete)}(n)&&Ay(n)}(t)?t:new Uf(t,r,i);return Ql(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=Py(r))((i,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),null==o||o.unsubscribe()}},s,i)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[zf](){return this}pipe(...t){return function(n){return 0===n.length?Oy:1===n.length?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}(t)(this)}toPromise(t){return new(t=Py(t))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function Py(n){var e;return null!==(e=null!=n?n:rs.Promise)&&void 0!==e?e:Promise}const JA=Nt(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let qf=(()=>{class n extends on{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new Ry(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new JA}next(t){Ql(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(t)}})}error(t){Ql(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ql(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Ey:(s.push(t),new Mr(()=>ra(s,t)))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){const t=new on;return t.source=this,t}}return n.create=(e,t)=>new Ry(e,t),n})();class Ry extends qf{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)}error(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:Ey}}function Is(n){return e=>{if(function(n){return xe(null==n?void 0:n.lift)}(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class Os extends $f{constructor(e,t,r,i,s){super(e),this.onFinalize=s,this._next=t?function(o){try{t(o)}catch(a){e.error(a)}}:super._next,this._error=i?function(o){try{i(o)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function Kf(n,e){return Is((t,r)=>{let i=0;t.subscribe(new Os(r,s=>{r.next(n.call(e,s,i++))}))})}function ss(n){return this instanceof ss?(this.v=n,this):new ss(n)}function tk(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=t.apply(n,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(g){r[g]&&(i[g]=function(v){return new Promise(function(C,D){s.push([g,v,C,D])>1||a(g,v)})})}function a(g,v){try{!function(g){g.value instanceof ss?Promise.resolve(g.value.v).then(u,c):d(s[0][2],g)}(r[g](v))}catch(C){d(s[0][3],C)}}function u(g){a("next",g)}function c(g){a("throw",g)}function d(g,v){g(v),s.shift(),s.length&&a(s[0][0],s[0][1])}}function nk(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const By=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Hy(n){return xe(null==n?void 0:n.then)}function jy(n){return xe(n[zf])}function $y(n){return Symbol.asyncIterator&&xe(null==n?void 0:n[Symbol.asyncIterator])}function Uy(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Wy="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Gy(n){return xe(null==n?void 0:n[Wy])}function zy(n){return tk(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:r,done:i}=yield ss(t.read());if(i)return yield ss(void 0);yield yield ss(r)}}finally{t.releaseLock()}})}function qy(n){return xe(null==n?void 0:n.getReader)}function os(n){if(n instanceof on)return n;if(null!=n){if(jy(n))return function(n){return new on(e=>{const t=n[zf]();if(xe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(By(n))return function(n){return new on(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Hy(n))return function(n){return new on(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ty)})}(n);if($y(n))return Ky(n);if(Gy(n))return function(n){return new on(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(qy(n))return function(n){return Ky(zy(n))}(n)}throw Uy(n)}function Ky(n){return new on(e=>{(function(n,e){var t,r,i,s;return function(n,e,t,r){return new(t||(t=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=nk(n);!(r=yield t.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function wi(n,e,t,r=0,i=!1){const s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Qy(n,e,t=1/0){return xe(e)?Qy((r,i)=>Kf((s,o)=>e(r,s,i,o))(os(n(r,i))),t):("number"==typeof e&&(t=e),Is((r,i)=>function(n,e,t,r,i,s,o,a){const l=[];let u=0,c=0,d=!1;const g=()=>{d&&!l.length&&!u&&e.complete()},v=D=>u<r?C(D):l.push(D),C=D=>{u++;let M=!1;os(t(D,c++)).subscribe(new Os(e,x=>{e.next(x)},()=>{M=!0},void 0,()=>{if(M)try{for(u--;l.length&&u<r;){const x=l.shift();C(x)}g()}catch(x){e.error(x)}}))};return n.subscribe(new Os(e,v,()=>{d=!0,g()})),()=>{}}(r,i,n,t)))}const Yf=new on(n=>n.complete());function Jf(n){return n[n.length-1]}function Yy(n,e=0){return Is((t,r)=>{t.subscribe(new Os(r,i=>wi(r,n,()=>r.next(i),e),()=>wi(r,n,()=>r.complete(),e),i=>wi(r,n,()=>r.error(i),e)))})}function Jy(n,e=0){return Is((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Zy(n,e){if(!n)throw new Error("Iterable cannot be null");return new on(t=>{wi(t,e,()=>{const r=n[Symbol.asyncIterator]();wi(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Zf(n,e){return e?function(n,e){if(null!=n){if(jy(n))return function(n,e){return os(n).pipe(Jy(e),Yy(e))}(n,e);if(By(n))return function(n,e){return new on(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}(n,e);if(Hy(n))return function(n,e){return os(n).pipe(Jy(e),Yy(e))}(n,e);if($y(n))return Zy(n,e);if(Gy(n))return function(n,e){return new on(t=>{let r;return wi(t,e,()=>{r=n[Wy](),wi(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>xe(null==r?void 0:r.return)&&r.return()})}(n,e);if(qy(n))return function(n,e){return Zy(zy(n),e)}(n,e)}throw Uy(n)}(n,e):os(n)}function Mk(...n){const e=function(n){return function(n){return n&&xe(n.schedule)}(Jf(n))?n.pop():void 0}(n),t=function(n,e){return"number"==typeof Jf(n)?n.pop():1/0}(n),r=n;return r.length?1===r.length?os(r[0]):function(n=1/0){return Qy(Oy,n)}(t)(Zf(r,e)):Yf}function Xf(n,e,...t){return!0===e?(n(),null):!1===e?null:e(...t).pipe(Is((e,t)=>{let r=0;e.subscribe(new Os(t,i=>{++r<=1&&(t.next(i),1<=r&&t.complete())}))})).subscribe(()=>n())}function Ve(n){for(let e in n)if(n[e]===Ve)return e;throw Error("Could not find renamed property on target object.")}function eh(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ne(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Ne).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function th(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Ek=Ve({__forward_ref__:Ve});function Ge(n){return n.__forward_ref__=Ge,n.toString=function(){return Ne(this())},n}function de(n){return Xy(n)?n():n}function Xy(n){return"function"==typeof n&&n.hasOwnProperty(Ek)&&n.__forward_ref__===Ge}class De extends Error{constructor(e,t){super(function(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function an(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():function(n){return"string"==typeof n?n:null==n?"":String(n)}(n)}function Yl(n,e){const t=e?` in ${e}`:"";throw new De(-201,`No provider for ${an(n)} found${t}`)}function An(n,e){null==n&&function(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}(e,n,null,"!=")}function rt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ii(n){return{providers:n.providers||[],imports:n.imports||[]}}function rh(n){return ev(n,Jl)||ev(n,nv)}function ev(n,e){return n.hasOwnProperty(e)?n[e]:null}function tv(n){return n&&(n.hasOwnProperty(ih)||n.hasOwnProperty(Pk))?n[ih]:null}const Jl=Ve({\u0275prov:Ve}),ih=Ve({\u0275inj:Ve}),nv=Ve({ngInjectableDef:Ve}),Pk=Ve({ngInjectorDef:Ve});var pe=(()=>((pe=pe||{})[pe.Default=0]="Default",pe[pe.Host=1]="Host",pe[pe.Self=2]="Self",pe[pe.SkipSelf=4]="SkipSelf",pe[pe.Optional=8]="Optional",pe))();let sh;function Ci(n){const e=sh;return sh=n,e}function rv(n,e,t){const r=rh(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&pe.Optional?null:void 0!==e?e:void Yl(Ne(n),"Injector")}function bi(n){return{toString:n}.toString()}var $n=(()=>(($n=$n||{})[$n.OnPush=0]="OnPush",$n[$n.Default=1]="Default",$n))(),Sr=(()=>{return(n=Sr||(Sr={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Sr;var n})();const Fk="undefined"!=typeof globalThis&&globalThis,Lk="undefined"!=typeof window&&window,Vk="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Re=Fk||"undefined"!=typeof global&&global||Lk||Vk,Ns={},Be=[],Zl=Ve({\u0275cmp:Ve}),oh=Ve({\u0275dir:Ve}),ah=Ve({\u0275pipe:Ve}),iv=Ve({\u0275mod:Ve}),si=Ve({\u0275fac:Ve}),ia=Ve({__NG_ELEMENT_ID__:Ve});let Bk=0;function lh(n){return bi(()=>{const t={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===$n.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Be,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Sr.Emulated,id:"c",styles:n.styles||Be,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.directives,s=n.features,o=n.pipes;return r.id+=Bk++,r.inputs=lv(n.inputs,t),r.outputs=lv(n.outputs),s&&s.forEach(a=>a(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(sv):null,r.pipeDefs=o?()=>("function"==typeof o?o():o).map(ov):null,r})}function sv(n){return $t(n)||function(n){return n[oh]||null}(n)}function ov(n){return function(n){return n[ah]||null}(n)}const av={};function Di(n){return bi(()=>{const e={type:n.type,bootstrap:n.bootstrap||Be,declarations:n.declarations||Be,imports:n.imports||Be,exports:n.exports||Be,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(av[n.id]=n.type),e})}function lv(n,e){if(null==n)return Ns;const t={};for(const r in n)if(n.hasOwnProperty(r)){let i=n[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=r,e&&(e[i]=s)}return t}const ce=lh;function $t(n){return n[Zl]||null}function Un(n,e){const t=n[iv]||null;if(!t&&!0===e)throw new Error(`Type ${Ne(n)} does not have '\u0275mod' property.`);return t}function xr(n){return Array.isArray(n)&&"object"==typeof n[1]}function ar(n){return Array.isArray(n)&&!0===n[1]}function fh(n){return 0!=(8&n.flags)}function nu(n){return 2==(2&n.flags)}function ru(n){return 1==(1&n.flags)}function lr(n){return null!==n.template}function Gk(n){return 0!=(512&n[2])}function fs(n,e){return n.hasOwnProperty(si)?n[si]:null}class Kk{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Er(){return cv}function cv(n){return n.type.prototype.ngOnChanges&&(n.setInput=Yk),Qk}function Qk(){const n=hv(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===Ns)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Yk(n,e,t,r){const i=hv(n)||function(n,e){return n[fv]=e}(n,{previous:Ns,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Kk(l&&l.currentValue,e,o===Ns),n[r]=e}Er.ngInherit=!0;const fv="__ngSimpleChanges__";function hv(n){return n[fv]||null}const dv="http://www.w3.org/2000/svg";let ph;function ot(n){return!!n.listen}const gv={createRenderer:(n,e)=>void 0!==ph?ph:"undefined"!=typeof document?document:void 0};function mt(n){for(;Array.isArray(n);)n=n[0];return n}function zn(n,e){return mt(e[n.index])}function mh(n,e){return n.data[e]}function Tn(n,e){const t=e[n];return xr(t)?t:t[0]}function mv(n){return 4==(4&n[2])}function yh(n){return 128==(128&n[2])}function Mi(n,e){return null==e?null:n[e]}function yv(n){n[18]=0}function vh(n,e){n[5]+=e;let t=n,r=n[3];for(;null!==r&&(1===e&&1===t[5]||-1===e&&0===t[5]);)r[5]+=e,t=r,r=r[3]}const se={lFrame:Sv(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function vv(){return se.bindingsEnabled}function B(){return se.lFrame.lView}function _e(){return se.lFrame.tView}function la(n){return se.lFrame.contextLView=n,n[8]}function Ct(){let n=wv();for(;null!==n&&64===n.type;)n=n.parent;return n}function wv(){return se.lFrame.currentTNode}function Ar(n,e){const t=se.lFrame;t.currentTNode=n,t.isParent=e}function wh(){return se.lFrame.isParent}function su(){return se.isInCheckNoChangesMode}function ou(n){se.isInCheckNoChangesMode=n}function fT(n,e){const t=se.lFrame;t.bindingIndex=t.bindingRootIndex=n,bh(e)}function bh(n){se.lFrame.currentDirectiveIndex=n}function Dv(){return se.lFrame.currentQueryIndex}function _h(n){se.lFrame.currentQueryIndex=n}function dT(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function _v(n,e,t){if(t&pe.SkipSelf){let i=e,s=n;for(;!(i=i.parent,null!==i||t&pe.Host||(i=dT(s),null===i||(s=s[15],10&i.type))););if(null===i)return!1;e=i,n=s}const r=se.lFrame=Mv();return r.currentTNode=e,r.lView=n,!0}function au(n){const e=Mv(),t=n[1];se.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Mv(){const n=se.lFrame,e=null===n?null:n.child;return null===e?Sv(n):e}function Sv(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function xv(){const n=se.lFrame;return se.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Ev=xv;function lu(){const n=xv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function un(){return se.lFrame.selectedIndex}function Si(n){se.lFrame.selectedIndex=n}function ca(){se.lFrame.currentNamespace=dv}function fa(){se.lFrame.currentNamespace=null}function uu(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),u&&((n.viewHooks||(n.viewHooks=[])).push(t,u),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,u)),null!=c&&(n.destroyHooks||(n.destroyHooks=[])).push(t,c)}}function cu(n,e,t){Av(n,e,3,t)}function fu(n,e,t,r){(3&n[2])===t&&Av(n,e,t,r)}function Mh(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Av(n,e,t,r){const s=null!=r?r:-1,o=e.length-1;let a=0;for(let l=void 0!==r?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=r&&a>=r)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(CT(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function CT(n,e,t,r){const i=t[r]<0,s=t[r+1],a=n[i?-t[r]:t[r]];if(i){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class ha{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function hu(n,e,t){const r=ot(n);let i=0;for(;i<t.length;){const s=t[i];if("number"==typeof s){if(0!==s)break;i++;const o=t[i++],a=t[i++],l=t[i++];r?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++i];xh(o)?r&&n.setProperty(e,o,a):r?n.setAttribute(e,o,a):e.setAttribute(o,a),i++}}return i}function kv(n){return 3===n||4===n||6===n}function xh(n){return 64===n.charCodeAt(0)}function du(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?t=i:0===t||Tv(n,t,i,null,-1===t||2===t?e[++r]:null)}}return n}function Tv(n,e,t,r,i){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===r)return void(null!==i&&(n[s+1]=i));if(r===n[s+1])return void(n[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==r&&n.splice(s++,0,r),null!==i&&n.splice(s++,0,i)}function Iv(n){return-1!==n}function Hs(n){return 32767&n}function js(n,e){let t=function(n){return n>>16}(n),r=e;for(;t>0;)r=r[15],t--;return r}let Eh=!0;function pu(n){const e=Eh;return Eh=n,e}let xT=0;function pa(n,e){const t=kh(n,e);if(-1!==t)return t;const r=e[1];r.firstCreatePass&&(n.injectorIndex=e.length,Ah(r.data,n),Ah(e,null),Ah(r.blueprint,null));const i=gu(n,e),s=n.injectorIndex;if(Iv(i)){const o=Hs(i),a=js(i,e),l=a[1].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|l[o+u]}return e[s+8]=i,s}function Ah(n,e){n.push(0,0,0,0,0,0,0,0,e)}function kh(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function gu(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;null!==i;){const s=i[1],o=s.type;if(r=2===o?s.declTNode:1===o?i[6]:null,null===r)return-1;if(t++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return-1}function mu(n,e,t){!function(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(ia)&&(r=t[ia]),null==r&&(r=t[ia]=xT++);const i=255&r;e.data[n+(i>>5)]|=1<<i}(n,e,t)}function Pv(n,e,t){if(t&pe.Optional)return n;Yl(e,"NodeInjector")}function Rv(n,e,t,r){if(t&pe.Optional&&void 0===r&&(r=null),0==(t&(pe.Self|pe.Host))){const i=n[9],s=Ci(void 0);try{return i?i.get(e,r,t&pe.Optional):rv(e,r,t&pe.Optional)}finally{Ci(s)}}return Pv(r,e,t)}function Fv(n,e,t,r=pe.Default,i){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ia)?n[ia]:void 0;return"number"==typeof e?e>=0?255&e:kT:e}(t);if("function"==typeof s){if(!_v(e,n,r))return r&pe.Host?Pv(i,t,r):Rv(e,t,r,i);try{const o=s(r);if(null!=o||r&pe.Optional)return o;Yl(t)}finally{Ev()}}else if("number"==typeof s){let o=null,a=kh(n,e),l=-1,u=r&pe.Host?e[16][6]:null;for((-1===a||r&pe.SkipSelf)&&(l=-1===a?gu(n,e):e[a+8],-1!==l&&Bv(r,!1)?(o=e[1],a=Hs(l),e=js(l,e)):a=-1);-1!==a;){const c=e[1];if(Vv(s,a,c.data)){const d=TT(a,e,t,o,r,u);if(d!==Lv)return d}l=e[a+8],-1!==l&&Bv(r,e[1].data[a+8]===u)&&Vv(s,a,e)?(o=c,a=Hs(l),e=js(l,e)):a=-1}}}return Rv(e,t,r,i)}const Lv={};function kT(){return new $s(Ct(),B())}function TT(n,e,t,r,i,s){const o=e[1],a=o.data[n+8],c=yu(a,o,t,null==r?nu(a)&&Eh:r!=o&&0!=(3&a.type),i&pe.Host&&s===a);return null!==c?ga(e,o,c,a):Lv}function yu(n,e,t,r,i){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,c=s>>20,g=i?a+c:n.directiveEnd;for(let v=r?a:a+c;v<g;v++){const C=o[v];if(v<l&&t===C||v>=l&&C.type===t)return v}if(i){const v=o[l];if(v&&lr(v)&&v.type===t)return l}return null}function ga(n,e,t,r){let i=n[t];const s=e.data;if(function(n){return n instanceof ha}(i)){const o=i;o.resolving&&function(n,e){throw new De(-200,`Circular dependency in DI detected for ${n}`)}(an(s[t]));const a=pu(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ci(o.injectImpl):null;_v(n,r,pe.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&function(n,e,t){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=cv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}i&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,i),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&Ci(l),pu(a),o.resolving=!1,Ev()}}return i}function Vv(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Bv(n,e){return!(n&pe.Self||n&pe.Host&&e)}class $s{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return Fv(this._tNode,this._lView,e,r,t)}}function Dn(n){return bi(()=>{const e=n.prototype.constructor,t=e[si]||Th(e),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const s=i[si]||Th(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Th(n){return Xy(n)?()=>{const e=Th(de(n));return e&&e()}:fs(n)}const Ws="__parameters__";function zs(n,e,t){return bi(()=>{const r=function(n){return function(...t){if(n){const r=n(...t);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(l,u,c){const d=l.hasOwnProperty(Ws)?l[Ws]:Object.defineProperty(l,Ws,{value:[]})[Ws];for(;d.length<=c;)d.push(null);return(d[c]=d[c]||[]).push(o),l}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}class Me{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=rt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function qn(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)?(e===n&&(e=n.slice(0,t)),qn(r,e)):e!==n&&e.push(r)}return e}function kr(n,e){n.forEach(t=>Array.isArray(t)?kr(t,e):e(t))}function Hv(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function vu(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function In(n,e,t){let r=qs(n,e);return r>=0?n[1|r]=t:(r=~r,function(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(1===i)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;)n[i]=n[i-2],i--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function Ph(n,e){const t=qs(n,e);if(t>=0)return n[1|t]}function qs(n,e){return function(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){const s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}(n,e,1)}const Ca={},Fh="__NG_DI_FLAG__",Cu="ngTempTokenPath",$T=/\n/gm,Gv="__source",WT=Ve({provide:String,useValue:Ve});let ba;function zv(n){const e=ba;return ba=n,e}function GT(n,e=pe.Default){if(void 0===ba)throw new De(203,"");return null===ba?rv(n,void 0,e):ba.get(n,e&pe.Optional?null:void 0,e)}function qe(n,e=pe.Default){return(sh||GT)(de(n),e)}function Lh(n){const e=[];for(let t=0;t<n.length;t++){const r=de(n[t]);if(Array.isArray(r)){if(0===r.length)throw new De(900,"");let i,s=pe.Default;for(let o=0;o<r.length;o++){const a=r[o],l=zT(a);"number"==typeof l?-1===l?i=a.token:s|=l:i=a}e.push(qe(i,s))}else e.push(qe(r))}return e}function Da(n,e){return n[Fh]=e,n.prototype[Fh]=e,n}function zT(n){return n[Fh]}const bu=Da(zs("Inject",n=>({token:n})),-1),Ks=Da(zs("Optional"),8),_a=Da(zs("SkipSelf"),4);const d0="__ngContext__";function Wt(n,e){n[d0]=e}function zh(n){const e=function(n){return n[d0]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Kh(n){return n.ngOriginalError}function VI(n,...e){n.error(...e)}class Js{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),r=(n=e)&&n.ngErrorLogger||VI;var n;r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Kh(e);for(;t&&Kh(t);)t=Kh(t);return t||null}}const v0=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Re))();function Ir(n){return n instanceof Function?n():n}var On=(()=>((On=On||{})[On.Important=1]="Important",On[On.DashCase=2]="DashCase",On))();function Yh(n,e){return undefined(n,e)}function ka(n){const e=n[3];return ar(e)?e[3]:e}function Jh(n){return _0(n[13])}function Zh(n){return _0(n[4])}function _0(n){for(;null!==n&&!ar(n);)n=n[4];return n}function Xs(n,e,t,r,i){if(null!=r){let s,o=!1;ar(r)?s=r:xr(r)&&(o=!0,r=r[0]);const a=mt(r);0===n&&null!==t?null==i?k0(e,t,a):hs(e,t,a,i||null,!0):1===n&&null!==t?hs(e,t,a,i||null,!0):2===n?function(n,e,t){const r=Eu(n,e);r&&function(n,e,t,r){ot(n)?n.removeChild(e,t,r):e.removeChild(t)}(n,r,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,r,i){const s=t[7];s!==mt(t)&&Xs(e,n,r,s,i);for(let a=10;a<t.length;a++){const l=t[a];Ta(l[1],l,n,e,r,s)}}(e,n,s,t,i)}}function ed(n,e,t){return ot(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function S0(n,e){const t=n[9],r=t.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,vh(i,-1)),t.splice(r,1)}function td(n,e){if(n.length<=10)return;const t=10+e,r=n[t];if(r){const i=r[17];null!==i&&i!==n&&S0(i,r),e>0&&(n[t-1][4]=r[4]);const s=vu(n,10+e);!function(n,e){Ta(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const o=s[19];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function x0(n,e){if(!(256&e[2])){const t=e[11];ot(t)&&t.destroyNode&&Ta(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return nd(n[1],n);for(;e;){let t=null;if(xr(e))t=e[13];else{const r=e[10];r&&(t=r)}if(!t){for(;e&&!e[4]&&e!==n;)xr(e)&&nd(e[1],e),e=e[3];null===e&&(e=n),xr(e)&&nd(e[1],e),t=e&&e[4]}e=t}}(e)}}function nd(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const i=e[t[r]];if(!(i instanceof ha)){const s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(i)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,r=e[7];let i=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):mt(e[o]),l=r[i=t[s+2]],u=t[s+3];"boolean"==typeof u?a.removeEventListener(t[s],l,u):u>=0?r[i=u]():r[i=-u].unsubscribe(),s+=2}else{const o=r[i=t[s+1]];t[s].call(o)}if(null!==r){for(let s=i+1;s<r.length;s++)r[s]();e[7]=null}}(n,e),1===e[1].type&&ot(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&ar(e[3])){t!==e[3]&&S0(t,e);const r=e[19];null!==r&&r.detachView(n)}}}function E0(n,e,t){return function(n,e,t){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return t[0];if(2&r.flags){const i=n.data[r.directiveStart].encapsulation;if(i===Sr.None||i===Sr.Emulated)return null}return zn(r,t)}(n,e.parent,t)}function hs(n,e,t,r,i){ot(n)?n.insertBefore(e,t,r,i):e.insertBefore(t,r,i)}function k0(n,e,t){ot(n)?n.appendChild(e,t):e.appendChild(t)}function T0(n,e,t,r,i){null!==r?hs(n,e,t,r,i):k0(n,e,t)}function Eu(n,e){return ot(n)?n.parentNode(e):e.parentNode}let N0=function(n,e,t){return 40&n.type?zn(n,t):null};function Au(n,e,t,r){const i=E0(n,r,e),s=e[11],a=function(n,e,t){return N0(n,e,t)}(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(t))for(let l=0;l<t.length;l++)T0(s,i,t[l],a,!1);else T0(s,i,t,a,!1)}function ku(n,e){if(null!==e){const t=e.type;if(3&t)return zn(e,n);if(4&t)return id(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return ku(n,r);{const i=n[e.index];return ar(i)?id(-1,i):mt(i)}}if(32&t)return Yh(e,n)()||mt(n[e.index]);{const r=R0(n,e);return null!==r?Array.isArray(r)?r[0]:ku(ka(n[16]),r):ku(n,e.next)}}return null}function R0(n,e){return null!==e?n[16][6].projection[e.projection]:null}function id(n,e){const t=10+n+1;if(t<e.length){const r=e[t],i=r[1].firstChild;if(null!==i)return ku(r,i)}return e[7]}function sd(n,e,t,r,i,s,o){for(;null!=t;){const a=r[t.index],l=t.type;if(o&&0===e&&(a&&Wt(mt(a),r),t.flags|=4),64!=(64&t.flags))if(8&l)sd(n,e,t.child,r,i,s,!1),Xs(e,n,i,a,s);else if(32&l){const u=Yh(t,r);let c;for(;c=u();)Xs(e,n,i,c,s);Xs(e,n,i,a,s)}else 16&l?L0(n,e,r,t,i,s):Xs(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Ta(n,e,t,r,i,s){sd(t,r,n.firstChild,e,i,s,!1)}function L0(n,e,t,r,i,s){const o=t[16],l=o[6].projection[r.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)Xs(e,n,i,l[u],s);else sd(n,e,l,o[3],i,s,!0)}function V0(n,e,t){ot(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function od(n,e,t){ot(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function B0(n,e,t){let r=n.length;for(;;){const i=n.indexOf(e,t);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}const H0="ng-template";function hO(n,e,t){let r=0;for(;r<n.length;){let i=n[r++];if(t&&"class"===i){if(i=n[r],-1!==B0(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<n.length&&"string"==typeof(i=n[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function j0(n){return 4===n.type&&n.value!==H0}function dO(n,e,t){return e===(4!==n.type||t?n.value:H0)}function pO(n,e,t){let r=4;const i=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(kv(n[e]))return e;return n.length}(i);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!dO(n,l,t)||""===l&&1===e.length){if(ur(r))return!1;o=!0}}else{const u=8&r?l:e[++a];if(8&r&&null!==n.attrs){if(!hO(n.attrs,u,t)){if(ur(r))return!1;o=!0}continue}const d=gO(8&r?"class":l,i,j0(n),t);if(-1===d){if(ur(r))return!1;o=!0;continue}if(""!==u){let g;g=d>s?"":i[d+1].toLowerCase();const v=8&r?g:null;if(v&&-1!==B0(v,u,0)||2&r&&u!==g){if(ur(r))return!1;o=!0}}}}else{if(!o&&!ur(r)&&!ur(l))return!1;if(o&&ur(l))continue;o=!1,r=l|1&r}}return ur(r)||o}function ur(n){return 0==(1&n)}function gO(n,e,t,r){if(null===e)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===n)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function $0(n,e,t=!1){for(let r=0;r<e.length;r++)if(pO(n,e[r],t))return!0;return!1}function U0(n,e){return n?":not("+e.trim()+")":e}function CO(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&r){const a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!ur(o)&&(e+=U0(s,i),i=""),r=o,s=s||!ur(r);t++}return""!==i&&(e+=U0(s,i)),e}const fe={};function Ia(n){W0(_e(),B(),un()+n,su())}function W0(n,e,t,r){if(!r)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&cu(e,s,t)}else{const s=n.preOrderHooks;null!==s&&fu(e,s,0,t)}Si(t)}function Tu(n,e){return n<<17|e<<2}function cr(n){return n>>17&32767}function ad(n){return 2|n}function li(n){return(131068&n)>>2}function ld(n,e){return-131069&n|e<<2}function ud(n){return 1|n}function tw(n,e){const t=n.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];if(-1!==s){const o=n.data[s];_h(i),o.contentQueries(2,e[s],s)}}}function Oa(n,e,t,r,i,s,o,a,l,u){const c=e.blueprint.slice();return c[0]=i,c[2]=140|r,yv(c),c[3]=c[15]=n,c[8]=t,c[10]=o||n&&n[10],c[11]=a||n&&n[11],c[12]=l||n&&n[12]||null,c[9]=u||n&&n[9]||null,c[6]=s,c[16]=2==e.type?n[16]:c,c}function eo(n,e,t,r,i){let s=n.data[e];if(null===s)s=function(n,e,t,r,i){const s=wv(),o=wh(),l=n.data[e]=function(n,e,t,r,i,s){return{type:t,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,r,i);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,r,i),se.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=r,s.attrs=i;const o=function(){const n=se.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ar(s,!0),s}function to(n,e,t,r){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Na(n,e,t){au(e);try{const r=n.viewQuery;null!==r&&Ed(1,r,t);const i=n.template;null!==i&&nw(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&tw(n,e),n.staticViewQueries&&Ed(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)nN(n,e[t])}(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[2]&=-5,lu()}}function no(n,e,t,r){const i=e[2];if(256==(256&i))return;au(e);const s=su();try{yv(e),function(n){se.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&nw(n,e,t,2,r);const o=3==(3&i);if(!s)if(o){const u=n.preOrderCheckHooks;null!==u&&cu(e,u,null)}else{const u=n.preOrderHooks;null!==u&&fu(e,u,0,null),Mh(e,0)}if(function(n){for(let e=Jh(n);null!==e;e=Zh(e)){if(!e[2])continue;const t=e[9];for(let r=0;r<t.length;r++){const i=t[r],s=i[3];0==(1024&i[2])&&vh(s,1),i[2]|=1024}}}(e),function(n){for(let e=Jh(n);null!==e;e=Zh(e))for(let t=10;t<e.length;t++){const r=e[t],i=r[1];yh(r)&&no(i,r,i.template,r[8])}}(e),null!==n.contentQueries&&tw(n,e),!s)if(o){const u=n.contentCheckHooks;null!==u&&cu(e,u)}else{const u=n.contentHooks;null!==u&&fu(e,u,1),Mh(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let r=0;r<t.length;r++){const i=t[r];if(i<0)Si(~i);else{const s=i,o=t[++r],a=t[++r];fT(o,s),a(2,e[s])}}}finally{Si(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)tN(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Ed(2,l,r),!s)if(o){const u=n.viewCheckHooks;null!==u&&cu(e,u)}else{const u=n.viewHooks;null!==u&&fu(e,u,2),Mh(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,vh(e[3],-1))}finally{lu()}}function FO(n,e,t,r){const i=e[10],s=!su(),o=mv(e);try{s&&!o&&i.begin&&i.begin(),o&&Na(n,e,r),no(n,e,t,r)}finally{s&&!o&&i.end&&i.end()}}function nw(n,e,t,r,i){const s=un(),o=2&r;try{Si(-1),o&&e.length>20&&W0(n,e,20,su()),t(r,i)}finally{Si(s)}}function wd(n,e,t){!vv()||(function(n,e,t,r){const i=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||pa(t,e),Wt(r,e);const o=t.initialInputs;for(let a=i;a<s;a++){const l=n.data[a],u=lr(l);u&&YO(e,t,l);const c=ga(e,n,a,t);Wt(c,e),null!==o&&JO(0,a-i,c,l,0,o),u&&(Tn(t.index,e)[8]=c)}}(n,e,t,zn(t,e)),128==(128&t.flags)&&function(n,e,t){const r=t.directiveStart,i=t.directiveEnd,o=t.index,a=se.lFrame.currentDirectiveIndex;try{Si(o);for(let l=r;l<i;l++){const u=n.data[l],c=e[l];bh(l),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&fw(u,c)}}finally{Si(-1),bh(a)}}(n,e,t))}function Cd(n,e,t=zn){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?t(e,n):n[o];n[i++]=a}}}function iw(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Nu(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Nu(n,e,t,r,i,s,o,a,l,u){const c=20+r,d=c+i,g=function(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:fe);return t}(c,d),v="function"==typeof u?u():u;return g[1]={type:n,blueprint:g,template:t,queries:null,viewQuery:a,declTNode:e,data:g.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:v,incompleteFirstPass:!1}}function aw(n,e,t,r){const i=yw(e);null===t?i.push(r):(i.push(t),n.firstCreatePass&&vw(n).push(r,i.length-1))}function lw(n,e,t){for(let r in n)if(n.hasOwnProperty(r)){const i=n[r];(t=null===t?{}:t).hasOwnProperty(r)?t[r].push(e,i):t[r]=[e,i]}return t}function bd(n,e,t,r){let i=!1;if(vv()){const s=function(n,e,t){const r=n.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];$0(t,o.selectors,!1)&&(i||(i=[]),mu(pa(t,e),n,o.type),lr(o)?(hw(n,t),i.unshift(o)):i.push(o))}return i}(n,e,t),o=null===r?null:{"":-1};if(null!==s){i=!0,dw(t,n.data.length,s.length);for(let c=0;c<s.length;c++){const d=s[c];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,u=to(n,e,s.length,null);for(let c=0;c<s.length;c++){const d=s[c];t.mergedAttrs=du(t.mergedAttrs,d.hostAttrs),pw(n,t,e,u,d),QO(u,d,o),null!==d.contentQueries&&(t.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=128);const g=d.type.prototype;!a&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(g.ngOnChanges||g.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),u++}!function(n,e){const r=e.directiveEnd,i=n.data,s=e.attrs,o=[];let a=null,l=null;for(let u=e.directiveStart;u<r;u++){const c=i[u],d=c.inputs,g=null===s||j0(e)?null:ZO(d,s);o.push(g),a=lw(d,u,a),l=lw(c.outputs,u,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const r=n.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new De(-301,`Export of name '${e[i+1]}' not found!`);r.push(e[i],s)}}}(t,r,o)}return t.mergedAttrs=du(t.mergedAttrs,t.attrs),i}function cw(n,e,t,r,i,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(r,i,o)}}function fw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function hw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function QO(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;lr(e)&&(t[""]=n)}}function dw(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function pw(n,e,t,r,i){n.data[r]=i;const s=i.factory||(i.factory=fs(i.type)),o=new ha(s,lr(i),null);n.blueprint[r]=o,t[r]=o,cw(n,e,0,r,to(n,t,i.hostVars,fe),i)}function YO(n,e,t){const r=zn(e,n),i=iw(t),s=n[10],o=Pu(n,Oa(n,i,null,t.onPush?64:16,r,e,s,s.createRenderer(r,t),null,null));n[e.index]=o}function JO(n,e,t,r,i,s){const o=s[e];if(null!==o){const a=r.setInput;for(let l=0;l<o.length;){const u=o[l++],c=o[l++],d=o[l++];null!==a?r.setInput(t,d,u,c):t[c]=d}}}function ZO(n,e){let t=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;n.hasOwnProperty(i)&&(null===t&&(t=[]),t.push(i,n[i],e[r+1])),r+=2}else r+=2;else r+=4}return t}function gw(n,e,t,r){return new Array(n,!0,!1,e,null,0,r,t,null,null)}function tN(n,e){const t=Tn(e,n);if(yh(t)){const r=t[1];80&t[2]?no(r,t,r.template,t[8]):t[5]>0&&_d(t)}}function _d(n){for(let r=Jh(n);null!==r;r=Zh(r))for(let i=10;i<r.length;i++){const s=r[i];if(1024&s[2]){const o=s[1];no(o,s,o.template,s[8])}else s[5]>0&&_d(s)}const t=n[1].components;if(null!==t)for(let r=0;r<t.length;r++){const i=Tn(t[r],n);yh(i)&&i[5]>0&&_d(i)}}function nN(n,e){const t=Tn(e,n),r=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(r,t),Na(r,t,t[8])}function Pu(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Md(n){for(;n;){n[2]|=64;const e=ka(n);if(Gk(n)&&!e)return n;n=e}return null}function xd(n,e,t){const r=e[10];r.begin&&r.begin();try{no(n,e,n.template,t)}catch(i){throw Cw(e,i),i}finally{r.end&&r.end()}}function mw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],r=zh(t),i=r[1];FO(i,r,i.template,t)}}(n[8])}function Ed(n,e,t){_h(0),e(n,t)}const aN=(()=>Promise.resolve(null))();function yw(n){return n[7]||(n[7]=[])}function vw(n){return n.cleanup||(n.cleanup=[])}function Cw(n,e){const t=n[9],r=t?t.get(Js,null):null;r&&r.handleError(e)}function bw(n,e,t,r,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],u=n.data[o];null!==u.setInput?u.setInput(l,i,r,a):l[a]=i}}function Ru(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=th(i,a):2==s&&(r=th(r,a+": "+e[++o]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}const Ad=new Me("INJECTOR",-1);class Dw{get(e,t=Ca){if(t===Ca){const r=new Error(`NullInjectorError: No provider for ${Ne(e)}!`);throw r.name="NullInjectorError",r}return t}}const kd=new Me("Set Injector scope."),Pa={},cN={};let Td;function _w(){return void 0===Td&&(Td=new Dw),Td}function Mw(n,e=null,t=null,r){const i=Sw(n,e,t,r);return i._resolveInjectorDefTypes(),i}function Sw(n,e=null,t=null,r){return new fN(n,t,e||_w(),r)}class fN{constructor(e,t,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&kr(t,a=>this.processProvider(a,e,t)),kr([e],a=>this.processInjectorType(a,[],s)),this.records.set(Ad,ro(void 0,this));const o=this.records.get(kd);this.scope=null!=o?o.value:null,this.source=i||("object"==typeof e?null:Ne(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Ca,r=pe.Default){this.assertNotDestroyed();const i=zv(this),s=Ci(void 0);try{if(!(r&pe.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=("function"==typeof(n=e)||"object"==typeof n&&n instanceof Me)&&rh(e);a=l&&this.injectableDefInScope(l)?ro(Id(e),Pa):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(r&pe.Self?_w():this.parent).get(e,t=r&pe.Optional&&t===Ca?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Cu]=o[Cu]||[]).unshift(Ne(e)),i)throw o;return function(n,e,t,r){const i=n[Cu];throw e[Gv]&&i.unshift(e[Gv]),n.message=function(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let i=Ne(e);if(Array.isArray(e))i=e.map(Ne).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ne(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace($T,"\n  ")}`}("\n"+n.message,i,t,r),n.ngTokenPath=i,n[Cu]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Ci(s),zv(i)}var n}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,i)=>e.push(Ne(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new De(205,"")}processInjectorType(e,t,r){if(!(e=de(e)))return!1;let i=tv(e);const s=null==i&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==r.indexOf(o);if(void 0!==s&&(i=tv(s)),null==i)return!1;if(null!=i.imports&&!a){let c;r.push(o);try{kr(i.imports,d=>{this.processInjectorType(d,t,r)&&(void 0===c&&(c=[]),c.push(d))})}finally{}if(void 0!==c)for(let d=0;d<c.length;d++){const{ngModule:g,providers:v}=c[d];kr(v,C=>this.processProvider(C,g,v||Be))}}this.injectorDefTypes.add(o);const l=fs(o)||(()=>new o);this.records.set(o,ro(l,Pa));const u=i.providers;if(null!=u&&!a){const c=e;kr(u,d=>this.processProvider(d,c,u))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,r){let i=io(e=de(e))?e:de(e&&e.provide);const s=(n=e,Ew(n)?ro(void 0,n.useValue):ro(xw(n),Pa));var n;if(io(e)||!0!==e.multi)this.records.get(i);else{let o=this.records.get(i);o||(o=ro(void 0,Pa,!0),o.factory=()=>Lh(o.multi),this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,s)}hydrate(e,t){return t.value===Pa&&(t.value=cN,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}injectableDefInScope(e){if(!e.providedIn)return!1;const t=de(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Id(n){const e=rh(n),t=null!==e?e.factory:fs(n);if(null!==t)return t;if(n instanceof Me)throw new De(204,"");if(n instanceof Function)return function(n){const e=n.length;if(e>0)throw function(n,e){const t=[];for(let r=0;r<n;r++)t.push(e)}(e,"?"),new De(204,"");const t=function(n){const e=n&&(n[Jl]||n[nv]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new De(204,"")}function xw(n,e,t){let r;if(io(n)){const i=de(n);return fs(i)||Id(i)}if(Ew(n))r=()=>de(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...Lh(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))r=()=>qe(de(n.useExisting));else{const i=de(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return fs(i)||Id(i);r=()=>new i(...Lh(n.deps))}return r}function ro(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Ew(n){return null!==n&&"object"==typeof n&&WT in n}function io(n){return"function"==typeof n}let Pn=(()=>{class n{static create(t,r){var i;if(Array.isArray(t))return Mw({name:""},r,t,"");{const s=null!=(i=t.name)?i:"";return Mw({name:s},t.parent,t.providers,s)}}}return n.THROW_IF_NOT_FOUND=Ca,n.NULL=new Dw,n.\u0275prov=rt({token:n,providedIn:"any",factory:()=>qe(Ad)}),n.__NG_ELEMENT_ID__=-1,n})();function EN(n,e){uu(zh(n)[1],Ct())}function He(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let i;if(lr(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new De(903,"");i=e.\u0275dir}if(i){if(t){r.push(i);const o=n;o.inputs=Pd(n.inputs),o.declaredInputs=Pd(n.declaredInputs),o.outputs=Pd(n.outputs);const a=i.hostBindings;a&&IN(n,a);const l=i.viewQuery,u=i.contentQueries;if(l&&kN(n,l),u&&TN(n,u),eh(n.inputs,i.inputs),eh(n.declaredInputs,i.declaredInputs),eh(n.outputs,i.outputs),lr(i)&&i.data.animation){const c=n.data;c.animation=(c.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===He&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=du(i.hostAttrs,t=du(t,i.hostAttrs))}}(r)}function Pd(n){return n===Ns?{}:n===Be?[]:n}function kN(n,e){const t=n.viewQuery;n.viewQuery=t?(r,i)=>{e(r,i),t(r,i)}:e}function TN(n,e){const t=n.contentQueries;n.contentQueries=t?(r,i,s)=>{e(r,i,s),t(r,i,s)}:e}function IN(n,e){const t=n.hostBindings;n.hostBindings=t?(r,i)=>{e(r,i),t(r,i)}:e}let Fu=null;function so(){if(!Fu){const n=Re.Symbol;if(n&&n.iterator)Fu=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const r=e[t];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Fu=r)}}}return Fu}function Ra(n){return!!Rd(n)&&(Array.isArray(n)||!(n instanceof Map)&&so()in n)}function Rd(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Gt(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Fd(n,e,t,r,i,s,o,a){const l=B(),u=_e(),c=n+20,d=u.firstCreatePass?function(n,e,t,r,i,s,o,a,l){const u=e.consts,c=eo(e,n,4,o||null,Mi(u,a));bd(e,t,c,Mi(u,l)),uu(e,c);const d=c.tViews=Nu(2,c,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u);return null!==e.queries&&(e.queries.template(e,c),d.queries=e.queries.embeddedTView(c)),c}(c,u,l,e,t,r,i,s,o):u.data[c];Ar(d,!1);const g=l[11].createComment("");Au(u,l,g,d),Wt(g,l),Pu(l,l[c]=gw(g,l,g,d)),ru(d)&&wd(u,l,d),null!=o&&Cd(l,d,a)}function W(n,e=pe.Default){const t=B();return null===t?qe(n,e):Fv(Ct(),t,de(n),e)}function yo(n,e,t){const r=B();return Gt(r,se.lFrame.bindingIndex++,e)&&function(n,e,t,r,i,s,o,a){const l=zn(e,t);let c,u=e.inputs;!a&&null!=u&&(c=u[r])?(bw(n,t,c,r,i),nu(e)&&function(n,e){const t=Tn(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(r=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=o?o(i,e.value||"",r):i,ot(s)?s.setProperty(l,r,i):xh(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}(_e(),function(){const n=se.lFrame;return mh(n.tView,n.selectedIndex)}(),r,n,e,r[11],t,!1),yo}function jd(n,e,t,r,i){const o=i?"class":"style";bw(n,t,e.inputs[o],o,r)}function Ee(n,e,t,r){const i=B(),s=_e(),o=20+n,a=i[11],l=i[o]=ed(a,e,se.lFrame.currentNamespace),u=s.firstCreatePass?function(n,e,t,r,i,s,o){const a=e.consts,u=eo(e,n,2,i,Mi(a,s));return bd(e,t,u,Mi(a,o)),null!==u.attrs&&Ru(u,u.attrs,!1),null!==u.mergedAttrs&&Ru(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,0,e,t,r):s.data[o];Ar(u,!0);const c=u.mergedAttrs;null!==c&&hu(a,l,c);const d=u.classes;null!==d&&od(a,l,d);const g=u.styles;null!==g&&V0(a,l,g),64!=(64&u.flags)&&Au(s,i,l,u),0===se.lFrame.elementDepthCount&&Wt(l,i),se.lFrame.elementDepthCount++,ru(u)&&(wd(s,i,u),function(n,e,t){if(fh(e)){const i=e.directiveEnd;for(let s=e.directiveStart;s<i;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,u,i)),null!==r&&Cd(i,u)}function Ae(){let n=Ct();wh()?se.lFrame.isParent=!1:(n=n.parent,Ar(n,!1));const e=n;se.lFrame.elementDepthCount--;const t=_e();t.firstCreatePass&&(uu(t,n),fh(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&jd(t,e,B(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&jd(t,e,B(),e.stylesWithoutHost,!1)}function Bu(n,e,t,r){Ee(n,e,t,r),Ae()}function Hu(n){return!!n&&"function"==typeof n.then}const uC=function(n){return!!n&&"function"==typeof n.subscribe};function fn(n,e,t,r){const i=B(),s=_e(),o=Ct();return function(n,e,t,r,i,s,o,a){const l=ru(r),c=n.firstCreatePass&&vw(n),d=e[8],g=yw(e);let v=!0;if(3&r.type||a){const M=zn(r,e),x=a?a(M):M,A=g.length,N=a?L=>a(mt(L[r.index])):r.index;if(ot(t)){let L=null;if(!a&&l&&(L=function(n,e,t,r){const i=n.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===r){const a=e[7],l=i[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,i,r.index)),null!==L)(L.__ngLastListenerFn__||L).__ngNextListenerFn__=s,L.__ngLastListenerFn__=s,v=!1;else{s=$d(r,e,d,s,!1);const F=t.listen(x,i,s);g.push(s,F),c&&c.push(i,N,A,A+1)}}else s=$d(r,e,d,s,!0),x.addEventListener(i,s,o),g.push(s),c&&c.push(i,N,A,o)}else s=$d(r,e,d,s,!1);const C=r.outputs;let D;if(v&&null!==C&&(D=C[i])){const M=D.length;if(M)for(let x=0;x<M;x+=2){const H=e[D[x]][D[x+1]].subscribe(s),U=g.length;g.push(s,H),c&&c.push(i,r.index,U,-(U+1))}}}(s,i,i[11],o,n,e,!!t,r),fn}function hC(n,e,t,r){try{return!1!==t(r)}catch(i){return Cw(n,i),!1}}function $d(n,e,t,r,i){return function s(o){if(o===Function)return r;const a=2&n.flags?Tn(n.index,e):e;0==(32&e[2])&&Md(a);let l=hC(e,0,r,o),u=s.__ngNextListenerFn__;for(;u;)l=hC(e,0,u,o)&&l,u=u.__ngNextListenerFn__;return i&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function vo(n=1){return function(n){return(se.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,se.lFrame.contextLView))[8]}(n)}function DC(n,e,t,r,i){const s=n[t+1],o=null===e;let a=r?cr(s):li(s),l=!1;for(;0!==a&&(!1===l||o);){const c=n[a+1];mP(n[a],e)&&(l=!0,n[a+1]=r?ud(c):ad(c)),a=r?cr(c):li(c)}l&&(n[t+1]=r?ad(s):ud(s))}function mP(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&qs(n,e)>=0}function ju(n,e){return function(n,e,t,r){const i=B(),s=_e(),o=function(n){const e=se.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function(n,e,t,r){const i=n.data;if(null===i[t+1]){const s=i[un()],o=function(n,e){return e>=n.expandoStartIndex}(n,t);(function(n,e){return 0!=(n.flags&(e?16:32))})(s,r)&&null===e&&!o&&(e=!1),e=function(n,e,t,r){const i=function(n){const e=se.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(t=La(t=Wd(null,n,e,t,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==i)if(t=Wd(i,n,e,t,r),null===s){let l=function(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==li(r))return n[cr(r)]}(n,e,r);void 0!==l&&Array.isArray(l)&&(l=Wd(null,n,e,l[1],r),l=La(l,e.attrs,r),function(n,e,t,r){n[cr(t?e.classBindings:e.styleBindings)]=r}(n,e,r,l))}else s=function(n,e,t){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=La(r,n[s].hostAttrs,t);return La(r,e.attrs,t)}(n,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,r),function(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=cr(o),l=li(o);n[r]=t;let c,u=!1;if(Array.isArray(t)){const d=t;c=d[1],(null===c||qs(d,c)>0)&&(u=!0)}else c=t;if(i)if(0!==l){const g=cr(n[a+1]);n[r+1]=Tu(g,a),0!==g&&(n[g+1]=ld(n[g+1],r)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],r)}else n[r+1]=Tu(a,0),0!==a&&(n[a+1]=ld(n[a+1],r)),a=r;else n[r+1]=Tu(l,0),0===a?a=r:n[l+1]=ld(n[l+1],r),l=r;u&&(n[r+1]=ad(n[r+1])),DC(n,c,r,!0),DC(n,c,r,!1),function(n,e,t,r,i){const s=i?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&qs(s,e)>=0&&(t[r+1]=ud(t[r+1]))}(e,c,n,r,s),o=Tu(a,l),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,r)}}(s,n,o,r),e!==fe&&Gt(i,o,e)&&function(n,e,t,r,i,s,o,a){if(!(3&e.type))return;const l=n.data,u=l[a+1];$u(function(n){return 1==(1&n)}(u)?PC(l,e,t,i,li(u),o):void 0)||($u(s)||function(n){return 2==(2&n)}(u)&&(s=PC(l,null,t,i,a,o)),function(n,e,t,r,i){const s=ot(n);if(e)i?s?n.addClass(t,r):t.classList.add(r):s?n.removeClass(t,r):t.classList.remove(r);else{let o=-1===r.indexOf("-")?void 0:On.DashCase;if(null==i)s?n.removeStyle(t,r,o):t.style.removeProperty(r);else{const a="string"==typeof i&&i.endsWith("!important");a&&(i=i.slice(0,-10),o|=On.Important),s?n.setStyle(t,r,i,o):t.style.setProperty(r,i,a?"important":"")}}}(r,o,function(n,e){return mt(e[n])}(un(),t),i,s))}(s,s.data[un()],i,i[11],n,i[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Ne(function(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}(n)))),n}(e,t),r,o)}(n,e,null,!0),ju}function Wd(n,e,t,r,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],r=La(r,s.hostAttrs,i),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),r}function La(n,e,t){const r=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),In(n,o,!!t||e[++s]))}return void 0===n?null:n}function PC(n,e,t,r,i,s){const o=null===e;let a;for(;i>0;){const l=n[i],u=Array.isArray(l),c=u?l[1]:l,d=null===c;let g=t[i+1];g===fe&&(g=d?Be:void 0);let v=d?Ph(g,r):c===r?g:void 0;if(u&&!$u(v)&&(v=Ph(l,r)),$u(v)&&(a=v,o))return a;const C=n[i+1];i=o?cr(C):li(C)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Ph(l,r))}return a}function $u(n){return void 0!==n}function lt(n,e=""){const t=B(),r=_e(),i=n+20,s=r.firstCreatePass?eo(r,i,1,e,null):r.data[i],o=t[i]=function(n,e){return ot(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Au(r,t,o,s),Ar(s,!1)}const ps=void 0;var JP=["en",[["a","p"],["AM","PM"],ps],[["AM","PM"],ps,ps],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ps,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ps,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ps,"{1} 'at' {0}",ps],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===r?1:5}];let Co={};function rb(n){return n in Co||(Co[n]=Re.ng&&Re.ng.common&&Re.ng.common.locales&&Re.ng.common.locales[n]),Co[n]}var K=(()=>((K=K||{})[K.LocaleId=0]="LocaleId",K[K.DayPeriodsFormat=1]="DayPeriodsFormat",K[K.DayPeriodsStandalone=2]="DayPeriodsStandalone",K[K.DaysFormat=3]="DaysFormat",K[K.DaysStandalone=4]="DaysStandalone",K[K.MonthsFormat=5]="MonthsFormat",K[K.MonthsStandalone=6]="MonthsStandalone",K[K.Eras=7]="Eras",K[K.FirstDayOfWeek=8]="FirstDayOfWeek",K[K.WeekendRange=9]="WeekendRange",K[K.DateFormat=10]="DateFormat",K[K.TimeFormat=11]="TimeFormat",K[K.DateTimeFormat=12]="DateTimeFormat",K[K.NumberSymbols=13]="NumberSymbols",K[K.NumberFormats=14]="NumberFormats",K[K.CurrencyCode=15]="CurrencyCode",K[K.CurrencySymbol=16]="CurrencySymbol",K[K.CurrencyName=17]="CurrencyName",K[K.Currencies=18]="Currencies",K[K.Directionality=19]="Directionality",K[K.PluralCase=20]="PluralCase",K[K.ExtraData=21]="ExtraData",K))();const Uu="en-US";let ib=Uu;function Kd(n,e,t,r,i){if(n=de(n),Array.isArray(n))for(let s=0;s<n.length;s++)Kd(n[s],e,t,r,i);else{const s=_e(),o=B();let a=io(n)?n:de(n.provide),l=xw(n);const u=Ct(),c=1048575&u.providerIndexes,d=u.directiveStart,g=u.providerIndexes>>20;if(io(n)||!n.multi){const v=new ha(l,i,W),C=Yd(a,e,i?c:c+g,d);-1===C?(mu(pa(u,o),s,a),Qd(s,n,e.length),e.push(a),u.directiveStart++,u.directiveEnd++,i&&(u.providerIndexes+=1048576),t.push(v),o.push(v)):(t[C]=v,o[C]=v)}else{const v=Yd(a,e,c+g,d),C=Yd(a,e,c,c+g),D=v>=0&&t[v],M=C>=0&&t[C];if(i&&!M||!i&&!D){mu(pa(u,o),s,a);const x=function(n,e,t,r,i){const s=new ha(n,t,W);return s.multi=[],s.index=e,s.componentProviders=0,Ab(s,i,r&&!t),s}(i?QR:KR,t.length,i,r,l);!i&&M&&(t[C].providerFactory=x),Qd(s,n,e.length,0),e.push(a),u.directiveStart++,u.directiveEnd++,i&&(u.providerIndexes+=1048576),t.push(x),o.push(x)}else Qd(s,n,v>-1?v:C,Ab(t[i?C:v],l,!i&&r));!i&&r&&M&&t[C].componentProviders++}}}function Qd(n,e,t,r){const i=io(e),s=function(n){return!!n.useClass}(e);if(i||s){const l=(s?de(e.useClass):e).prototype.ngOnDestroy;if(l){const u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){const c=u.indexOf(t);-1===c?u.push(t,[r,l]):u[c+1].push(r,l)}else u.push(t,l)}}}function Ab(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Yd(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function KR(n,e,t,r){return Jd(this.multi,[])}function QR(n,e,t,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=ga(t,t[1],this.providerFactory.index,r);s=a.slice(0,o),Jd(i,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Jd(i,s);return s}function Jd(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function tt(n,e=[]){return t=>{t.providersResolver=(r,i)=>function(n,e,t){const r=_e();if(r.firstCreatePass){const i=lr(n);Kd(t,r.data,r.blueprint,i,!0),Kd(e,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,e)}}class kb{}class XR{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${Ne(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let $a=(()=>{class n{}return n.NULL=new XR,n})();function eF(){return Do(Ct(),B())}function Do(n,e){return new pr(zn(n,e))}let pr=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=eF,n})();function tF(n){return n instanceof pr?n.nativeElement:n}class Ib{}let gs=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function(){const n=B(),t=Tn(Ct().index,n);return function(n){return n[11]}(xr(t)?t:n)}(),n})(),iF=(()=>{class n{}return n.\u0275prov=rt({token:n,providedIn:"root",factory:()=>null}),n})();class Ku{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const sF=new Ku("13.1.3"),Zd={};function Qu(n,e,t,r,i=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&r.push(mt(s)),ar(s))for(let a=10;a<s.length;a++){const l=s[a],u=l[1].firstChild;null!==u&&Qu(l[1],l,u,r)}const o=t.type;if(8&o)Qu(n,e,t.child,r);else if(32&o){const a=Yh(t,e);let l;for(;l=a();)r.push(l)}else if(16&o){const a=R0(e,t);if(Array.isArray(a))r.push(...a);else{const l=ka(e[16]);Qu(l[1],l,a,r,!0)}}t=i?t.projectionNext:t.next}return r}class Ua{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Qu(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(ar(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(td(e,r),vu(t,r))}this._attachedToViewContainer=!1}x0(this._lView[1],this._lView)}onDestroy(e){aw(this._lView[1],this._lView,null,e)}markForCheck(){Md(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){xd(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){ou(!0);try{xd(n,e,t)}finally{ou(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new De(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,Ta(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new De(902,"");this._appRef=e}}class oF extends Ua{constructor(e){super(e),this._view=e}detectChanges(){mw(this._view)}checkNoChanges(){!function(n){ou(!0);try{mw(n)}finally{ou(!1)}}(this._view)}get context(){return null}}class Ob extends $a{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=$t(e);return new Xd(t,this.ngModule)}}function Nb(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const lF=new Me("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>v0});class Xd extends kb{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(CO).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Nb(this.componentDef.inputs)}get outputs(){return Nb(this.componentDef.outputs)}create(e,t,r,i){const s=(i=i||this.ngModule)?function(n,e){return{get:(t,r,i)=>{const s=n.get(t,Zd,i);return s!==Zd||r===Zd?s:e.get(t,r,i)}}}(e,i.injector):e,o=s.get(Ib,gv),a=s.get(iF,null),l=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=r?function(n,e,t){if(ot(n))return n.selectRootElement(e,t===Sr.ShadowDom);let r="string"==typeof e?n.querySelector(e):e;return r.textContent="",r}(l,r,this.componentDef.encapsulation):ed(o.createRenderer(null,this.componentDef),u,function(n){const e=n.toLowerCase();return"svg"===e?dv:"math"===e?"http://www.w3.org/1998/MathML/":null}(u)),d=this.componentDef.onPush?576:528,g=function(n,e){return{components:[],scheduler:n||v0,clean:aN,playerHandler:e||null,flags:0}}(),v=Nu(0,null,null,1,0,null,null,null,null,null),C=Oa(null,v,g,d,null,null,o,l,a,s);let D,M;au(C);try{const x=function(n,e,t,r,i,s){const o=t[1];t[20]=n;const l=eo(o,20,2,"#host",null),u=l.mergedAttrs=e.hostAttrs;null!==u&&(Ru(l,u,!0),null!==n&&(hu(i,n,u),null!==l.classes&&od(i,n,l.classes),null!==l.styles&&V0(i,n,l.styles)));const c=r.createRenderer(n,e),d=Oa(t,iw(e),null,e.onPush?64:16,t[20],l,r,c,s||null,null);return o.firstCreatePass&&(mu(pa(l,t),o,e.type),hw(o,l),dw(l,t.length,1)),Pu(t,d),t[20]=d}(c,this.componentDef,C,o,l);if(c)if(r)hu(l,c,["ng-version",sF.full]);else{const{attrs:A,classes:N}=function(n){const e=[],t=[];let r=1,i=2;for(;r<n.length;){let s=n[r];if("string"==typeof s)2===i?""!==s&&e.push(s,n[++r]):8===i&&t.push(s);else{if(!ur(i))break;i=s}r++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);A&&hu(l,c,A),N&&N.length>0&&od(l,c,N.join(" "))}if(M=mh(v,20),void 0!==t){const A=M.projection=[];for(let N=0;N<this.ngContentSelectors.length;N++){const L=t[N];A.push(null!=L?Array.from(L):null)}}D=function(n,e,t,r,i){const s=t[1],o=function(n,e,t){const r=Ct();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),pw(n,r,e,to(n,e,1,null),t));const i=ga(e,n,r.directiveStart,r);Wt(i,e);const s=zn(r,e);return s&&Wt(s,e),i}(s,t,e);if(r.components.push(o),n[8]=o,i&&i.forEach(l=>l(o,e)),e.contentQueries){const l=Ct();e.contentQueries(1,o,l.directiveStart)}const a=Ct();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Si(a.index),cw(t[1],a,0,a.directiveStart,a.directiveEnd,e),fw(e,o)),o}(x,this.componentDef,C,g,[EN]),Na(v,C,null)}finally{lu()}return new fF(this.componentType,D,Do(M,C),C,M)}}class fF extends class{}{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new oF(i),this.componentType=e}get injector(){return new $s(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class _o{}const Mo=new Map;class Fb extends _o{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Ob(this);const r=Un(e);this._bootstrapComponents=Ir(r.bootstrap),this._r3Injector=Sw(e,t,[{provide:_o,useValue:this},{provide:$a,useValue:this.componentFactoryResolver}],Ne(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Pn.THROW_IF_NOT_FOUND,r=pe.Default){return e===Pn||e===_o||e===Ad?this:this._r3Injector.get(e,t,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class ep extends class{}{constructor(e){super(),this.moduleType=e,null!==Un(e)&&function(n){const e=new Set;!function t(r){const i=Un(r,!0),s=i.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${Ne(e)} vs ${Ne(e.name)}`)}(s,Mo.get(s),r),Mo.set(s,r));const o=Ir(i.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new Fb(this.moduleType,e)}}function tp(n){return e=>{setTimeout(n,void 0,e)}}const zt=class extends qf{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,r){var l,u,c;let i=e,s=t||(()=>null),o=r;if(e&&"object"==typeof e){const d=e;i=null==(l=d.next)?void 0:l.bind(d),s=null==(u=d.error)?void 0:u.bind(d),o=null==(c=d.complete)?void 0:c.bind(d)}this.__isAsync&&(s=tp(s),i&&(i=tp(i)),o&&(o=tp(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof Mr&&e.add(a),a}};function NF(){return this._results[so()]()}class np{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=so(),r=np.prototype;r[t]||(r[t]=NF)}get changes(){return this._changes||(this._changes=new zt)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const r=this;r.dirty=!1;const i=qn(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],s=e[r];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(r._results,i,t))&&(r._results=i,r.length=i.length,r.last=i[this.length-1],r.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let fi=(()=>{class n{}return n.__NG_ELEMENT_ID__=FF,n})();const PF=fi,RF=class extends PF{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}createEmbeddedView(e){const t=this._declarationTContainer.tViews,r=Oa(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(r[19]=s.createEmbeddedView(t)),Na(t,r,e),new Ua(r)}};function FF(){return Yu(Ct(),B())}function Yu(n,e){return 4&n.type?new RF(e,n,Do(n,e)):null}let Fr=(()=>{class n{}return n.__NG_ELEMENT_ID__=LF,n})();function LF(){return Wb(Ct(),B())}const VF=Fr,$b=class extends VF{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Do(this._hostTNode,this._hostLView)}get injector(){return new $s(this._hostTNode,this._hostLView)}get parentInjector(){const e=gu(this._hostTNode,this._hostLView);if(Iv(e)){const t=js(e,this._hostLView),r=Hs(e);return new $s(t[1].data[r+8],t)}return new $s(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Ub(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,r){const i=e.createEmbeddedView(t||{});return this.insert(i,r),i}createComponent(e,t,r,i,s){const o=e&&!("function"==typeof e);let a;if(o)a=t;else{const d=t||{};a=d.index,r=d.injector,i=d.projectableNodes,s=d.ngModuleRef}const l=o?e:new Xd($t(e)),u=r||this.parentInjector;if(!s&&null==l.ngModule&&u){const d=u.get(_o,null);d&&(s=d)}const c=l.create(u,i,void 0,s);return this.insert(c.hostView,a),c}insert(e,t){const r=e._lView,i=r[1];if(ar(r[3])){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const d=r[3],g=new $b(d,d[6],d[3]);g.detach(g.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,r){const i=10+r,s=t.length;r>0&&(t[i-1][4]=e),r<s-10?(e[4]=t[i],Hv(t,10+r,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(i,r,o,s);const a=id(s,o),l=r[11],u=Eu(l,o[7]);return null!==u&&function(n,e,t,r,i,s){r[0]=i,r[6]=e,Ta(n,r,t,1,i,s)}(i,o[6],l,r,u,a),e.attachToViewContainerRef(),Hv(rp(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Ub(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=td(this._lContainer,t);r&&(vu(rp(this._lContainer),t),x0(r[1],r))}detach(e){const t=this._adjustIndex(e,-1),r=td(this._lContainer,t);return r&&null!=vu(rp(this._lContainer),t)?new Ua(r):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Ub(n){return n[8]}function rp(n){return n[8]||(n[8]=[])}function Wb(n,e){let t;const r=e[n.index];if(ar(r))t=r;else{let i;if(8&n.type)i=mt(r);else{const s=e[11];i=s.createComment("");const o=zn(n,e);hs(s,Eu(s,o),i,function(n,e){return ot(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=gw(r,e,i,n),Pu(e,t)}return new $b(t,n,e)}class ip{constructor(e){this.queryList=e,this.matches=null}clone(){return new ip(this.queryList)}setDirty(){this.queryList.setDirty()}}class sp{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const r=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<r;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new sp(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Zb(e,t).matches&&this.queries[t].setDirty()}}class Gb{constructor(e,t,r=null){this.predicate=e,this.flags=t,this.read=r}}class op{constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){const i=null!==t?t.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,null!==t?t.push(s):t=[s])}return null!==t?new op(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class ap{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new ap(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(e,t,jF(t,s)),this.matchTNodeWithReadOption(e,t,yu(t,e,s,!1,!1))}else r===fi?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,yu(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===pr||i===Fr||i===fi&&4&t.type)this.addMatch(t.index,-2);else{const s=yu(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,r)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function jF(n,e){const t=n.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1];return null}function UF(n,e,t,r){return-1===t?function(n,e){return 11&n.type?Do(n,e):4&n.type?Yu(n,e):null}(e,n):-2===t?function(n,e,t){return t===pr?Do(e,n):t===fi?Yu(e,n):t===Fr?Wb(e,n):void 0}(n,e,r):ga(n,n[1],t,e)}function zb(n,e,t,r){const i=e[19].queries[r];if(null===i.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const u=o[l];a.push(u<0?null:UF(e,s[u],o[l+1],t.metadata.read))}i.matches=a}return i.matches}function lp(n,e,t,r){const i=n.queries.getByIndex(t),s=i.matches;if(null!==s){const o=zb(n,e,i,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)r.push(o[a/2]);else{const u=s[a+1],c=e[-l];for(let d=10;d<c.length;d++){const g=c[d];g[17]===g[3]&&lp(g[1],g,u,r)}if(null!==c[9]){const d=c[9];for(let g=0;g<d.length;g++){const v=d[g];lp(v[1],v,u,r)}}}}}return r}function qb(n){const e=B(),t=_e(),r=Dv();_h(r+1);const i=Zb(t,r);if(n.dirty&&mv(e)===(2==(2&i.metadata.flags))){if(null===i.matches)n.reset([]);else{const s=i.crossesNgTemplate?lp(t,e,r,[]):zb(t,e,i,r);n.reset(s,tF),n.notifyOnChanges()}return!0}return!1}function Kb(n,e,t){const r=_e();r.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new op),n.queries.track(new ap(e,t))}(r,new Gb(n,e,t),-1),2==(2&e)&&(r.staticViewQueries=!0)),function(n,e,t){const r=new np(4==(4&t));aw(n,e,r,r.destroy),null===e[19]&&(e[19]=new sp),e[19].queries.push(new ip(r))}(r,B(),e)}function Zb(n,e){return n.queries.getByIndex(e)}function Xu(...n){}const pp=new Me("Application Initializer");let xo=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Xu,this.reject=Xu,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const t=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const s=this.appInits[i]();if(Hu(s))t.push(s);else if(uC(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),0===t.length&&r(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(qe(pp,8))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const qa=new Me("AppId"),dL={provide:qa,useFactory:function(){return`${gp()}${gp()}${gp()}`},deps:[]};function gp(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const mD=new Me("Platform Initializer"),mp=new Me("Platform ID"),pL=new Me("appBootstrapListener");let gL=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const Ti=new Me("LocaleId"),yD=new Me("DefaultCurrencyCode");class mL{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let vD=(()=>{class n{compileModuleSync(t){return new ep(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),s=Ir(Un(t).declarations).reduce((o,a)=>{const l=$t(a);return l&&o.push(new Xd(l)),o},[]);return new mL(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const vL=(()=>Promise.resolve(0))();function yp(n){"undefined"==typeof Zone?vL.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class qt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new zt(!1),this.onMicrotaskEmpty=new zt(!1),this.onStable=new zt(!1),this.onError=new zt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let n=Re.requestAnimationFrame,e=Re.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Re,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,wp(n),n.isCheckStableRunning=!0,vp(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),wp(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{try{return wD(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),CD(n)}},onInvoke:(t,r,i,s,o,a,l)=>{try{return wD(n),t.invoke(i,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),CD(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,wp(n),vp(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!qt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(qt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,CL,Xu,Xu);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const CL={};function vp(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function wp(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function wD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function CD(n){n._nesting--,vp(n)}class _L{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new zt,this.onMicrotaskEmpty=new zt,this.onStable=new zt,this.onError=new zt}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}}let Cp=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{qt.assertNotInAngularZone(),yp(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())yp(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,r,i){return[]}}return n.\u0275fac=function(t){return new(t||n)(qe(qt))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),bD=(()=>{class n{constructor(){this._applications=new Map,bp.addToWindow(this)}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return bp.findTestabilityInTree(this,t,r)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class ML{addToWindow(e){}findTestabilityInTree(e,t,r){return null}}let gr,bp=new ML;const DD=new Me("AllowMultipleToken");function _D(n,e,t=[]){const r=`Platform: ${e}`,i=new Me(r);return(s=[])=>{let o=MD();if(!o||o.injector.get(DD,!1))if(n)n(t.concat(s).concat({provide:i,useValue:!0}));else{const a=t.concat(s).concat({provide:i,useValue:!0},{provide:kd,useValue:"platform"});!function(n){if(gr&&!gr.destroyed&&!gr.injector.get(DD,!1))throw new De(400,"");gr=n.get(SD);const e=n.get(mD,null);e&&e.forEach(t=>t())}(Pn.create({providers:a,name:r}))}return function(n){const e=MD();if(!e)throw new De(401,"");return e}()}}function MD(){return gr&&!gr.destroyed?gr:null}let SD=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const a=function(n,e){let t;return t="noop"===n?new _L:("zone.js"===n?void 0:n)||new qt({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),l=[{provide:qt,useValue:a}];return a.run(()=>{const u=Pn.create({providers:l,parent:this.injector,name:t.moduleType.name}),c=t.create(u),d=c.injector.get(Js,null);if(!d)throw new De(402,"");return a.runOutsideAngular(()=>{const g=a.onError.subscribe({next:v=>{d.handleError(v)}});c.onDestroy(()=>{Dp(this._modules,c),g.unsubscribe()})}),function(n,e,t){try{const r=t();return Hu(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(d,a,()=>{const g=c.injector.get(xo);return g.runInitializers(),g.donePromise.then(()=>(function(n){An(n,"Expected localeId to be defined"),"string"==typeof n&&(ib=n.toLowerCase().replace(/_/g,"-"))}(c.injector.get(Ti,Uu)||Uu),this._moduleDoBootstrap(c),c))})})}bootstrapModule(t,r=[]){const i=xD({},r);return function(n,e,t){const r=new ep(t);return Promise.resolve(r)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(t){const r=t.injector.get(ec);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new De(403,"");t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new De(404,"");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(qe(Pn))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();function xD(n,e){return Array.isArray(e)?e.reduce(xD,n):xn(xn({},n),e)}let ec=(()=>{class n{constructor(t,r,i,s,o){this._zone=t,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new on(u=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{u.next(this._stable),u.complete()})}),l=new on(u=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{qt.assertNotInAngularZone(),yp(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,u.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{qt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{u.next(!1)}))});return()=>{c.unsubscribe(),d.unsubscribe()}});this.isStable=Mk(a,l.pipe(function(n={}){const{connector:e=(()=>new qf),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o=null,a=null,l=null,u=0,c=!1,d=!1;const g=()=>{null==a||a.unsubscribe(),a=null},v=()=>{g(),o=l=null,c=d=!1},C=()=>{const D=o;v(),null==D||D.unsubscribe()};return Is((D,M)=>{u++,!d&&!c&&g();const x=l=null!=l?l:e();M.add(()=>{u--,0===u&&!d&&!c&&(a=Xf(C,i))}),x.subscribe(M),o||(o=new Uf({next:A=>x.next(A),error:A=>{d=!0,g(),a=Xf(v,t,A),x.error(A)},complete:()=>{c=!0,g(),a=Xf(v,r),x.complete()}}),Zf(D).subscribe(o))})(s)}}()))}bootstrap(t,r){if(!this._initStatus.done)throw new De(405,"");let i;i=t instanceof kb?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(i.componentType);const s=function(n){return n.isBoundToModule}(i)?void 0:this._injector.get(_o),a=i.create(Pn.NULL,[],r||i.selector,s),l=a.location.nativeElement,u=a.injector.get(Cp,null),c=u&&a.injector.get(bD);return u&&c&&c.registerApplication(l,u),a.onDestroy(()=>{this.detachView(a.hostView),Dp(this.components,a),c&&c.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new De(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;Dp(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(pL,[]).concat(this._bootstrapListeners).forEach(i=>i(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(qe(qt),qe(Pn),qe(Js),qe($a),qe(xo))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();function Dp(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let AD=!0;class RD{constructor(){}supports(e){return Ra(e)}create(e){return new UL(e)}}const $L=(n,e)=>e;class UL{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||$L}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){const o=!r||t&&t.currentIndex<LD(r,i,s)?t:r,a=LD(o,i,s),l=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const u=a-i,c=l-i;if(u!=c){for(let g=0;g<u;g++){const v=g<s.length?s[g]:s[g]=0,C=v+g;c<=C&&C<u&&(s[g]=v+1)}s[o.previousIndex]=c-u}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Ra(e))throw new De(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),r=!0),t=t._next}else i=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[so()]();let r;for(;!(r=t.next()).done;)e(r.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),r=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new WL(t,r),s,i),e}_verifyReinsertion(e,t,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new FD),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,r=e._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new FD),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class WL{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class GL{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const t=e._prevDup,r=e._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class FD{constructor(){this.map=new Map}put(e){const t=e.trackById;let r=this.map.get(t);r||(r=new GL,this.map.set(t,r)),r.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function LD(n,e,t){const r=n.previousIndex;if(null===r)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}class VD{constructor(){}supports(e){return e instanceof Map||Rd(e)}create(){return new zL}}class zL{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Rd(e)))throw new De(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,r);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const r=new qL(e);return this._records.set(e,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(r=>t(e[r],r))}}class qL{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function BD(){return new Ka([new RD])}let Ka=(()=>{class n{constructor(t){this.factories=t}static create(t,r){if(null!=r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||BD()),deps:[[n,new _a,new Ks]]}}find(t){const r=this.factories.find(i=>i.supports(t));if(null!=r)return r;throw new De(901,"")}}return n.\u0275prov=rt({token:n,providedIn:"root",factory:BD}),n})();function HD(){return new Eo([new VD])}let Eo=(()=>{class n{constructor(t){this.factories=t}static create(t,r){if(r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||HD()),deps:[[n,new _a,new Ks]]}}find(t){const r=this.factories.find(s=>s.supports(t));if(r)return r;throw new De(901,"")}}return n.\u0275prov=rt({token:n,providedIn:"root",factory:HD}),n})();const KL=[new VD],YL=new Ka([new RD]),JL=new Eo(KL),ZL=_D(null,"core",[{provide:mp,useValue:"unknown"},{provide:SD,deps:[Pn]},{provide:bD,deps:[]},{provide:gL,deps:[]}]),rV=[{provide:ec,useClass:ec,deps:[qt,Pn,Js,$a,xo]},{provide:lF,deps:[qt],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:xo,useClass:xo,deps:[[new Ks,pp]]},{provide:vD,useClass:vD,deps:[]},dL,{provide:Ka,useFactory:function(){return YL},deps:[]},{provide:Eo,useFactory:function(){return JL},deps:[]},{provide:Ti,useFactory:function(n){return n||"undefined"!=typeof $localize&&$localize.locale||Uu},deps:[[new bu(Ti),new Ks,new _a]]},{provide:yD,useValue:"USD"}];let sV=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(qe(ec))},n.\u0275mod=Di({type:n}),n.\u0275inj=ii({providers:rV}),n})(),nc=null;function ys(){return nc}const Lr=new Me("DocumentToken");var vt=(()=>((vt=vt||{})[vt.Zero=0]="Zero",vt[vt.One=1]="One",vt[vt.Two=2]="Two",vt[vt.Few=3]="Few",vt[vt.Many=4]="Many",vt[vt.Other=5]="Other",vt))();const vV=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=rb(e);if(t)return t;const r=e.split("-")[0];if(t=rb(r),t)return t;if("en"===r)return JP;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[K.PluralCase]};class hc{}let qV=(()=>{class n extends hc{constructor(t){super(),this.locale=t}getPluralCategory(t,r){switch(vV(r||this.locale)(t)){case vt.Zero:return"zero";case vt.One:return"one";case vt.Two:return"two";case vt.Few:return"few";case vt.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(qe(Ti))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),ZD=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new XV,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){XD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){XD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(W(Fr),W(fi))},n.\u0275dir=ce({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class XV{constructor(){this.$implicit=null,this.ngIf=null}}function XD(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Ne(e)}'.`)}let xB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Di({type:n}),n.\u0275inj=ii({providers:[{provide:hc,useClass:qV}]}),n})();class Bp extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var n;n=new Bp,nc||(nc=n)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(Ja=Ja||document.querySelector("base"),Ja?Ja.getAttribute("href"):null);return null==t?null:function(n){dc=dc||document.createElement("a"),dc.setAttribute("href",n);const e=dc.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ja=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,s]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let dc,Ja=null;const i_=new Me("TRANSITION_ID"),FB=[{provide:pp,useFactory:function(n,e,t){return()=>{t.get(xo).donePromise.then(()=>{const r=ys(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<i.length;s++)r.remove(i[s])})}},deps:[i_,Lr,Pn],multi:!0}];class Hp{static init(){var n;n=new Hp,bp=n}addToWindow(e){Re.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new Error("Could not find testability for element.");return s},Re.getAllAngularTestabilities=()=>e.getAllTestabilities(),Re.getAllAngularRootElements=()=>e.getAllRootElements(),Re.frameworkStabilizers||(Re.frameworkStabilizers=[]),Re.frameworkStabilizers.push(r=>{const i=Re.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(l){o=o||l,s--,0==s&&r(o)};i.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:r?ys().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let LB=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const pc=new Me("EventManagerPlugins");let gc=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(qe(pc),qe(qt))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class s_{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=ys().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let o_=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})(),Za=(()=>{class n extends o_{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,i.push(r.appendChild(o))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(a_),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(a_))}}return n.\u0275fac=function(t){return new(t||n)(qe(Lr))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();function a_(n){ys().remove(n)}const jp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},$p=/%COMP%/g;function mc(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?mc(n,i,t):(i=i.replace($p,n),t.push(i))}return t}function c_(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Up=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Wp(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case Sr.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new UB(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case Sr.ShadowDom:return new WB(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=mc(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(qe(gc),qe(Za),qe(qa))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();class Wp{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(jp[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const s=jp[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=jp[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(On.DashCase|On.Important)?e.style.setProperty(t,r,i&On.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&On.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,c_(r)):this.eventManager.addEventListener(e,t,c_(r))}}class UB extends Wp{constructor(e,t,r,i){super(e),this.component=r;const s=mc(i+"-"+r.id,r.styles,[]);t.addStyles(s),this.contentAttr="_ngcontent-%COMP%".replace($p,i+"-"+r.id),this.hostAttr="_nghost-%COMP%".replace($p,i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class WB extends Wp{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=mc(i.id,i.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let GB=(()=>{class n extends s_{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(qe(Lr))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const h_=["alt","control","meta","shift"],qB={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},d_={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},KB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let QB=(()=>{class n extends s_{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ys().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="";if(h_.forEach(l=>{const u=r.indexOf(l);u>-1&&(r.splice(u,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const a={};return a.domEventName=i,a.fullKey=o,a}static getEventFullKey(t){let r="",i=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&d_.hasOwnProperty(e)&&(e=d_[e]))}return qB[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),h_.forEach(s=>{s!=i&&KB[s](t)&&(r+=s+".")}),r+=i,r}static eventCallback(t,r,i){return s=>{n.getEventFullKey(s)===t&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(qe(Lr))},n.\u0275prov=rt({token:n,factory:n.\u0275fac}),n})();const e2=_D(ZL,"browser",[{provide:mp,useValue:"browser"},{provide:mD,useValue:function(){Bp.makeCurrent(),Hp.init()},multi:!0},{provide:Lr,useFactory:function(){return n=document,ph=n,document;var n},deps:[]}]),t2=[{provide:kd,useValue:"root"},{provide:Js,useFactory:function(){return new Js},deps:[]},{provide:pc,useClass:GB,multi:!0,deps:[Lr,qt,mp]},{provide:pc,useClass:QB,multi:!0,deps:[Lr]},{provide:Up,useClass:Up,deps:[gc,Za,qa]},{provide:Ib,useExisting:Up},{provide:o_,useExisting:Za},{provide:Za,useClass:Za,deps:[Lr]},{provide:Cp,useClass:Cp,deps:[qt]},{provide:gc,useClass:gc,deps:[pc,qt]},{provide:class{},useClass:LB,deps:[]}];let n2=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:qa,useValue:t.appId},{provide:i_,useExisting:qa},FB]}}}return n.\u0275fac=function(t){return new(t||n)(qe(n,12))},n.\u0275mod=Di({type:n}),n.\u0275inj=ii({providers:t2,imports:[xB,sV]}),n})();"undefined"!=typeof window&&window;const{isArray:d2}=Array,{getPrototypeOf:p2,prototype:g2,keys:m2}=Object;const{isArray:w2}=Array;function D2(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function _2(...n){const e=function(n){return xe(Jf(n))?n.pop():void 0}(n),{args:t,keys:r}=function(n){if(1===n.length){const e=n[0];if(d2(e))return{args:e,keys:null};if(function(n){return n&&"object"==typeof n&&p2(n)===g2}(e)){const t=m2(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n),i=new on(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,u=o;for(let c=0;c<o;c++){let d=!1;os(t[c]).subscribe(new Os(s,g=>{d||(d=!0,u--),a[c]=g},()=>l--,void 0,()=>{(!l||!d)&&(u||s.next(r?D2(r,a):a),s.complete())}))}});return e?i.pipe(function(n){return Kf(e=>function(n,e){return w2(e)?n(...e):n(e)}(n,e))}(e)):i}let m_=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(W(gs),W(pr))},n.\u0275dir=ce({type:n}),n})(),vs=(()=>{class n extends m_{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Dn(n)))(r||n)}}(),n.\u0275dir=ce({type:n,features:[He]}),n})();const Vr=new Me("NgValueAccessor"),M2={provide:Vr,useExisting:Ge(()=>zp),multi:!0};let zp=(()=>{class n extends vs{writeValue(t){this.setProperty("checked",t)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Dn(n)))(r||n)}}(),n.\u0275dir=ce({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,r){1&t&&fn("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},features:[tt([M2]),He]}),n})();const S2={provide:Vr,useExisting:Ge(()=>qp),multi:!0},E2=new Me("CompositionEventMode");let qp=(()=>{class n extends m_{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const n=ys()?ys().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(W(gs),W(pr),W(E2,8))},n.\u0275dir=ce({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&fn("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[tt([S2]),He]}),n})();const Kt=new Me("NgValidators"),Ni=new Me("NgAsyncValidators");function x_(n){return null!=n}function E_(n){const e=Hu(n)?Zf(n):n;return uC(e),e}function A_(n){let e={};return n.forEach(t=>{e=null!=t?xn(xn({},e),t):e}),0===Object.keys(e).length?null:e}function k_(n,e){return e.map(t=>t(n))}function T_(n){return n.map(e=>function(n){return!n.validate}(e)?e:t=>e.validate(t))}function Kp(n){return null!=n?function(n){if(!n)return null;const e=n.filter(x_);return 0==e.length?null:function(t){return A_(k_(t,e))}}(T_(n)):null}function Qp(n){return null!=n?function(n){if(!n)return null;const e=n.filter(x_);return 0==e.length?null:function(t){return _2(k_(t,e).map(E_)).pipe(Kf(A_))}}(T_(n)):null}function N_(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Yp(n){return n?Array.isArray(n)?n:[n]:[]}function yc(n,e){return Array.isArray(n)?n.includes(e):n===e}function F_(n,e){const t=Yp(e);return Yp(n).forEach(i=>{yc(t,i)||t.push(i)}),t}function L_(n,e){return Yp(e).filter(t=>!yc(n,t))}class V_{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Kp(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Qp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class pn extends V_{get formDirective(){return null}get path(){return null}}class Pi extends V_{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let H_=(()=>{class n extends class{constructor(e){this._cd=e}is(e){var t,r,i;return"submitted"===e?!!(null==(t=this._cd)?void 0:t.submitted):!!(null==(i=null==(r=this._cd)?void 0:r.control)?void 0:i[e])}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(W(Pi,2))},n.\u0275dir=ce({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&ju("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[He]}),n})();function el(n,e){(function(n,e){const t=function(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(N_(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=function(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(N_(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();bc(e._rawValidators,i),bc(e._rawAsyncValidators,i)})(n,e),e.valueAccessor.writeValue(n.value),function(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&$_(n,e)})}(n,e),function(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&$_(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function bc(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function $_(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function _c(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const tl="VALID",Mc="INVALID",Ao="PENDING",nl="DISABLED";function rg(n){return(sg(n)?n.validators:n)||null}function G_(n){return Array.isArray(n)?Kp(n):n||null}function ig(n,e){return(sg(e)?e.asyncValidators:n)||null}function z_(n){return Array.isArray(n)?Qp(n):n||null}function sg(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const og=n=>n instanceof lg;function K_(n){return(n=>n instanceof J_)(n)?n.value:n.getRawValue()}function Q_(n,e){const t=og(n),r=n.controls;if(!(t?Object.keys(r):r).length)throw new De(1e3,"");if(!r[e])throw new De(1001,"")}function Y_(n,e){og(n),n._forEachChild((r,i)=>{if(void 0===e[i])throw new De(1002,"")})}class ag{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=G_(this._rawValidators),this._composedAsyncValidatorFn=z_(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===tl}get invalid(){return this.status===Mc}get pending(){return this.status==Ao}get disabled(){return this.status===nl}get enabled(){return this.status!==nl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=G_(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=z_(e)}addValidators(e){this.setValidators(F_(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(F_(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(L_(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(L_(e,this._rawAsyncValidators))}hasValidator(e){return yc(this._rawValidators,e)}hasAsyncValidator(e){return yc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ao,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=nl,this.errors=null,this._forEachChild(r=>{r.disable(na(xn({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(na(xn({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=tl,this._forEachChild(r=>{r.enable(na(xn({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(na(xn({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===tl||this.status===Ao)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?nl:tl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ao,this._hasOwnPendingAsyncValidator=!0;const t=E_(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length))return null;let r=n;return e.forEach(i=>{r=og(r)?r.controls.hasOwnProperty(i)?r.controls[i]:null:(n=>n instanceof z2)(r)&&r.at(i)||null}),r}(this,e)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new zt,this.statusChanges=new zt}_calculateStatus(){return this._allControlsDisabled()?nl:this.errors?Mc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ao)?Ao:this._anyControlsHaveStatus(Mc)?Mc:tl}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){sg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class J_ extends ag{constructor(e=null,t,r){super(rg(t),ig(r,t)),this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){_c(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){_c(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class lg extends ag{constructor(e,t,r){super(rg(t),ig(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){Y_(this,e),Object.keys(e).forEach(r=>{Q_(this,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=K_(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const r=this.controls[t];if(this.contains(t)&&e(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,r)=>((t.enabled||this.disabled)&&(e[r]=t.value),e))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class z2 extends ag{constructor(e,t,r){super(rg(t),ig(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){Y_(this,e),e.forEach((r,i)=>{Q_(this,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>K_(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const Q2={provide:Pi,useExisting:Ge(()=>cg)},eM=(()=>Promise.resolve(null))();let cg=(()=>{class n extends Pi{constructor(t,r,i,s){super(),this.control=new J_,this._registered=!1,this.update=new zt,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===qp?t=s:function(n){return Object.getPrototypeOf(n.constructor)===vs}(s)?r=s:i=s}),i||r||t||null}(0,s)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),function(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(n,e){return[...e.path,n]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){el(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){eM.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const r=t.isDisabled.currentValue,i=""===r||r&&"false"!==r;eM.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable()})}}return n.\u0275fac=function(t){return new(t||n)(W(pn,9),W(Kt,10),W(Ni,10),W(Vr,10))},n.\u0275dir=ce({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[tt([Q2]),He,Er]}),n})(),nM=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Di({type:n}),n.\u0275inj=ii({}),n})(),CH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Di({type:n}),n.\u0275inj=ii({imports:[[nM]]}),n})(),bH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Di({type:n}),n.\u0275inj=ii({imports:[CH]}),n})();class Oe{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=ko(this,e,t);let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(t,this.length,i,1),Br.from(i,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=ko(this,e,t);let r=[];return this.decompose(e,t,r,0),Br.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new sl(this),s=new sl(e);for(let o=t,a=t;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(a+=i.value.length,i.done||a>=r)return!0}}iter(e=1){return new sl(this,e)}iterRange(e,t=this.length){return new bM(this,e,t)}iterLines(e,t){let r;if(null==e)r=this.iter();else{null==t&&(t=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new DM(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new pt(e):Br.from(pt.split(e,[])):Oe.empty}}class pt extends Oe{constructor(e,t=function(n){let e=-1;for(let t of n)e+=t.length+1;return e}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.text[s],a=i+o.length;if((t?r:a)>=e)return new _H(i,a,r,o);i=a+1,r++}}decompose(e,t,r,i){let s=e<=0&&t>=this.length?this:new pt(CM(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&i){let o=r.pop(),a=Sc(s.text,o.text.slice(),0,s.length);if(a.length<=32)r.push(new pt(a,o.length+s.length));else{let l=a.length>>1;r.push(new pt(a.slice(0,l)),new pt(a.slice(l)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof pt))return super.replace(e,t,r);[e,t]=ko(this,e,t);let i=Sc(this.text,Sc(r.text,CM(this.text,0,e)),t),s=this.length+r.length-(t-e);return i.length<=32?new pt(i,s):Br.from(pt.split(i,[]),s)}sliceString(e,t=this.length,r="\n"){[e,t]=ko(this,e,t);let i="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(i+=r),e<l&&t>s&&(i+=a.slice(Math.max(0,e-s),t-s)),s=l+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,32==r.length&&(t.push(new pt(r,i)),r=[],i=-1);return i>-1&&t.push(new pt(r,i)),t}}class Br extends Oe{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.children[s],a=i+o.length,l=r+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,r,i);i=a+1,r=l+1}}decompose(e,t,r,i){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&t>=o){let u=i&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!u?r.push(a):a.decompose(e-o,t-o,r,u)}o=l+1}}replace(e,t,r){if([e,t]=ko(this,e,t),r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],a=s+o.length;if(e>=s&&t<=a){let l=o.replace(e-s,t-s,r),u=this.lines-o.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let c=this.children.slice();return c[i]=l,new Br(c,this.length-(t-e)+r.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r="\n"){[e,t]=ko(this,e,t);let i="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(i+=r),e<l&&t>o&&(i+=a.sliceString(e-o,t-o,r)),o=l+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Br))return 0;let r=0,[i,s,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==o||s==a)return r;let l=this.children[i],u=e.children[s];if(l!=u)return r+l.scanIdentical(u,t);r+=l.length+1}}static from(e,t=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let v of e)r+=v.lines;if(r<32){let v=[];for(let C of e)C.flatten(v);return new pt(v,t)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,a=[],l=0,u=-1,c=[];function d(v){let C;if(v.lines>s&&v instanceof Br)for(let D of v.children)d(D);else v.lines>o&&(l>o||!l)?(g(),a.push(v)):v instanceof pt&&l&&(C=c[c.length-1])instanceof pt&&v.lines+C.lines<=32?(l+=v.lines,u+=v.length+1,c[c.length-1]=new pt(C.text.concat(v.text),C.length+1+v.length)):(l+v.lines>i&&g(),l+=v.lines,u+=v.length+1,c.push(v))}function g(){0!=l&&(a.push(1==c.length?c[0]:Br.from(c,u)),u=-1,l=c.length=0)}for(let v of e)d(v);return g(),1==a.length?a[0]:new Br(a,t)}}function Sc(n,e,t=0,r=1e9){for(let i=0,s=0,o=!0;s<n.length&&i<=r;s++){let a=n[s],l=i+a.length;l>=t&&(l>r&&(a=a.slice(0,r-i)),i<t&&(a=a.slice(t-i)),o?(e[e.length-1]+=a,o=!1):e.push(a)),i=l+1}return e}function CM(n,e,t){return Sc(n,[""],e,t)}Oe.empty=new pt([""],0);class sl{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof pt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,a=i instanceof pt?i.text.length:i.children.length;if(o==(t>0?a:0)){if(0==r)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&s)==(t>0?0:1)){if(this.offsets[r]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(i instanceof pt){let l=i.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,l.length>Math.max(0,e))return this.value=0==e?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof pt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class bM{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new sl(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=r?i:t<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class DM{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(Oe.prototype[Symbol.iterator]=function(){return this.iter()},sl.prototype[Symbol.iterator]=bM.prototype[Symbol.iterator]=DM.prototype[Symbol.iterator]=function(){return this});class _H{constructor(e,t,r,i){this.from=e,this.to=t,this.number=r,this.text=i}get length(){return this.to-this.from}}function ko(n,e,t){return[e=Math.max(0,Math.min(n.length,e)),Math.max(e,Math.min(n.length,t))]}let To="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<To.length;n++)To[n]+=To[n-1];function MH(n){for(let e=1;e<To.length;e+=2)if(To[e]>n)return To[e-1]<=n;return!1}function _M(n){return n>=127462&&n<=127487}function Pt(n,e,t=!0,r=!0){return(t?SM:SH)(n,e,r)}function SM(n,e,t){if(e==n.length)return e;e&&xM(n.charCodeAt(e))&&EM(n.charCodeAt(e-1))&&e--;let r=Io(n,e);for(e+=xc(r);e<n.length;){let i=Io(n,e);if(8205==r||8205==i||t&&MH(i))e+=xc(i),r=i;else{if(!_M(i))break;{let s=0,o=e-2;for(;o>=0&&_M(Io(n,o));)s++,o-=2;if(s%2==0)break;e+=2}}}return e}function SH(n,e,t){for(;e>0;){let r=SM(n,e-2,t);if(r<e)return r;e--}return 0}function xM(n){return n>=56320&&n<57344}function EM(n){return n>=55296&&n<56320}function Io(n,e){let t=n.charCodeAt(e);if(!EM(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return xM(r)?r-56320+(t-55296<<10)+65536:t}function xc(n){return n<65536?1:2}const yg=/\r\n?|\n/;var gn=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(gn||(gn={}));class Hr{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,i=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,t=!1){vg(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];i<0?e.push(r,i):e.push(i,r)}return new Hr(e)}composeDesc(e){return this.empty?e:e.empty?this:AM(this,e)}mapDesc(e,t=!1){return e.empty?this:wg(this,e,t)}mapPos(e,t=-1,r=gn.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],u=i+a;if(l<0){if(u>e)return s+(e-i);s+=a}else{if(r!=gn.Simple&&u>=e&&(r==gn.TrackDel&&i<e&&u>e||r==gn.TrackBefore&&i<e||r==gn.TrackAfter&&u>e))return null;if(u>e||u==e&&t<0&&!a)return e==i||t<0?s:s+l;s+=l}i=u}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let r=0,i=0;r<this.sections.length&&i<=t;){let a=i+this.sections[r++];if(this.sections[r++]>=0&&i<=t&&a>=e)return!(i<e&&a>t)||"cover";i=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>"number"!=typeof t))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Hr(e)}static create(e){return new Hr(e)}}class Mt extends Hr{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return vg(this,(t,r,i,s,o)=>e=e.replace(i,i+(r-t),o),!1),e}mapDesc(e,t=!1){return wg(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let i=0,s=0;i<t.length;i+=2){let o=t[i],a=t[i+1];if(a>=0){t[i]=a,t[i+1]=o;let l=i>>1;for(;r.length<l;)r.push(Oe.empty);r.push(o?e.slice(s,s+o):Oe.empty)}s+=o}return new Mt(t,r)}compose(e){return this.empty?e:e.empty?this:AM(this,e,!0)}map(e,t=!1){return e.empty?this:wg(this,e,t,!0)}iterChanges(e,t=!1){vg(this,e,t)}get desc(){return Hr.create(this.sections)}filter(e){let t=[],r=[],i=[],s=new ol(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&0==s.len;){if(s.done)break e;let c=Math.min(s.len,l-a);Qt(i,c,-1);let d=-1==s.ins?-1:0==s.off?s.ins:0;Qt(t,c,d),d>0&&Ri(r,t,s.text),s.forward(c),a+=c}let u=e[o++];for(;a<u;){if(s.done)break e;let c=Math.min(s.len,u-a);Qt(t,c,-1),Qt(i,c,-1==s.ins?-1:0==s.off?s.ins:0),s.forward(c),a+=c}}return{changes:new Mt(t,r),filtered:Hr.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],i=this.sections[t+1];e.push(i<0?r:0==i?[r]:[r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let i=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!i.length)return;o<t&&Qt(i,t-o,-1);let d=new Mt(i,s);a=a?a.compose(d.map(a)):d,i=[],s=[],o=0}return function u(c){if(Array.isArray(c))for(let d of c)u(d);else if(c instanceof Mt){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:d,to:g=d,insert:v}=c;if(d>g||d<0||g>t)throw new RangeError(`Invalid change range ${d} to ${g} (in doc of length ${t})`);let C=v?"string"==typeof v?Oe.of(v.split(r||yg)):v:Oe.empty,D=C.length;if(d==g&&0==D)return;d<o&&l(),d>o&&Qt(i,d-o,-1),Qt(i,g-d,D),Ri(s,i,C),o=g}}(e),l(!a),a}static empty(e){return new Mt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if("number"==typeof s)t.push(s,-1);else{if(!Array.isArray(s)||"number"!=typeof s[0]||s.some((o,a)=>a&&"string"!=typeof o))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==s.length)t.push(s[0],0);else{for(;r.length<i;)r.push(Oe.empty);r[i]=Oe.of(s.slice(1)),t.push(s[0],r[i].length)}}}return new Mt(t,r)}static createSet(e,t){return new Mt(e,t)}}function Qt(n,e,t,r=!1){if(0==e&&t<=0)return;let i=n.length-2;i>=0&&t<=0&&t==n[i+1]?n[i]+=e:0==e&&0==n[i]?n[i+1]+=t:r?(n[i]+=e,n[i+1]+=t):n.push(e,t)}function Ri(n,e,t){if(0==t.length)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(Oe.empty);n.push(t)}}function vg(n,e,t){let r=n.inserted;for(let i=0,s=0,o=0;o<n.sections.length;){let a=n.sections[o++],l=n.sections[o++];if(l<0)i+=a,s+=a;else{let u=i,c=s,d=Oe.empty;for(;u+=a,c+=l,l&&r&&(d=d.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)a=n.sections[o++],l=n.sections[o++];e(i,u,s,c,d),i=u,s=c}}}function wg(n,e,t,r=!1){let i=[],s=r?[]:null,o=new ol(n),a=new ol(e);for(let l=-1;;)if(-1==o.ins&&-1==a.ins){let u=Math.min(o.len,a.len);Qt(i,u,-1),o.forward(u),a.forward(u)}else if(a.ins>=0&&(o.ins<0||l==o.i||0==o.off&&(a.len<o.len||a.len==o.len&&!t))){let u=a.len;for(Qt(i,a.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&l<o.i&&o.len<=c&&(Qt(i,0,o.ins),s&&Ri(s,i,o.text),l=o.i),o.forward(c),u-=c}a.next()}else{if(!(o.ins>=0)){if(o.done&&a.done)return s?Mt.createSet(i,s):Hr.create(i);throw new Error("Mismatched change set lengths")}{let u=0,c=o.len;for(;c;)if(-1==a.ins){let d=Math.min(c,a.len);u+=d,c-=d,a.forward(d)}else{if(!(0==a.ins&&a.len<c))break;c-=a.len,a.next()}Qt(i,u,l<o.i?o.ins:0),s&&l<o.i&&Ri(s,i,o.text),l=o.i,o.forward(o.len-c)}}}function AM(n,e,t=!1){let r=[],i=t?[]:null,s=new ol(n),o=new ol(e);for(let a=!1;;){if(s.done&&o.done)return i?Mt.createSet(r,i):Hr.create(r);if(0==s.ins)Qt(r,s.len,0,a),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),u=r.length;if(-1==s.ins){let c=-1==o.ins?-1:o.off?0:o.ins;Qt(r,l,c,a),i&&c&&Ri(i,r,o.text)}else-1==o.ins?(Qt(r,s.off?0:s.len,l,a),i&&Ri(i,r,s.textBit(l))):(Qt(r,s.off?0:s.len,o.off?0:o.ins,a),i&&!o.off&&Ri(i,r,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||r.length>u),s.forward2(l),o.forward(l)}}else Qt(r,0,o.ins,a),i&&Ri(i,r,o.text),o.next()}}class ol{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Oe.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?Oe.empty:t[r].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class ws{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 16777215==e?void 0:e}map(e,t=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new ws(r,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return V.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return V.range(this.anchor,r)}eq(e,t=!1){return!(this.anchor!=e.anchor||this.head!=e.head||t&&this.empty&&this.assoc!=e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return V.range(e.anchor,e.head)}static create(e,t,r){return new ws(e,t,r)}}class V{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:V.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new V([this.main],0)}addRange(e,t=!0){return V.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,V.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new V(e.ranges.map(t=>ws.fromJSON(t)),e.main)}static single(e,t=e){return new V([V.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return V.normalized(e.slice(),t);r=s.to}return new V(e,t)}static cursor(e,t=0,r,i){return ws.create(e,e,(0==t?0:t<0?8:16)|(null==r?7:Math.min(6,r))|(null!=i?i:16777215)<<6)}static range(e,t,r,i){let s=(null!=r?r:16777215)<<6|(null==i?7:Math.min(6,i));return t<e?ws.create(t,e,48|s):ws.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let r=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?V.range(l,a):V.range(a,l))}}return new V(e,t)}}function kM(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Cg=0;class Y{constructor(e,t,r,i,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=i,this.id=Cg++,this.default=e([]),this.extensions="function"==typeof s?s(this):s}get reader(){return this}static define(e={}){return new Y(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:bg),!!e.static,e.enables)}of(e){return new Ec([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ec(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ec(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function bg(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class Ec{constructor(e,t,r,i){this.dependencies=e,this.facet=t,this.type=r,this.value=i,this.id=Cg++}dynamicSlot(e){var t;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,a=2==this.type,l=!1,u=!1,c=[];for(let d of this.dependencies)"doc"==d?l=!0:"selection"==d?u=!0:0==(1&(null!==(t=e[d.id])&&void 0!==t?t:1))&&c.push(e[d.id]);return{create:d=>(d.values[o]=r(d),1),update(d,g){if(l&&g.docChanged||u&&(g.docChanged||g.selection)||Dg(d,c)){let v=r(d);if(a?!TM(v,d.values[o],i):!i(v,d.values[o]))return d.values[o]=v,1}return 0},reconfigure:(d,g)=>{let v,C=g.config.address[s];if(null!=C){let D=Tc(g,C);if(this.dependencies.every(M=>M instanceof Y?g.facet(M)===d.facet(M):!(M instanceof Mn)||g.field(M,!1)==d.field(M,!1))||(a?TM(v=r(d),D,i):i(v=r(d),D)))return d.values[o]=D,0}else v=r(d);return d.values[o]=v,1}}}}function TM(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function Dg(n,e){let t=!1;for(let r of e)1&ll(n,r)&&(t=!0);return t}function EH(n,e,t){let r=t.map(l=>n[l.id]),i=t.map(l=>l.type),s=r.filter(l=>!(1&l)),o=n[e.id]>>1;function a(l){let u=[];for(let c=0;c<r.length;c++){let d=Tc(l,r[c]);if(2==i[c])for(let g of d)u.push(g);else u.push(d)}return e.combine(u)}return{create(l){for(let u of r)ll(l,u);return l.values[o]=a(l),1},update(l,u){if(!Dg(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,u){let c=Dg(l,r),d=u.config.facets[e.id],g=u.facet(e);if(d&&!c&&bg(t,d))return l.values[o]=g,0;let v=a(l);return e.compare(v,g)?(l.values[o]=g,0):(l.values[o]=v,1)}}}const IM=Y.define({static:!0});class Mn{constructor(e,t,r,i,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new Mn(Cg++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(IM).find(r=>r.field==this);return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,i)=>{let s=r.values[t],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,i)=>null!=i.config.address[this.id]?(r.values[t]=i.field(this),0):(r.values[t]=this.create(r),1)}}init(e){return[this,IM.of({field:this,create:e})]}get extension(){return this}}function al(n){return e=>new OM(e,n)}const bs={highest:al(0),high:al(1),default:al(2),low:al(3),lowest:al(4)};class OM{constructor(e,t){this.inner=e,this.prec=t}}class Ac{of(e){return new _g(this,e)}reconfigure(e){return Ac.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class _g{constructor(e,t){this.compartment=e,this.inner=t}}class kc{constructor(e,t,r,i,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let i=[],s=Object.create(null),o=new Map;for(let g of function(n,e,t){let r=[[],[],[],[],[]],i=new Map;return function s(o,a){let l=i.get(o);if(null!=l){if(l<=a)return;let u=r[l].indexOf(o);u>-1&&r[l].splice(u,1),o instanceof _g&&t.delete(o.compartment)}if(i.set(o,a),Array.isArray(o))for(let u of o)s(u,a);else if(o instanceof _g){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;t.set(o.compartment,u),s(u,a)}else if(o instanceof OM)s(o.inner,o.prec);else if(o instanceof Mn)r[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Ec)r[a].push(o),o.facet.extensions&&s(o.facet.extensions,2);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,a)}}(n,2),r.reduce((o,a)=>o.concat(a))}(e,t,o))g instanceof Mn?i.push(g):(s[g.facet.id]||(s[g.facet.id]=[])).push(g);let a=Object.create(null),l=[],u=[];for(let g of i)a[g.id]=u.length<<1,u.push(v=>g.slot(v));let c=null==r?void 0:r.config.facets;for(let g in s){let v=s[g],C=v[0].facet,D=c&&c[g]||[];if(v.every(M=>0==M.type))if(a[C.id]=l.length<<1|1,bg(D,v))l.push(r.facet(C));else{let M=C.combine(v.map(x=>x.value));l.push(r&&C.compare(M,r.facet(C))?r.facet(C):M)}else{for(let M of v)0==M.type?(a[M.id]=l.length<<1|1,l.push(M.value)):(a[M.id]=u.length<<1,u.push(x=>M.dynamicSlot(x)));a[C.id]=u.length<<1,u.push(M=>EH(M,C,v))}}let d=u.map(g=>g(a));return new kc(e,o,d,a,l,s)}}function ll(n,e){if(1&e)return 2;let t=e>>1,r=n.status[t];if(4==r)throw new Error("Cyclic dependency between fields and/or facets");if(2&r)return r;n.status[t]=4;let i=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|i}function Tc(n,e){return 1&e?n.config.staticValues[e>>1]:n.values[e>>1]}const NM=Y.define(),Mg=Y.define({combine:n=>n.some(e=>e),static:!0}),PM=Y.define({combine:n=>n.length?n[0]:void 0,static:!0}),RM=Y.define(),FM=Y.define(),LM=Y.define(),VM=Y.define({combine:n=>!!n.length&&n[0]});class Fi{constructor(e,t){this.type=e,this.value=t}static define(){return new kH}}class kH{of(e){return new Fi(this,e)}}class TH{constructor(e){this.map=e}of(e){return new st(this,e)}}let st=(()=>{class n{constructor(t,r){this.type=t,this.value=r}map(t){let r=this.type.map(this.value,t);return void 0===r?void 0:r==this.value?this:new n(this.type,r)}is(t){return this.type==t}static define(t={}){return new TH(t.map||(r=>r))}static mapEffects(t,r){if(!t.length)return t;let i=[];for(let s of t){let o=s.map(r);o&&i.push(o)}return i}}return n.reconfigure=n.define(),n.appendConfig=n.define(),n})(),jr=(()=>{class n{constructor(t,r,i,s,o,a){this.startState=t,this.changes=r,this.selection=i,this.effects=s,this.annotations=o,this.scrollIntoView=a,this._doc=null,this._state=null,i&&kM(i,r.newLength),o.some(l=>l.type==n.time)||(this.annotations=o.concat(n.time.of(Date.now())))}static create(t,r,i,s,o,a){return new n(t,r,i,s,o,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let r of this.annotations)if(r.type==t)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let r=this.annotation(n.userEvent);return!(!r||!(r==t||r.length>t.length&&r.slice(0,t.length)==t&&"."==r[t.length]))}}return n.time=Fi.define(),n.userEvent=Fi.define(),n.addToHistory=Fi.define(),n.remote=Fi.define(),n})();function IH(n,e){let t=[];for(let r=0,i=0;;){let s,o;if(r<n.length&&(i==e.length||e[i]>=n[r]))s=n[r++],o=n[r++];else{if(!(i<e.length))return t;s=e[i++],o=e[i++]}!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function BM(n,e,t){var r;let i,s,o;return t?(i=e.changes,s=Mt.empty(e.changes.length),o=n.changes.compose(e.changes)):(i=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):null===(r=n.selection)||void 0===r?void 0:r.map(i),effects:st.mapEffects(n.effects,i).concat(st.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Sg(n,e,t){let r=e.selection,i=Oo(e.annotations);return e.userEvent&&(i=i.concat(jr.userEvent.of(e.userEvent))),{changes:e.changes instanceof Mt?e.changes:Mt.of(e.changes||[],t,n.facet(PM)),selection:r&&(r instanceof V?r:V.single(r.anchor,r.head)),effects:Oo(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function HM(n,e,t){let r=Sg(n,e.length?e[0]:{},n.doc.length);e.length&&!1===e[0].filter&&(t=!1);for(let s=1;s<e.length;s++){!1===e[s].filter&&(t=!1);let o=!!e[s].sequential;r=BM(r,Sg(n,e[s],o?r.changes.newLength:n.doc.length),o)}let i=jr.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return function(n){let e=n.startState,t=e.facet(LM),r=n;for(let i=t.length-1;i>=0;i--){let s=t[i](n);s&&Object.keys(s).length&&(r=BM(r,Sg(e,s,n.changes.newLength),!0))}return r==n?n:jr.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}(t?function(n){let e=n.startState,t=!0;for(let i of e.facet(RM)){let s=i(n);if(!1===s){t=!1;break}Array.isArray(s)&&(t=!0===t?s:IH(t,s))}if(!0!==t){let i,s;if(!1===t)s=n.changes.invertedDesc,i=Mt.empty(e.doc.length);else{let o=n.changes.filter(t);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=jr.create(e,i,n.selection&&n.selection.map(s),st.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(FM);for(let i=r.length-1;i>=0;i--){let s=r[i](n);n=s instanceof jr?s:Array.isArray(s)&&1==s.length&&s[0]instanceof jr?s[0]:HM(e,Oo(s),!1)}return n}(i):i)}const PH=[];function Oo(n){return null==n?PH:Array.isArray(n)?n:[n]}var gt=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(gt||(gt={}));const RH=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let xg;try{xg=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(n){}let vr=(()=>{class n{constructor(t,r,i,s,o,a){this.config=t,this.doc=r,this.selection=i,this.values=s,this.status=t.statusTemplate.slice(),this.computeSlot=o,a&&(a._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)ll(this,l<<1);this.computeSlot=null}field(t,r=!0){let i=this.config.address[t.id];if(null!=i)return ll(this,i),Tc(this,i);if(r)throw new RangeError("Field is not present in this state")}update(...t){return HM(this,t,!0)}applyTransaction(t){let o,r=this.config,{base:i,compartments:s}=r;for(let l of t.effects)l.is(Ac.reconfigure)?(r&&(s=new Map,r.compartments.forEach((u,c)=>s.set(c,u)),r=null),s.set(l.value.compartment,l.value.extension)):l.is(st.reconfigure)?(r=null,i=l.value):l.is(st.appendConfig)&&(r=null,i=Oo(i).concat(l.value));r?o=t.startState.values.slice():(r=kc.resolve(i,s,this),o=new n(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(u,c)=>c.reconfigure(u,this),null).values);let a=t.startState.facet(Mg)?t.newSelection:t.newSelection.asSingle();new n(r,t.newDoc,a,o,(l,u)=>u.update(l,t),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:t},range:V.cursor(r.from+t.length)}))}changeByRange(t){let r=this.selection,i=t(r.ranges[0]),s=this.changes(i.changes),o=[i.range],a=Oo(i.effects);for(let l=1;l<r.ranges.length;l++){let u=t(r.ranges[l]),c=this.changes(u.changes),d=c.map(s);for(let v=0;v<l;v++)o[v]=o[v].map(d);let g=s.mapDesc(c,!0);o.push(u.range.map(g)),s=s.compose(d),a=st.mapEffects(a,d).concat(st.mapEffects(Oo(u.effects),g))}return{changes:s,selection:V.create(o,r.mainIndex),effects:a}}changes(t=[]){return t instanceof Mt?t:Mt.of(t,this.doc.length,this.facet(n.lineSeparator))}toText(t){return Oe.of(t.split(this.facet(n.lineSeparator)||yg))}sliceDoc(t=0,r=this.doc.length){return this.doc.sliceString(t,r,this.lineBreak)}facet(t){let r=this.config.address[t.id];return null==r?t.default:(ll(this,r),Tc(this,r))}toJSON(t){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let s=t[i];s instanceof Mn&&null!=this.config.address[s.id]&&(r[i]=s.spec.toJSON(this.field(t[i]),this))}return r}static fromJSON(t,r={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i)for(let o in i)if(Object.prototype.hasOwnProperty.call(t,o)){let a=i[o],l=t[o];s.push(a.init(u=>a.spec.fromJSON(l,u)))}return n.create({doc:t.doc,selection:V.fromJSON(t.selection),extensions:r.extensions?s.concat([r.extensions]):s})}static create(t={}){let r=kc.resolve(t.extensions||[],new Map),i=t.doc instanceof Oe?t.doc:Oe.of((t.doc||"").split(r.staticFacet(n.lineSeparator)||yg)),s=t.selection?t.selection instanceof V?t.selection:V.single(t.selection.anchor,t.selection.head):V.single(0);return kM(s,i.length),r.staticFacet(Mg)||(s=s.asSingle()),new n(r,i,s,r.dynamicSlots.map(()=>null),(o,a)=>a.create(o),null)}get tabSize(){return this.facet(n.tabSize)}get lineBreak(){return this.facet(n.lineSeparator)||"\n"}get readOnly(){return this.facet(VM)}phrase(t,...r){for(let i of this.facet(n.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return r.length&&(t=t.replace(/\$(\$|\d*)/g,(i,s)=>{if("$"==s)return"$";let o=+(s||1);return!o||o>r.length?i:r[o-1]})),t}languageDataAt(t,r,i=-1){let s=[];for(let o of this.facet(NM))for(let a of o(this,r,i))Object.prototype.hasOwnProperty.call(a,t)&&s.push(a[t]);return s}charCategorizer(t){return function(n){return e=>{if(!/\S/.test(e))return gt.Space;if(function(n){if(xg)return xg.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||RH.test(t)))return!0}return!1}(e))return gt.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return gt.Word;return gt.Other}}(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:r,from:i,length:s}=this.doc.lineAt(t),o=this.charCategorizer(t),a=t-i,l=t-i;for(;a>0;){let u=Pt(r,a,!1);if(o(r.slice(u,a))!=gt.Word)break;a=u}for(;l<s;){let u=Pt(r,l);if(o(r.slice(l,u))!=gt.Word)break;l=u}return a==l?null:V.range(a+i,l+i)}}return n.allowMultipleSelections=Mg,n.tabSize=Y.define({combine:e=>e.length?e[0]:4}),n.lineSeparator=PM,n.readOnly=VM,n.phrases=Y.define({compare(e,t){let r=Object.keys(e),i=Object.keys(t);return r.length==i.length&&r.every(s=>e[s]==t[s])}}),n.languageData=NM,n.changeFilter=RM,n.transactionFilter=FM,n.transactionExtender=LM,n})();function Li(n,e,t={}){let r={};for(let i of n)for(let s of Object.keys(i)){let o=i[s],a=r[s];if(void 0===a)r[s]=o;else if(a!==o&&void 0!==o){if(!Object.hasOwnProperty.call(t,s))throw new Error("Config merge conflict for field "+s);r[s]=t[s](a,o)}}for(let i in e)void 0===r[i]&&(r[i]=e[i]);return r}Ac.reconfigure=st.define();class No{eq(e){return this==e}range(e,t=e){return ul.create(e,t,this)}}No.prototype.startSide=No.prototype.endSide=0,No.prototype.point=!1,No.prototype.mapMode=gn.TrackDel;class ul{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new ul(e,t,r)}}function Eg(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Ag{constructor(e,t,r,i){this.from=e,this.to=t,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,i=0){let s=r?this.to:this.from;for(let o=i,a=s.length;;){if(o==a)return o;let l=o+a>>1,u=s[l]-e||(r?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return u>=0?o:a;u>=0?a=l:o=l+1}}between(e,t,r,i){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(!1===i(this.from[s]+e,this.to[s]+e,this.value[s]))return!1}map(e,t){let r=[],i=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let g,v,u=this.value[l],c=this.from[l]+e,d=this.to[l]+e;if(c==d){let C=t.mapPos(c,u.startSide,u.mapMode);if(null==C||(g=v=C,u.startSide!=u.endSide&&(v=t.mapPos(c,u.endSide),v<g)))continue}else if(g=t.mapPos(c,u.startSide),v=t.mapPos(d,u.endSide),g>v||g==v&&u.startSide>0&&u.endSide<=0)continue;(v-g||u.endSide-u.startSide)<0||(o<0&&(o=g),u.point&&(a=Math.max(a,v-g)),r.push(u),i.push(g-o),s.push(v-o))}return{mapped:r.length?new Ag(i,s,r,a):null,pos:o}}}let St=(()=>{class n{constructor(t,r,i,s){this.chunkPos=t,this.chunk=r,this.nextLayer=i,this.maxPoint=s}static create(t,r,i,s){return new n(t,r,i,s)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let r of this.chunk)t+=r.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:r=[],sort:i=!1,filterFrom:s=0,filterTo:o=this.length}=t,a=t.filter;if(0==r.length&&!a)return this;if(i&&(r=r.slice().sort(Eg)),this.isEmpty)return r.length?n.of(r):this;let l=new $M(this,null,-1).goto(0),u=0,c=[],d=new di;for(;l.value||u<r.length;)if(u<r.length&&(l.from-r[u].from||l.startSide-r[u].value.startSide)>=0){let g=r[u++];d.addInner(g.from,g.to,g.value)||c.push(g)}else 1==l.rangeIndex&&l.chunkIndex<this.chunk.length&&(u==r.length||this.chunkEnd(l.chunkIndex)<r[u].from)&&(!a||s>this.chunkEnd(l.chunkIndex)||o<this.chunkPos[l.chunkIndex])&&d.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!a||s>l.to||o<l.from||a(l.from,l.to,l.value))&&(d.addInner(l.from,l.to,l.value)||c.push(ul.create(l.from,l.to,l.value))),l.next());return d.finishInner(this.nextLayer.isEmpty&&!c.length?n.empty:this.nextLayer.update({add:c,filter:a,filterFrom:s,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let r=[],i=[],s=-1;for(let a=0;a<this.chunk.length;a++){let l=this.chunkPos[a],u=this.chunk[a],c=t.touchesRange(l,l+u.length);if(!1===c)s=Math.max(s,u.maxPoint),r.push(u),i.push(t.mapPos(l));else if(!0===c){let{mapped:d,pos:g}=u.map(l,t);d&&(s=Math.max(s,d.maxPoint),r.push(d),i.push(g))}}let o=this.nextLayer.map(t);return 0==r.length?o:new n(i,r,o||n.empty,s)}between(t,r,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let o=this.chunkPos[s],a=this.chunk[s];if(r>=o&&t<=o+a.length&&!1===a.between(o,t-o,r-o,i))return}this.nextLayer.between(t,r,i)}}iter(t=0){return cl.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,r=0){return cl.from(t).goto(r)}static compare(t,r,i,s,o=-1){let a=t.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=o),l=r.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=o),u=jM(a,l,i),c=new fl(a,u,o),d=new fl(l,u,o);i.iterGaps((g,v,C)=>UM(c,g,d,v,C,s)),i.empty&&0==i.length&&UM(c,0,d,0,0,s)}static eq(t,r,i=0,s){null==s&&(s=999999999);let o=t.filter(d=>!d.isEmpty&&r.indexOf(d)<0),a=r.filter(d=>!d.isEmpty&&t.indexOf(d)<0);if(o.length!=a.length)return!1;if(!o.length)return!0;let l=jM(o,a),u=new fl(o,l,0).goto(i),c=new fl(a,l,0).goto(i);for(;;){if(u.to!=c.to||!Tg(u.active,c.active)||u.point&&(!c.point||!u.point.eq(c.point)))return!1;if(u.to>s)return!0;u.next(),c.next()}}static spans(t,r,i,s,o=-1){let a=new fl(t,null,o).goto(r),l=r,u=a.openStart;for(;;){let c=Math.min(a.to,i);if(a.point){let d=a.activeForPoint(a.to),g=a.pointFrom<r?d.length+1:a.point.startSide<0?d.length:Math.min(d.length,u);s.point(l,c,a.point,d,g,a.pointRank),u=Math.min(a.openEnd(c),d.length)}else c>l&&(s.span(l,c,a.active,u),u=a.openEnd(c));if(a.to>i)return u+(a.point&&a.to>i?1:0);l=a.to,a.next()}}static of(t,r=!1){let i=new di;for(let s of t instanceof ul?[t]:r?function(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(Eg(e,r)>0)return n.slice().sort(Eg);e=r}return n}(t):t)i.add(s.from,s.to,s.value);return i.finish()}static join(t){if(!t.length)return n.empty;let r=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let s=t[i];s!=n.empty;s=s.nextLayer)r=new n(s.chunkPos,s.chunk,r,Math.max(s.maxPoint,r.maxPoint));return r}}return n.empty=new n([],[],null,-1),n})();St.empty.nextLayer=St.empty;class di{finishChunk(e){this.chunks.push(new Ag(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new di)).add(e,t,r)}addInner(e,t,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(i<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),0))}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(St.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=St.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function jM(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=r.get(s.chunk[o]);null!=a&&(t?t.mapPos(a):a)==s.chunkPos[o]&&!(null==t?void 0:t.touchesRange(a,a+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class $M{constructor(e,t,r,i=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex];if(this.from=e+t.from[this.rangeIndex],this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class cl{constructor(e){this.heap=e}static from(e,t=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new $M(o,t,r,s));return 1==i.length?i[0]:new cl(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)kg(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)kg(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),kg(this.heap,0)}}}function kg(n,e){for(let t=n[e];;){let r=1+(e<<1);if(r>=n.length)break;let i=n[r];if(r+1<n.length&&i.compare(n[r+1])>=0&&(i=n[r+1],r++),t.compare(i)<0)break;n[r]=t,n[e]=i,e=r}}class fl{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=cl.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ic(this.active,e),Ic(this.activeTo,e),Ic(this.activeRank,e),this.minActive=WM(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||i-this.activeTo[t])>0;)t++;Oc(this.active,t,r),Oc(this.activeTo,t,i),Oc(this.activeRank,t,s),e&&Oc(e,t,this.cursor.from),this.minActive=WM(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),r&&Ic(r,i)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let s=this.cursor.value;if(s.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(r),this.cursor.next()}}}if(r){this.openStart=0;for(let i=r.length-1;i>=0&&r[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function UM(n,e,t,r,i,s){n.goto(e),t.goto(r);let o=r+i,a=r,l=r-e;for(;;){let u=n.to+l-t.to||n.endSide-t.endSide,c=u<0?n.to+l:t.to,d=Math.min(c,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&Tg(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(a,d,n.point,t.point):d>a&&!Tg(n.active,t.active)&&s.compareRange(a,d,n.active,t.active),c>o)break;a=c,u<=0&&n.next(),u>=0&&t.next()}}function Tg(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function Ic(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function Oc(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function WM(n,e){let t=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||n[i].endSide-n[t].endSide)<0&&(t=i,r=e[i]);return t}function hl(n,e,t=n.length){let r=0;for(let i=0;i<t;)9==n.charCodeAt(i)?(r+=e-r%e,i++):(r++,i=Pt(n,i));return r}const GM="undefined"==typeof Symbol?"__\u037c":Symbol.for("\u037c"),Og="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),zM="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class Vi{constructor(e,t){this.rules=[];let{finish:r}=t||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,u){let c=[],d=/^@(\w+)\b/.exec(o[0]),g=d&&"keyframes"==d[1];if(d&&null==a)return l.push(o[0]+";");for(let v in a){let C=a[v];if(/&/.test(v))s(v.split(/,\s*/).map(D=>o.map(M=>D.replace(/&/,M))).reduce((D,M)=>D.concat(M)),C,l);else if(C&&"object"==typeof C){if(!d)throw new RangeError("The value of a property ("+v+") should be a primitive value.");s(i(v),C,c,g)}else null!=C&&c.push(v.replace(/_.*/,"").replace(/[A-Z]/g,D=>"-"+D.toLowerCase())+": "+C+";")}(c.length||g)&&l.push((!r||d||u?o:o.map(r)).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=zM[GM]||1;return zM[GM]=e+1,"\u037c"+e.toString(36)}static mount(e,t,r){let i=e[Og],s=r&&r.nonce;i?s&&i.setNonce(s):i=new HH(e,s),i.mount(Array.isArray(t)?t:[t],e)}}let qM=new Map;class HH{constructor(e,t){let r=e.ownerDocument||e,i=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=qM.get(r);if(s)return e[Og]=s;this.sheet=new i.CSSStyleSheet,qM.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[Og]=this}mount(e,t){let r=this.sheet,i=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<s&&l>-1&&(this.modules.splice(l,1),s--,l=-1),-1==l){if(this.modules.splice(s++,0,a),r)for(let u=0;u<a.rules.length;u++)r.insertRule(a.rules[u],i++)}else{for(;s<l;)i+=this.modules[s++].rules.length;i+=a.rules.length,s++}}if(r)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+"\n";this.styleTag.textContent=o;let a=t.head||t;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var Bi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},dl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},jH="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),$H="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Rt=0;Rt<10;Rt++)Bi[48+Rt]=Bi[96+Rt]=String(Rt);for(Rt=1;Rt<=24;Rt++)Bi[Rt+111]="F"+Rt;for(Rt=65;Rt<=90;Rt++)Bi[Rt]=String.fromCharCode(Rt+32),dl[Rt]=String.fromCharCode(Rt);for(var Ng in Bi)dl.hasOwnProperty(Ng)||(dl[Ng]=Bi[Ng]);function Nc(n){let e;return e=11==n.nodeType?n.getSelection?n:n.ownerDocument:n,e.getSelection()}function Pg(n,e){return!!e&&(n==e||n.contains(1!=e.nodeType?e.parentNode:e))}function Pc(n,e){if(!e.anchorNode)return!1;try{return Pg(n,e.anchorNode)}catch(t){return!1}}function Po(n){return 3==n.nodeType?_s(n,0,n.nodeValue.length).getClientRects():1==n.nodeType?n.getClientRects():[]}function pl(n,e,t,r){return!!t&&(KM(n,e,t,r,-1)||KM(n,e,t,r,1))}function Ds(n){for(var e=0;;e++)if(!(n=n.previousSibling))return e}function Rc(n){return 1==n.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function KM(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:pi(n))){if("DIV"==n.nodeName)return!1;let s=n.parentNode;if(!s||1!=s.nodeType)return!1;e=Ds(n)+(i<0?0:1),n=s}else{if(1!=n.nodeType)return!1;if(1==(n=n.childNodes[e+(i<0?-1:0)]).nodeType&&"false"==n.contentEditable)return!1;e=i<0?pi(n):0}}}function pi(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function Fc(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function GH(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function QM(n,e){let t=e.width/n.offsetWidth,r=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-n.offsetHeight)<1)&&(r=1),{scaleX:t,scaleY:r}}class KH{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?pi(t):0),r,Math.min(e.focusOffset,r?pi(r):0))}set(e,t,r,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=i}}let JM,Ro=null;function YM(n){if(n.setActive)return n.setActive();if(Ro)return n.focus(Ro);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(null==Ro?{get preventScroll(){return Ro={preventScroll:!0},!0}}:void 0),!Ro){Ro=!1;for(let t=0;t<e.length;){let r=e[t++],i=e[t++],s=e[t++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}function _s(n,e,t=e){let r=JM||(JM=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function Fo(n,e,t,r){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};r&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=r);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function ZM(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function XM(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function e1(n,e){for(let t=n,r=e;;){if(3==t.nodeType&&r>0)return{node:t,offset:r};if(1==t.nodeType&&r>0){if("false"==t.contentEditable)return null;t=t.childNodes[r-1],r=pi(t)}else{if(!t.parentNode||Rc(t))return null;r=Ds(t),t=t.parentNode}}}function t1(n,e){for(let t=n,r=e;;){if(3==t.nodeType&&r<t.nodeValue.length)return{node:t,offset:r};if(1==t.nodeType&&r<t.childNodes.length){if("false"==t.contentEditable)return null;t=t.childNodes[r],r=0}else{if(!t.parentNode||Rc(t))return null;r=Ds(t)+1,t=t.parentNode}}}class Yt{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new Yt(e.parentNode,Ds(e),t)}static after(e,t){return new Yt(e.parentNode,Ds(e)+1,t)}}const Rg=[];class je{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(2&this.flags){let s,r=this.dom,i=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(s=i?i.nextSibling:r.firstChild)){let a=je.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=i?i.nextSibling:r.firstChild,t&&!t.written&&t.node==r&&s!=o.dom&&(t.written=!0),o.dom.parentNode==r)for(;s&&s!=o.dom;)s=n1(s);else r.insertBefore(o.dom,s);i=o.dom}for(s=i?i.nextSibling:r.firstChild,s&&t&&t.node==r&&(t.written=!0);s;)s=n1(s)}else if(1&this.flags)for(let r of this.children)7&r.flags&&(r.sync(e,t),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let r;if(e==this.dom)r=this.dom.childNodes[t];else{let i=0==pi(e)?0:0==t?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;0==i&&s.firstChild!=s.lastChild&&(i=e==s.firstChild?-1:1),e=s}r=i<0?e:e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!je.get(r);)r=r.nextSibling;if(!r)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==r)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,r=0){let i=-1,s=-1,o=-1,a=-1;for(let l=0,u=r,c=r;l<this.children.length;l++){let d=this.children[l],g=u+d.length;if(u<e&&g>t)return d.domBoundsAround(e,t,u);if(g>=e&&-1==i&&(i=l,s=u),u>t&&d.dom.parentNode==this.dom){o=l,a=c;break}c=g,u=g+d.breakAfter}return{from:s,to:a<0?r+this.length:a,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),1&t.flags)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,7&this.flags&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,r=Rg){this.markDirty();for(let i=e;i<t;i++){let s=this.children[i];s.parent==this&&r.indexOf(s)<0&&s.destroy()}this.children.splice(e,t-e,...r);for(let i=0;i<r.length;i++)r[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new r1(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,r,i,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!(8&(this.flags|e.flags))}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}function n1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}je.prototype.breakAfter=0;class r1{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function i1(n,e,t,r,i,s,o,a,l){let{children:u}=n,c=u.length?u[e]:null,d=s.length?s[s.length-1]:null,g=d?d.breakAfter:o;if(!(e==r&&c&&!o&&!g&&s.length<2&&c.merge(t,i,s.length?d:null,0==t,a,l))){if(r<u.length){let v=u[r];v&&(i<v.length||v.breakAfter&&(null==d?void 0:d.breakAfter))?(e==r&&(v=v.split(i),i=0),!g&&d&&v.merge(0,i,d,!0,0,l)?s[s.length-1]=v:((i||v.children.length&&!v.children[0].length)&&v.merge(0,i,null,!1,0,l),s.push(v))):(null==v?void 0:v.breakAfter)&&(d?d.breakAfter=1:o=1),r++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(t,c.length,null,!1,a,0),e++));e<r&&s.length;)if(u[r-1].become(s[s.length-1]))r--,s.pop(),l=s.length?0:a;else{if(!u[e].become(s[0]))break;e++,s.shift(),a=s.length?0:l}!s.length&&e&&r<u.length&&!u[e-1].breakAfter&&u[r].merge(0,0,u[e-1],!1,a,l)&&e--,(e<r||s.length)&&n.replaceChildren(e,r,s)}}function s1(n,e,t,r,i,s){let o=n.childCursor(),{i:a,off:l}=o.findPos(t,1),{i:u,off:c}=o.findPos(e,-1),d=e-t;for(let g of r)d+=g.length;n.length+=d,i1(n,u,c,a,l,r,0,i,s)}let Rn="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Fg="undefined"!=typeof document?document:{documentElement:{style:{}}};const Lg=/Edge\/(\d+)/.exec(Rn.userAgent),o1=/MSIE \d/.test(Rn.userAgent),Vg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Rn.userAgent),Lc=!!(o1||Vg||Lg),a1=!Lc&&/gecko\/(\d+)/i.test(Rn.userAgent),Bg=!Lc&&/Chrome\/(\d+)/.exec(Rn.userAgent),l1="webkitFontSmoothing"in Fg.documentElement.style,u1=!Lc&&/Apple Computer/.test(Rn.vendor),c1=u1&&(/Mobile\/\w+/.test(Rn.userAgent)||Rn.maxTouchPoints>2);var Q={mac:c1||/Mac/.test(Rn.platform),windows:/Win/.test(Rn.platform),linux:/Linux|X11/.test(Rn.platform),ie:Lc,ie_version:o1?Fg.documentMode||6:Vg?+Vg[1]:Lg?+Lg[1]:0,gecko:a1,gecko_version:a1?+(/Firefox\/(\d+)/.exec(Rn.userAgent)||[0,0])[1]:0,chrome:!!Bg,chrome_version:Bg?+Bg[1]:0,ios:c1,android:/Android\b/.test(Rn.userAgent),webkit:l1,safari:u1,webkit_version:l1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Fg.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class wr extends je{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,r){return!(8&this.flags||r&&(!(r instanceof wr)||this.length-(t-e)+r.length>256||8&r.flags)||(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),0))}split(e){let t=new wr(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=8&this.flags,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Yt(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return function(n,e,t){let r=n.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;0==e&&t<0||e==r&&t>=0?Q.chrome||Q.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):t<0?i--:s<r&&s++;let a=_s(n,i,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:t>=0)?0:a.length-1];return Q.safari&&!o&&0==l.width&&(l=Array.prototype.find.call(a,u=>u.width)||l),o?Fc(l,o<0):l||null}(this.dom,e,t)}}class gi extends je{constructor(e,t=[],r=0){super(),this.mark=e,this.children=t,this.length=r;for(let i of t)i.setParent(this)}setAttrs(e){if(ZM(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!(8&(this.flags|e.flags))}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,r,i,s,o){return!(r&&(!(r instanceof gi&&r.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)||(s1(this,e,t,r?r.children.slice():[],s-1,o-1),this.markDirty(),0))}split(e){let t=[],r=0,i=-1,s=0;for(let a of this.children){let l=r+a.length;l>e&&t.push(r<e?a.split(e-r):a),i<0&&r>=e&&(i=s),r=l,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new gi(this.mark,t,o)}domAtPos(e){return f1(this,e)}coordsAt(e,t){return d1(this,e,t)}}class Hi extends je{static create(e,t,r){return new Hi(e,t,r)}constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}split(e){let t=Hi.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,r,i,s,o){return!(r&&(!(r instanceof Hi&&this.widget.compare(r.widget))||e>0&&s<=0||t<this.length&&o<=0)||(this.length=e+(r?r.length:0)+(this.length-t),0))}become(e){return e instanceof Hi&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return Oe.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,r=t&&t.state.doc,i=this.posAtStart;return r?r.slice(i,i+this.length):Oe.empty}domAtPos(e){return(this.length?0==e:this.side>0)?Yt.before(this.dom):Yt.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);if(r)return r;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?i.length-1:0;s=i[a],!(e>0?0==a:a==i.length-1||s.top<s.bottom);a+=o?-1:1);return Fc(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Lo extends je{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Lo&&e.side==this.side}split(){return new Lo(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Yt.before(this.dom):Yt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Oe.empty}get isHidden(){return!0}}function f1(n,e){let t=n.dom,{children:r}=n,i=0;for(let s=0;i<r.length;i++){let o=r[i],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=i;s>0;s--){let o=r[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=i;s<r.length;s++){let o=r[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new Yt(t,0)}function h1(n,e,t){let r,{children:i}=n;t>0&&e instanceof gi&&i.length&&(r=i[i.length-1])instanceof gi&&r.mark.eq(e.mark)?h1(r,e.children[0],t-1):(i.push(e),e.setParent(n)),n.length+=e.length}function d1(n,e,t){let r=null,i=-1,s=null,o=-1;!function a(u,c){for(let d=0,g=0;d<u.children.length&&g<=c;d++){let v=u.children[d],C=g+v.length;C>=c&&(v.children.length?a(v,c-g):(!s||s.isHidden&&t>0)&&(C>c||g==C&&v.getSide()>0)?(s=v,o=c-g):(g<c||g==C&&v.getSide()<0&&!v.isHidden)&&(r=v,i=c-g)),g=C}}(n,e);let l=(t<0?r:s)||r||s;return l?l.coordsAt(Math.max(0,l==r?i:o),t):function(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Po(e);return t[t.length-1]||null}(n)}function Hg(n,e){for(let t in n)"class"==t&&e.class?e.class+=" "+n.class:"style"==t&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}wr.prototype.children=Hi.prototype.children=Lo.prototype.children=Rg;const p1=Object.create(null);function jg(n,e,t){if(n==e)return!0;n||(n=p1),e||(e=p1);let r=Object.keys(n),i=Object.keys(e);if(r.length-(t&&r.indexOf(t)>-1?1:0)!=i.length-(t&&i.indexOf(t)>-1?1:0))return!1;for(let s of r)if(s!=t&&(-1==i.indexOf(s)||n[s]!==e[s]))return!1;return!0}function $g(n,e,t){let r=!1;if(e)for(let i in e)t&&i in t||(r=!0,"style"==i?n.style.cssText="":n.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(r=!0,"style"==i?n.style.cssText=t[i]:n.setAttribute(i,t[i]));return r}function ej(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];e[r.name]=r.value}return e}class xt extends je{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,i,s,o){if(r){if(!(r instanceof xt))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),s1(this,e,t,r?r.children.slice():[],s,o),!0}split(e){let t=new xt;if(t.breakAfter=this.breakAfter,0==this.length)return t;let{i:r,off:i}=this.childPos(e);i&&(t.append(this.children[r].split(i),0),this.children[r].merge(i,this.children[r].length,null,!1,0,0),r++);for(let s=r;s<this.children.length;s++)t.append(this.children[s],0);for(;r>0&&0==this.children[r-1].length;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){jg(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){h1(this,e,t)}addLineDeco(e){let t=e.spec.attributes,r=e.spec.class;t&&(this.attrs=Hg(t,this.attrs||{})),r&&(this.attrs=Hg({class:r},this.attrs||{}))}domAtPos(e){return f1(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,t){var r;this.dom?4&this.flags&&(ZM(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&($g(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&je.get(i)instanceof gi;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(r=je.get(i))||void 0===r?void 0:r.isEditable)||Q.ios&&this.children.some(s=>s instanceof wr)))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let r of this.children){if(!(r instanceof wr)||/[^ -~]/.test(r.text))return null;let i=Po(r.dom);if(1!=i.length)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let r=d1(this,e,t);if(!this.children.length&&r&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=r.bottom-r.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let o=(s-i.textHeight)/2;return{top:r.top+o,bottom:r.bottom-o,left:r.left,right:r.left}}}return r}become(e){return!1}covers(){return!0}static find(e,t){for(let r=0,i=0;r<e.children.length;r++){let s=e.children[r],o=i+s.length;if(o>=t){if(s instanceof xt)return s;if(o>t)break}i=o+s.breakAfter}return null}}class ji extends je{constructor(e,t,r){super(),this.widget=e,this.length=t,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,i,s,o){return!(r&&(!(r instanceof ji&&this.widget.compare(r.widget))||e>0&&s<=0||t<this.length&&o<=0)||(this.length=e+(r?r.length:0)+(this.length-t),0))}domAtPos(e){return 0==e?Yt.before(this.dom):Yt.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let r=new ji(this.widget,t,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return Rg}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Oe.empty}domBoundsAround(){return null}become(e){return e instanceof ji&&e.widget.constructor==this.widget.constructor&&(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:r}=this.deco;return t!=r&&(e<0?t<0:r>0)}}class Ms{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var mn=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(mn||(mn={}));class Z extends No{constructor(e,t,r,i){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new gl(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new $i(e,t,t,r,e.widget||null,!1)}static replace(e){let r,i,t=!!e.block;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=g1(e,t);r=(s?t?-3e8:-1:5e8)-1,i=1+(o?t?2e8:1:-6e8)}return new $i(e,r,i,t,e.widget||null,!0)}static line(e){return new ml(e)}static set(e,t=!1){return St.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}Z.none=St.empty;class gl extends Z{constructor(e){let{start:t,end:r}=g1(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,r;return this==e||e instanceof gl&&this.tagName==e.tagName&&(this.class||(null===(t=this.attrs)||void 0===t?void 0:t.class))==(e.class||(null===(r=e.attrs)||void 0===r?void 0:r.class))&&jg(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}gl.prototype.point=!1;class ml extends Z{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ml&&this.spec.class==e.spec.class&&jg(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}ml.prototype.mapMode=gn.TrackBefore,ml.prototype.point=!0;class $i extends Z{constructor(e,t,r,i,s,o){super(t,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?t<=0?gn.TrackBefore:gn.TrackAfter:gn.TrackDel}get type(){return this.startSide!=this.endSide?mn.WidgetRange:this.startSide<=0?mn.WidgetBefore:mn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof $i&&function(n,e){return n==e||!!(n&&e&&n.compare(e))}(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function g1(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return null==t&&(t=n.inclusive),null==r&&(r=n.inclusive),{start:null!=t?t:e,end:null!=r?r:e}}function Ug(n,e,t,r=0){let i=t.length-1;i>=0&&t[i]+r>=n?t[i]=Math.max(t[i],e):t.push(n,e)}$i.prototype.point=!0;class yl{constructor(e,t,r,i){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof ji&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new xt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Vc(new Lo(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof ji)&&this.getLine()}buildText(e,t,r){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-r)),this.getLine().append(Vc(new wr(this.text.slice(this.textOff,this.textOff+i)),t),r),this.atCursorPos=!0,this.textOff+=i,e-=i,r=0}}span(e,t,r,i){this.buildText(t-e,r,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,r,i,s,o){if(this.disallowBlockEffectsFor[o]&&r instanceof $i){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=t-e;if(r instanceof $i)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ji(r.widget||m1.block,a,r));else{let l=Hi.create(r.widget||m1.inline,a,a?0:r.startSide),u=this.atCursorPos&&!l.isEditable&&s<=i.length&&(e<t||r.startSide>0),c=!l.isEditable&&(e<t||s>i.length||r.startSide<=0),d=this.getLine();2==this.pendingBuffer&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),u&&(d.append(Vc(new Lo(1),i),s),s=i.length+Math.max(0,s-i.length)),d.append(Vc(l,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,r,i,s){let o=new yl(e,t,r,s);return o.openEnd=St.spans(i,t,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Vc(n,e){for(let t of e)n=new gi(t,[n],n.length);return n}let m1=(()=>{class n extends Ms{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}return n.inline=new n("span"),n.block=new n("div"),n})();var $e=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}($e||($e={}));const Ss=$e.LTR,Wg=$e.RTL;function y1(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const nj=y1("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),rj=y1("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Gg=Object.create(null),$r=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Gg[e]=t,Gg[t]=-e}function v1(n){return n<=247?nj[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?rj[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const ij=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ui{get dir(){return this.level%2?Wg:Ss}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,i){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==r)return o;(s<0||(0!=i?i<0?a.from<t:a.to>t:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function w1(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],i=e[t];if(r.from!=i.from||r.to!=i.to||r.direction!=i.direction||!w1(r.inner,i.inner))return!1}return!0}const Ue=[];function zg(n,e,t,r,i,s,o){let a=r%2?2:1;if(r%2==i%2)for(let l=e,u=0;l<t;){let c=!0,d=!1;if(u==s.length||l<s[u].from){let D=Ue[l];D!=a&&(c=!1,d=16==D)}let g=c||1!=a?null:[],v=c?r:r+1,C=l;e:for(;;)if(u<s.length&&C==s[u].from){if(d)break e;let D=s[u];if(!c)for(let M=D.to,x=u+1;;){if(M==t)break e;if(!(x<s.length&&s[x].from==M)){if(Ue[M]==a)break e;break}M=s[x++].to}u++,g?g.push(D):(D.from>l&&o.push(new Ui(l,D.from,v)),qg(n,D.direction==Ss!=!(v%2)?r+1:r,i,D.inner,D.from,D.to,o),l=D.to),C=D.to}else{if(C==t||(c?Ue[C]!=a:Ue[C]==a))break;C++}g?zg(n,l,C,r+1,i,g,o):l<C&&o.push(new Ui(l,C,v)),l=C}else for(let l=t,u=s.length;l>e;){let c=!0,d=!1;if(!u||l>s[u-1].to){let D=Ue[l-1];D!=a&&(c=!1,d=16==D)}let g=c||1!=a?null:[],v=c?r:r+1,C=l;e:for(;;)if(u&&C==s[u-1].to){if(d)break e;let D=s[--u];if(!c)for(let M=D.from,x=u;;){if(M==e)break e;if(!x||s[x-1].to!=M){if(Ue[M-1]==a)break e;break}M=s[--x].from}g?g.push(D):(D.to<l&&o.push(new Ui(D.to,l,v)),qg(n,D.direction==Ss!=!(v%2)?r+1:r,i,D.inner,D.from,D.to,o),l=D.from),C=D.from}else{if(C==e||(c?Ue[C-1]!=a:Ue[C-1]==a))break;C--}g?zg(n,C,l,r+1,i,g,o):C<l&&o.push(new Ui(C,l,v)),l=C}}function qg(n,e,t,r,i,s,o){let a=e%2?2:1;(function(n,e,t,r,i){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,a=s<r.length?r[s].from:t,l=s?256:i;for(let u=o,c=l,d=l;u<a;u++){let g=v1(n.charCodeAt(u));512==g?g=c:8==g&&4==d&&(g=16),Ue[u]=4==g?2:g,7&g&&(d=g),c=g}for(let u=o,c=l,d=l;u<a;u++){let g=Ue[u];if(128==g)u<a-1&&c==Ue[u+1]&&24&c?g=Ue[u]=c:Ue[u]=256;else if(64==g){let v=u+1;for(;v<a&&64==Ue[v];)v++;let C=u&&8==c||v<t&&8==Ue[v]?1==d?1:8:256;for(let D=u;D<v;D++)Ue[D]=C;u=v-1}else 8==g&&1==d&&(Ue[u]=1);c=g,7&g&&(d=g)}}})(n,i,s,r,a),function(n,e,t,r,i){let s=1==i?2:1;for(let o=0,a=0,l=0;o<=r.length;o++){let c=o<r.length?r[o].from:t;for(let g,v,C,d=o?r[o-1].to:e;d<c;d++)if(v=Gg[g=n.charCodeAt(d)])if(v<0){for(let D=a-3;D>=0;D-=3)if($r[D+1]==-v){let M=$r[D+2],x=2&M?i:4&M?1&M?s:i:0;x&&(Ue[d]=Ue[$r[D]]=x),a=D;break}}else{if(189==$r.length)break;$r[a++]=d,$r[a++]=g,$r[a++]=l}else if(2==(C=Ue[d])||1==C){let D=C==i;l=D?0:1;for(let M=a-3;M>=0;M-=3){let x=$r[M+2];if(2&x)break;if(D)$r[M+2]|=2;else{if(4&x)break;$r[M+2]|=4}}}}}(n,i,s,r,a),function(n,e,t,r){for(let i=0,s=r;i<=t.length;i++){let a=i<t.length?t[i].from:e;for(let l=i?t[i-1].to:n;l<a;){let u=Ue[l];if(256==u){let c=l+1;for(;;)if(c==a){if(i==t.length)break;c=t[i++].to,a=i<t.length?t[i].from:e}else{if(256!=Ue[c])break;c++}let d=1==s,v=d==(1==(c<e?Ue[c]:r))?d?1:2:r;for(let C=c,D=i,M=D?t[D-1].to:n;C>l;)C==M&&(C=t[--D].from,M=D?t[D-1].to:n),Ue[--C]=v;l=c}else s=u,l++}}}(i,s,r,a),zg(n,i,s,e,t,r,o)}function b1(n){return[new Ui(0,n,0)]}let D1="";function _1(n,e,t,r,i){var s;let o=r.head-n.from,a=Ui.find(e,o,null!==(s=r.bidiLevel)&&void 0!==s?s:-1,r.assoc),l=e[a],u=l.side(i,t);if(o==u){let g=a+=i?1:-1;if(g<0||g>=e.length)return null;l=e[a=g],o=l.side(!i,t),u=l.side(i,t)}let c=Pt(n.text,o,l.forward(i,t));(c<l.from||c>l.to)&&(c=u),D1=n.text.slice(Math.min(o,c),Math.max(o,c));let d=a==(i?e.length-1:0)?null:e[a+(i?1:-1)];return d&&c==u&&d.level+(i?0:1)<l.level?V.cursor(d.side(!i,t)+n.from,d.forward(i,t)?1:-1,d.level):V.cursor(c+n.from,l.forward(i,t)?-1:1,l.level)}function lj(n,e,t){for(let r=e;r<t;r++){let i=v1(n.charCodeAt(r));if(1==i)return Ss;if(2==i||4==i)return Wg}return Ss}const M1=Y.define(),S1=Y.define(),x1=Y.define(),E1=Y.define(),Kg=Y.define(),A1=Y.define(),k1=Y.define(),T1=Y.define({combine:n=>n.some(e=>e)}),I1=Y.define({combine:n=>n.some(e=>e)}),O1=Y.define();class Vo{constructor(e,t="nearest",r="nearest",i=5,s=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=i,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Vo(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Vo(V.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Bc=st.define({map:(n,e)=>n.map(e)});function Cr(n,e,t){let r=n.facet(E1);r.length?r[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Hc=Y.define({combine:n=>!n.length||n[0]});let uj=0;const vl=Y.define();class ct{constructor(e,t,r,i,s){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=i,this.extension=s(this)}static define(e,t){const{eventHandlers:r,eventObservers:i,provide:s,decorations:o}=t||{};return new ct(uj++,e,r,i,a=>{let l=[vl.of(a)];return o&&l.push(wl.of(u=>{let c=u.plugin(a);return c?o(c):Z.none})),s&&l.push(s(a)),l})}static fromClass(e,t){return ct.define(r=>new e(r),t)}}class Qg{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(Cr(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(i){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Cr(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null===(t=this.value)||void 0===t?void 0:t.destroy)try{this.value.destroy()}catch(r){Cr(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const N1=Y.define(),jc=Y.define(),wl=Y.define(),P1=Y.define(),Yg=Y.define(),R1=Y.define();function F1(n,e){let t=n.state.facet(R1);if(!t.length)return t;let r=t.map(s=>s instanceof Function?s(n):s),i=[];return St.spans(r,e.from,e.to,{point(){},span(s,o,a,l){let u=s-e.from,c=o-e.from,d=i;for(let g=a.length-1;g>=0;g--,l--){let C,v=a[g].spec.bidiIsolate;if(null==v&&(v=lj(e.text,u,c)),l>0&&d.length&&(C=d[d.length-1]).to==u&&C.direction==v)C.to=c,d=C.inner;else{let D={from:u,to:c,direction:v,inner:[]};d.push(D),d=D.inner}}}}),i}const L1=Y.define();function V1(n){let e=0,t=0,r=0,i=0;for(let s of n.state.facet(L1)){let o=s(n);o&&(null!=o.left&&(e=Math.max(e,o.left)),null!=o.right&&(t=Math.max(t,o.right)),null!=o.top&&(r=Math.max(r,o.top)),null!=o.bottom&&(i=Math.max(i,o.bottom)))}return{left:e,right:t,top:r,bottom:i}}const Cl=Y.define();class Fn{constructor(e,t,r,i){this.fromA=e,this.toA=t,this.fromB=r,this.toB=i}join(e){return new Fn(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(0==t.length)return e;let r=[];for(let i=0,s=0,o=0,a=0;;i++){let l=i==e.length?null:e[i],u=o-a,c=l?l.fromB:1e9;for(;s<t.length&&t[s]<c;){let g=t[s+1],v=Math.max(a,t[s]),C=Math.min(c,g);if(v<=C&&new Fn(v+u,C+u,v,C).addToSet(r),g>c)break;s+=2}if(!l)return r;new Fn(l.fromA,l.toA,l.fromB,l.toB).addToSet(r),o=l.toA,a=l.toB}}}class $c{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Mt.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,a,l)=>i.push(new Fn(s,o,a,l))),this.changedRanges=i}static create(e,t,r){return new $c(e,t,r)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class B1 extends je{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new xt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Fn(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let i=-1;this.view.inputState.composing>=0&&((null===(t=this.domChanged)||void 0===t?void 0:t.newSel)?i=this.domChanged.newSel.head:!function(n,e){let t=!1;return e&&n.iterChangedRanges((r,i)=>{r<e.to&&i>e.from&&(t=!0)}),t}(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?function(n,e,t){let r=j1(n,t);if(!r)return null;let{node:i,from:s,to:o}=r,a=i.nodeValue;if(/[\n\r]/.test(a)||n.state.doc.sliceString(r.from,r.to)!=a)return null;let l=e.invertedDesc,u=new Fn(l.mapPos(s),l.mapPos(o),s,o),c=[];for(let d=i.parentNode;;d=d.parentNode){let g=je.get(d);if(g instanceof gi)c.push({node:d,deco:g.mark});else{if(g instanceof xt||"DIV"==d.nodeName&&d.parentNode==n.contentDOM)return{range:u,text:i,marks:c,line:d};if(d==n.contentDOM)return null;c.push({node:d,deco:new gl({inclusive:!0,attributes:ej(d),tagName:d.tagName.toLowerCase()})})}}}(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;r=new Fn(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Q.ie||Q.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let l=function(n,e,t){let r=new class{constructor(){this.changes=[]}compareRange(e,t){Ug(e,t,this.changes)}comparePoint(e,t){Ug(e,t,this.changes)}};return St.compare(n,e,t,r),r.changes}(this.decorations,this.updateDeco(),e.changes);return r=Fn.extendWithRanges(r,l),!!(7&this.flags||0!=r.length)&&(this.updateInner(r,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,r);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Q.chrome||Q.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof ji&&o.widget instanceof H1&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,t,r){let i=r?r.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=i.length-1;;o--){let a=o>=0?i[o]:null;if(!a)break;let g,v,C,D,{fromA:l,toA:u,fromB:c,toB:d}=a;if(r&&r.range.fromB<d&&r.range.toB>c){let L=yl.build(this.view.state.doc,c,r.range.fromB,this.decorations,this.dynamicDecorationMap),F=yl.build(this.view.state.doc,r.range.toB,d,this.decorations,this.dynamicDecorationMap);v=L.breakAtStart,C=L.openStart,D=F.openEnd;let H=this.compositionView(r);F.breakAtStart?H.breakAfter=1:F.content.length&&H.merge(H.length,H.length,F.content[0],!1,F.openStart,0)&&(H.breakAfter=F.content[0].breakAfter,F.content.shift()),L.content.length&&H.merge(0,0,L.content[L.content.length-1],!0,0,L.openEnd)&&L.content.pop(),g=L.content.concat(H).concat(F.content)}else({content:g,breakAtStart:v,openStart:C,openEnd:D}=yl.build(this.view.state.doc,c,d,this.decorations,this.dynamicDecorationMap));let{i:M,off:x}=s.findPos(u,1),{i:A,off:N}=s.findPos(l,-1);i1(this,A,N,M,x,g,v,C,D)}r&&this.fixCompositionDOM(r)}compositionView(e){let t=new wr(e.text.nodeValue);t.flags|=8;for(let{deco:i}of e.marks)t=new gi(i,[t],t.length);let r=new xt;return r.append(t,0),r}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(l=>7&l.flags)?1:0),this.markedForComposition.add(o);let a=je.get(s);a&&a!=o&&(a.dom=null),o.setDOM(s)},r=this.childPos(e.range.fromB,1),i=this.children[r.i];t(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)r=i.childPos(r.off,1),i=i.children[r.i],t(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,i=r==this.dom,s=!i&&Pc(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(i||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),u=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(Q.gecko&&a.empty&&!this.hasComposition&&1==(n=l).node.nodeType&&n.node.firstChild&&(0==n.offset||"false"==n.node.childNodes[n.offset-1].contentEditable)&&(n.offset==n.node.childNodes.length||"false"==n.node.childNodes[n.offset].contentEditable)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=u=new Yt(d,0),o=!0}var n;let c=this.view.observer.selectionRange;(o||!c.focusNode||(!pl(l.node,l.offset,c.anchorNode,c.anchorOffset)||!pl(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,a))&&(this.view.observer.ignore(()=>{Q.android&&Q.chrome&&this.dom.contains(c.focusNode)&&function(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(1==t.nodeType&&"false"==t.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=Nc(this.view.root);if(d)if(a.empty){if(Q.gecko){let g=function(n,e){return 1!=n.nodeType?0:(e&&"false"==n.childNodes[e-1].contentEditable?1:0)|(e<n.childNodes.length&&"false"==n.childNodes[e].contentEditable?2:0)}(l.node,l.offset);if(g&&3!=g){let v=(1==g?e1:t1)(l.node,l.offset);v&&(l=new Yt(v.node,v.offset))}}d.collapse(l.node,l.offset),null!=a.bidiLevel&&void 0!==d.caretBidiLevel&&(d.caretBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(u.node,u.offset)}catch(g){}}else{let g=document.createRange();a.anchor>a.head&&([l,u]=[u,l]),g.setEnd(u.node,u.offset),g.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(g)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new Yt(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new Yt(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&pl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=Nc(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!(r&&t.empty&&t.assoc&&r.modify))return;let o=xt.find(this,t.head);if(!o)return;let a=o.posAtStart;if(t.head==a||t.head==a+o.length)return;let l=this.coordsAt(t.head,-1),u=this.coordsAt(t.head,1);if(!l||!u||l.bottom>u.top)return;let c=this.domAtPos(t.head+t.assoc);r.collapse(c.node,c.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=t.from&&r.collapse(i,s)}moveToLine(e){let r,t=this.dom;if(e.node!=t)return e;for(let i=e.offset;!r&&i<t.childNodes.length;i++){let s=je.get(t.childNodes[i]);s instanceof xt&&(r=s.domAtPos(0))}for(let i=e.offset-1;!r&&i>=0;i--){let s=je.get(t.childNodes[i]);s instanceof xt&&(r=s.domAtPos(s.length))}return r?new Yt(r.node,r.offset,!0):e}nearest(e){for(let t=e;t;){let r=je.get(t);if(r&&r.rootView==this)return r;t=t.parentNode}return null}posFromDOM(e,t){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(r<i.length||i instanceof xt)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(e,t){let r=null,i=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=s-a.breakAfter,u=l-a.length;if(l<e)break;u<=e&&(u<e||a.covers(-1))&&(l>e||a.covers(1))&&(!r||a instanceof xt&&!(r instanceof xt&&t>=0))&&(r=a,i=u),s=u}return r?r.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:r}=this.childPos(e,1),i=this.children[t];if(!(i instanceof xt))return null;for(;i.children.length;){let{i:a,off:l}=i.childPos(r,1);for(;;a++){if(a==i.children.length)return null;if((i=i.children[a]).length)break}r=l}if(!(i instanceof wr))return null;let s=Pt(i.text,r);if(s==r)return null;let o=_s(i.dom,r,s).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==$e.LTR;for(let u=0,c=0;c<this.children.length;c++){let d=this.children[c],g=u+d.length;if(g>i)break;if(u>=r){let v=d.dom.getBoundingClientRect();if(t.push(v.height),o){let C=d.dom.lastChild,D=C?Po(C):[];if(D.length){let M=D[D.length-1],x=l?M.right-v.left:v.right-M.left;x>a&&(a=x,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=g)}}}u=g+d.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?$e.RTL:$e.LTR}measureTextSize(){for(let s of this.children)if(s instanceof xt){let o=s.measureTextSize();if(o)return o}let t,r,i,e=document.createElement("div");return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Po(e.firstChild)[0];t=e.getBoundingClientRect().height,r=s?s.width/27:7,i=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:r,textHeight:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new r1(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],o=s?s.from-1:this.length;if(o>r){let a=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(Z.replace({widget:new H1(a),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return Z.set(e)}updateDeco(){let e=0,t=this.view.state.facet(wl).map(s=>(this.dynamicDecorationMap[e++]="function"==typeof s)?s(this.view):s),r=!1,i=this.view.state.facet(P1).map((s,o)=>{let a="function"==typeof s;return a&&(r=!0),a?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=r,t.push(St.join(i))),this.decorations=[...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);return this.view.scrollDOM.scrollTop=u.top-e.yMargin,void(this.view.scrollDOM.scrollLeft=e.xMargin)}for(let u of this.view.state.facet(O1))try{if(u(this.view,e.range,e))return!0}catch(c){Cr(this.view.state,c,"scroll handler")}let i,{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1);if(!r)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=V1(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;!function(n,e,t,r,i,s,o,a){let l=n.ownerDocument,u=l.defaultView||window;for(let c=n,d=!1;c&&!d;)if(1==c.nodeType){let g,v=c==l.body,C=1,D=1;if(v)g=GH(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let A=c.getBoundingClientRect();({scaleX:C,scaleY:D}=QM(c,A)),g={left:A.left,right:A.left+c.clientWidth*C,top:A.top,bottom:A.top+c.clientHeight*D}}let M=0,x=0;if("nearest"==i)e.top<g.top?(x=-(g.top-e.top+o),t>0&&e.bottom>g.bottom+x&&(x=e.bottom-g.bottom+x+o)):e.bottom>g.bottom&&(x=e.bottom-g.bottom+o,t<0&&e.top-x<g.top&&(x=-(g.top+x-e.top+o)));else{let A=e.bottom-e.top,N=g.bottom-g.top;x=("center"==i&&A<=N?e.top+A/2-N/2:"start"==i||"center"==i&&t<0?e.top-o:e.bottom-N+o)-g.top}if("nearest"==r?e.left<g.left?(M=-(g.left-e.left+s),t>0&&e.right>g.right+M&&(M=e.right-g.right+M+s)):e.right>g.right&&(M=e.right-g.right+s,t<0&&e.left<g.left+M&&(M=-(g.left+M-e.left+s))):M=("center"==r?e.left+(e.right-e.left)/2-(g.right-g.left)/2:"start"==r==a?e.left-s:e.right-(g.right-g.left)+s)-g.left,M||x)if(v)u.scrollBy(M,x);else{let A=0,N=0;if(x){let L=c.scrollTop;c.scrollTop+=x/D,N=(c.scrollTop-L)*D}if(M){let L=c.scrollLeft;c.scrollLeft+=M/C,A=(c.scrollLeft-L)*C}e={left:e.left-A,top:e.top-N,right:e.right-A,bottom:e.bottom-N},A&&Math.abs(A-M)<1&&(r="nearest"),N&&Math.abs(N-x)<1&&(i="nearest")}if(v)break;c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==$e.LTR)}}class H1 extends Ms{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function j1(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let r=e1(t.focusNode,t.focusOffset),i=t1(t.focusNode,t.focusOffset),s=r||i;if(i&&r&&i.node!=r.node){let a=je.get(i.node);if(!a||a instanceof wr&&a.text!=i.node.nodeValue)s=i;else if(n.docView.lastCompositionAfterCursor){let l=je.get(r.node);!l||l instanceof wr&&l.text!=r.node.nodeValue||(s=i)}}if(n.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function vj(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function wj(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Jg(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function $1(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function U1(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function Zg(n,e,t){let r,i,s,o,l,u,c,d,a=!1;for(let C=n.firstChild;C;C=C.nextSibling){let D=Po(C);for(let M=0;M<D.length;M++){let x=D[M];i&&Jg(i,x)&&(x=$1(U1(x,i.bottom),i.top));let A=vj(e,x),N=wj(t,x);if(0==A&&0==N)return 3==C.nodeType?W1(C,e,t):Zg(C,e,t);if(!r||o>N||o==N&&s>A){r=C,i=x,s=A,o=N;let L=N?t<x.top?-1:1:A?e<x.left?-1:1:0;a=!L||(L>0?M<D.length-1:M>0)}0==A?t>x.bottom&&(!c||c.bottom<x.bottom)?(l=C,c=x):t<x.top&&(!d||d.top>x.top)&&(u=C,d=x):c&&Jg(c,x)?c=U1(c,x.bottom):d&&Jg(d,x)&&(d=$1(d,x.top))}}if(c&&c.bottom>=t?(r=l,i=c):d&&d.top<=t&&(r=u,i=d),!r)return{node:n,offset:0};let g=Math.max(i.left,Math.min(i.right,e));return 3==r.nodeType?W1(r,g,t):a&&"false"!=r.contentEditable?Zg(r,g,t):{node:n,offset:Array.prototype.indexOf.call(n.childNodes,r)+(e>=(i.left+i.right)/2?1:0)}}function W1(n,e,t){let r=n.nodeValue.length,i=-1,s=1e9,o=0;for(let a=0;a<r;a++){let l=_s(n,a,a+1).getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let d=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&d<s){let g=e>=(c.left+c.right)/2,v=g;if((Q.chrome||Q.gecko)&&_s(n,a).getBoundingClientRect().left==c.right&&(v=!g),d<=0)return{node:n,offset:a+(v?1:0)};i=a+(v?1:0),s=d}}}return{node:n,offset:i>-1?i:o>0?n.nodeValue.length:0}}function G1(n,e,t,r=-1){var i,s;let l,o=n.contentDOM.getBoundingClientRect(),a=o.top+n.viewState.paddingTop,{docHeight:u}=n.viewState,{x:c,y:d}=e,g=d-a;if(g<0)return 0;if(g>u)return n.state.doc.length;for(let L=n.viewState.heightOracle.textHeight/2,F=!1;l=n.elementAtHeight(g),l.type!=mn.Text;)for(;g=r>0?l.bottom+L:l.top-L,!(g>=0&&g<=u);){if(F)return t?null:0;F=!0,r=-r}d=a+g;let v=l.from;if(v<n.viewport.from)return 0==n.viewport.from?0:t?null:z1(n,o,l,c,d);if(v>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:z1(n,o,l,c,d);let C=n.dom.ownerDocument,D=n.root.elementFromPoint?n.root:C,M=D.elementFromPoint(c,d);M&&!n.contentDOM.contains(M)&&(M=null),M||(c=Math.max(o.left+1,Math.min(o.right-1,c)),M=D.elementFromPoint(c,d),M&&!n.contentDOM.contains(M)&&(M=null));let x,A=-1;if(M&&0!=(null===(i=n.docView.nearest(M))||void 0===i?void 0:i.isEditable))if(C.caretPositionFromPoint){let L=C.caretPositionFromPoint(c,d);L&&({offsetNode:x,offset:A}=L)}else if(C.caretRangeFromPoint){let L=C.caretRangeFromPoint(c,d);L&&(({startContainer:x,startOffset:A}=L),(!n.contentDOM.contains(x)||Q.safari&&function(n,e,t){let r;if(3!=n.nodeType||e!=(r=n.nodeValue.length))return!1;for(let i=n.nextSibling;i;i=i.nextSibling)if(1!=i.nodeType||"BR"!=i.nodeName)return!1;return _s(n,r-1,r).getBoundingClientRect().left>t}(x,A,c)||Q.chrome&&function(n,e,t){if(0!=e)return!1;for(let i=n;;){let s=i.parentNode;if(!s||1!=s.nodeType||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}return t-(1==n.nodeType?n.getBoundingClientRect():_s(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect()).left>5}(x,A,c))&&(x=void 0))}if(!x||!n.docView.dom.contains(x)){let L=xt.find(n.docView,v);if(!L)return g>l.top+l.height/2?l.to:l.from;({node:x,offset:A}=Zg(L.dom,c,d))}let N=n.docView.nearest(x);if(!N)return null;if(N.isWidget&&1==(null===(s=N.dom)||void 0===s?void 0:s.nodeType)){let L=N.dom.getBoundingClientRect();return e.y<L.top||e.y<=L.bottom&&e.x<=(L.left+L.right)/2?N.posAtStart:N.posAtEnd}return N.localPosFromDOM(x,A)+N.posAtStart}function z1(n,e,t,r,i){let s=Math.round((r-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>1.5*n.defaultLineHeight){let a=n.viewState.heightOracle.textHeight;s+=Math.floor((i-t.top-.5*(n.defaultLineHeight-a))/a)*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+function(n,e,t,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==n.length)break;s+=9==n.charCodeAt(i)?t-s%t:1,i=Pt(n,i)}return n.length}(o,s,n.state.tabSize)}function Xg(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type))for(let r of t.type)if(r.to>e||r.to==e&&(r.to==t.to||r.type==mn.Text))return r;return t}function q1(n,e,t,r){let i=n.state.doc.lineAt(e.head),s=n.bidiSpans(i),o=n.textDirectionAt(i.from);for(let a=e,l=null;;){let u=_1(i,s,o,a,t),c=D1;if(!u){if(i.number==(t?n.state.doc.lines:1))return a;c="\n",i=n.state.doc.line(i.number+(t?1:-1)),s=n.bidiSpans(i),u=n.visualLineSide(i,!t)}if(l){if(!l(c))return a}else{if(!r)return u;l=r(c)}a=u}}function Uc(n,e,t){for(;;){let r=0;for(let i of n)i.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=r||t||(e-s<o-e?-1:1);e=l<0?s:o,r=l}});if(!r)return e}}function em(n,e,t){let r=Uc(n.state.facet(Yg).map(i=>i(n)),t.from,e.head>t.from?-1:1);return r==t.from?t:V.cursor(r,r<t.from?1:-1)}class Sj{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){var n;this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Q.safari&&e.contentDOM.addEventListener("input",()=>null),Q.gecko&&(fS.has(n=e.contentDOM.ownerDocument)||(fS.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{})))}handleEvent(e){!function(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r,t=e.target;t!=n.contentDOM;t=t.parentNode)if(!t||11==t.nodeType||(r=je.get(t))&&r.ignoreEvent(e))return!1;return!0}(this.view,e)||this.ignoreDuringComposition(e)||"keydown"==e.type&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let r=this.handlers[e];if(r){for(let i of r.observers)i(this.view,t);for(let i of r.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=function(n){let e=Object.create(null);function t(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of n){let i=r.spec;if(i&&i.domEventHandlers)for(let s in i.domEventHandlers){let o=i.domEventHandlers[s];o&&t(s).handlers.push(K1(r.value,o))}if(i&&i.domEventObservers)for(let s in i.domEventObservers){let o=i.domEventObservers[s];o&&t(s).observers.push(K1(r.value,o))}}for(let r in br)t(r).handlers.push(br[r]);for(let r in Jn)t(r).observers.push(Jn[r]);return e}(e),r=this.handlers,i=this.view.contentDOM;for(let s in t)if("scroll"!=s){let o=!t[s].handlers.length,a=r[s];a&&o!=!a.handlers.length&&(i.removeEventListener(s,this.handleEvent),a=null),a||i.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)"scroll"!=s&&!t[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=e.keyCode&&Y1.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),Q.android&&Q.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return!Q.ios||e.synthetic||e.altKey||e.metaKey||!((t=Q1.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||Ej.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(229!=e.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0)}flushIOSKey(e){let t=this.pendingIOSKey;return!(!t||"Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,Fo(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(this.composing>0||!!(Q.safari&&!Q.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function K1(n,e){return(t,r)=>{try{return e.call(n,r,t)}catch(i){Cr(t.state,i)}}}const Q1=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ej="dthko",Y1=[16,17,18,20,91,92,224,225];function Gc(n){return.7*Math.max(0,n)+8}class kj{constructor(e,t,r,i){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=function(n){let e=n.ownerDocument;for(let t=n.parentNode;t&&t!=e.body;)if(1==t.nodeType){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else{if(11!=t.nodeType)break;t=t.host}return null}(e.contentDOM),this.atoms=e.state.facet(Yg).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(vr.allowMultipleSelections)&&function(n,e){let t=n.state.facet(M1);return t.length?t[0](e):Q.mac?e.metaKey:e.ctrlKey}(e,t),this.dragging=!(!function(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=Nc(n.root);if(!r||0==r.rangeCount)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}(e,t)||1!=oS(t))&&null}start(e){!1===this.dragging&&this.select(e)}move(e){var t;if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&function(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,i=0,s=(null===(t=this.scrollParent)||void 0===t?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},o=V1(this.view);e.clientX-o.left<=s.left+6?r=-Gc(s.left-e.clientX):e.clientX+o.right>=s.right-6&&(r=Gc(e.clientX-s.right)),e.clientY-o.top<=s.top+6?i=-Gc(s.top-e.clientY):e.clientY+o.bottom>=s.bottom-6&&(i=Gc(e.clientY-s.bottom)),this.setScrollSpeed(r,i)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let r=0;r<e.ranges.length;r++){let i=e.ranges[r],s=null;if(i.empty){let o=Uc(this.atoms,i.from,0);o!=i.from&&(s=V.cursor(o,-1))}else{let o=Uc(this.atoms,i.from,-1),a=Uc(this.atoms,i.to,1);(o!=i.from||a!=i.to)&&(s=V.range(i.from==i.anchor?o:a,i.from==i.head?o:a))}s&&(t||(t=e.ranges.slice()),t[r]=s)}return t?V.create(t,e.mainIndex):e}select(e){let{view:t}=this,r=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,!1===this.dragging))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}const br=Object.create(null),Jn=Object.create(null),J1=Q.ie&&Q.ie_version<15||Q.ios&&Q.webkit_version<604;function Z1(n,e){let r,{state:t}=n,i=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(null!=tm&&t.selection.ranges.every(l=>l.empty)&&tm==s.toString()){let l=-1;r=t.changeByRange(u=>{let c=t.doc.lineAt(u.from);if(c.from==l)return{range:u};l=c.from;let d=t.toText((o?s.line(i++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:d},range:V.cursor(u.from+d.length)}})}else r=o?t.changeByRange(l=>{let u=s.line(i++);return{changes:{from:l.from,to:l.to,insert:u.text},range:V.cursor(l.from+u.length)}}):t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}function X1(n,e,t,r){if(1==r)return V.cursor(e,t);if(2==r)return function(n,e,t=1){let r=n.charCategorizer(e),i=n.doc.lineAt(e),s=e-i.from;if(0==i.length)return V.cursor(e);0==s?t=1:s==i.length&&(t=-1);let o=s,a=s;t<0?o=Pt(i.text,s,!1):a=Pt(i.text,s);let l=r(i.text.slice(o,a));for(;o>0;){let u=Pt(i.text,o,!1);if(r(i.text.slice(u,o))!=l)break;o=u}for(;a<i.length;){let u=Pt(i.text,a);if(r(i.text.slice(a,u))!=l)break;a=u}return V.range(o+i.from,a+i.from)}(n.state,e,t);{let i=xt.find(n.docView,e),s=n.state.doc.lineAt(i?i.posAtEnd:e),a=i?i.posAtEnd:s.to;return a<n.state.doc.length&&a==s.to&&a++,V.range(i?i.posAtStart:s.from,a)}}Jn.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft},br.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),27==e.keyCode&&(n.inputState.lastEscPress=Date.now()),!1),Jn.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")},Jn.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")},br.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let r of n.state.facet(x1))if(t=r(n,e),t)break;if(!t&&0==e.button&&(t=function(n,e){let t=nS(n,e),r=oS(e),i=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),i=i.map(s.changes))},get(s,o,a){let u,l=nS(n,s),c=X1(n,l.pos,l.bias,r);if(t.pos!=l.pos&&!o){let d=X1(n,t.pos,t.bias,r),g=Math.min(d.from,c.from),v=Math.max(d.to,c.to);c=g<c.from?V.range(g,v):V.range(v,g)}return o?i.replaceRange(i.main.extend(c.from,c.to)):a&&1==r&&i.ranges.length>1&&(u=function(n,e){for(let t=0;t<n.ranges.length;t++){let{from:r,to:i}=n.ranges[t];if(r<=e&&i>=e)return V.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}(i,l.pos))?u:a?i.addRange(c):V.create([c])}}}(n,e)),t){let r=!n.hasFocus;n.inputState.startMouseSelection(new kj(n,e,t,r)),r&&n.observer.ignore(()=>YM(n.contentDOM));let i=n.inputState.mouseSelection;if(i)return i.start(e),!1===i.dragging}return!1};let eS=(n,e)=>n>=e.top&&n<=e.bottom,tS=(n,e,t)=>eS(e,t)&&n>=t.left&&n<=t.right;function Rj(n,e,t,r){let i=xt.find(n.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(0==s)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&tS(t,r,o))return-1;let a=i.coordsAt(s,1);return a&&tS(t,r,a)?1:o&&eS(r,o)?-1:1}function nS(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Rj(n,t,e.clientX,e.clientY)}}const Fj=Q.ie&&Q.ie_version<=11;let rS=null,iS=0,sS=0;function oS(n){if(!Fj)return n.detail;let e=rS,t=sS;return rS=n,sS=Date.now(),iS=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(iS+1)%3:1}function aS(n,e,t,r){if(!t)return;let i=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=r&&s&&function(n,e){let t=n.state.facet(S1);return t.length?t[0](e):Q.mac?!e.altKey:!e.ctrlKey}(n,e)?{from:s.from,to:s.to}:null,a={from:i,insert:t},l=n.state.changes(o?[o,a]:a);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}br.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let i=n.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,o=s+i.length;(s>=t.to||o<=t.from)&&(t=V.range(s,o))}}let{inputState:r}=n;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove"),!1},br.dragend=n=>(n.inputState.draggedContent=null,!1),br.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let r=Array(t.length),i=0,s=()=>{++i==t.length&&aS(n,e,r.filter(o=>null!=o).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(r[o]=a.result),s()},a.readAsText(t[o])}return!0}{let r=e.dataTransfer.getData("Text");if(r)return aS(n,e,r,!0),!0}return!1},br.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=J1?null:e.clipboardData;return t?(Z1(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(function(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),Z1(n,t.value)},50)}(n),!1)};let tm=null;br.copy=br.cut=(n,e)=>{let{text:t,ranges:r,linewise:i}=function(n){let e=[],t=[],r=!1;for(let i of n.selection.ranges)i.empty||(e.push(n.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>i&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),i=o.number}r=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:r}}(n.state);if(!t&&!i)return!1;tm=i?t:null,"cut"==e.type&&!n.state.readOnly&&n.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let s=J1?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(function(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}(n,t),!1)};const lS=Fi.define();function uS(n,e){let t=[];for(let r of n.facet(k1)){let i=r(n,e);i&&t.push(i)}return t?n.update({effects:t,annotations:lS.of(!0)}):null}function cS(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=uS(n.state,e);t?n.dispatch(t):n.update([])}},10)}Jn.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),cS(n)},Jn.blur=n=>{n.observer.clearSelectionRange(),cS(n)},Jn.compositionstart=Jn.compositionupdate=n=>{null==n.inputState.compositionFirstChange&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0)},Jn.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Q.chrome&&Q.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50)},Jn.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()},br.beforeinput=(n,e)=>{var t;let r;if(Q.chrome&&Q.android&&(r=Q1.find(i=>i.inputType==e.inputType))&&(n.observer.delayAndroidKey(r.key,r.keyCode),"Backspace"==r.key||"Delete"==r.key)){let i=(null===(t=window.visualViewport)||void 0===t?void 0:t.height)||0;setTimeout(()=>{var s;((null===(s=window.visualViewport)||void 0===s?void 0:s.height)||0)>i+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Q.ios&&"deleteContentForward"==e.inputType&&n.observer.flushSoon(),Q.safari&&"insertText"==e.inputType&&n.inputState.composing>=0&&setTimeout(()=>Jn.compositionend(n,e),20),!1};const fS=new Set,hS=["pre-wrap","normal","pre-line","break-spaces"];class dS{constructor(e){this.lineWrapping=e,this.doc=Oe.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return hS.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(10*i)]||(t=!0,this.heightSamples[Math.floor(10*i)]=!0)}return t}refresh(e,t,r,i,s,o){let a=hS.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=t,this.charWidth=r,this.textHeight=i,this.lineLength=s,l){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(10*c)]=!0}}return l}}class pS{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Ur{constructor(e,t,r,i,s){this.from=e,this.length=t,this.top=r,this.height=i,this._content=s}get type(){return"number"==typeof this._content?mn.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof $i?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Ur(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Qe=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(Qe||(Qe={}));const zc=.001;class Jt{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>zc&&(e.heightChanged=!0),this.height=t)}replace(e,t,r){return Jt.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,i){let s=this,o=r.doc;for(let a=i.length-1;a>=0;a--){let{fromA:l,toA:u,fromB:c,toB:d}=i[a],g=s.lineAt(l,Qe.ByPosNoHeight,r.setDoc(t),0,0),v=g.to>=u?g:s.lineAt(u,Qe.ByPosNoHeight,r,0,0);for(d+=v.to-u,u=v.to;a>0&&g.from<=i[a-1].toA;)l=i[a-1].fromA,c=i[a-1].fromB,a--,l<g.from&&(g=s.lineAt(l,Qe.ByPosNoHeight,r,0,0));c+=g.from-l,l=g.from;let C=nm.build(r.setDoc(o),e,c,d);s=s.replace(l,u,C)}return s.updateHeight(r,0)}static empty(){return new Ln(0,0)}static of(e){if(1==e.length)return e[0];let t=0,r=e.length,i=0,s=0;for(;;)if(t==r)if(i>2*s){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),r+=1+a.break,i-=a.size}else{if(!(s>2*i))break;{let a=e[r];a.break?e.splice(r,1,a.left,null,a.right):e.splice(r,1,a.left,a.right),r+=2+a.break,s-=a.size}}else if(i<s){let a=e[t++];a&&(i+=a.size)}else{let a=e[--r];a&&(s+=a.size)}let o=0;return null==e[t-1]?(o=1,t--):null==e[t]&&(o=1,r++),new $j(Jt.of(e.slice(0,t)),o,Jt.of(e.slice(r)))}}Jt.prototype.size=1;class gS extends Jt{constructor(e,t,r){super(e,t),this.deco=r}blockAt(e,t,r,i){return new Ur(i,this.length,r,this.height,this.deco||0)}lineAt(e,t,r,i,s){return this.blockAt(0,r,i,s)}forEachLine(e,t,r,i,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,r,i,s))}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(e,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ln extends gS{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,r,i){return new Ur(i,this.length,r,this.height,this.breaks)}replace(e,t,r){let i=r[0];return 1==r.length&&(i instanceof Ln||i instanceof Ft&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof Ft?i=new Ln(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):Jt.of(r)}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more?this.setHeight(e,i.heights[i.index++]):(r||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ft extends Jt{constructor(e){super(e,0)}heightMetrics(e,t){let o,r=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,s=i-r+1,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:i,perLine:o,perChar:a}}blockAt(e,t,r,i){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(t,i);if(t.lineWrapping){let u=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),c=t.doc.lineAt(u),d=a+c.length*l,g=Math.max(r,e-d/2);return new Ur(c.from,c.length,g,d,0)}{let u=Math.max(0,Math.min(o-s,Math.floor((e-r)/a))),{from:c,length:d}=t.doc.line(s+u);return new Ur(c,d,r+a*u,a,0)}}lineAt(e,t,r,i,s){if(t==Qe.ByHeight)return this.blockAt(e,r,i,s);if(t==Qe.ByPosNoHeight){let{from:v,to:C}=r.doc.lineAt(e);return new Ur(v,C-v,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(r,s),u=r.doc.lineAt(e),c=a+u.length*l,d=u.number-o;return new Ur(u.from,u.length,Math.max(i,Math.min(i+a*d+l*(u.from-s-d),i+this.height-c)),c,0)}forEachLine(e,t,r,i,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:a,perLine:l,perChar:u}=this.heightMetrics(r,s);for(let c=e,d=i;c<=t;){let g=r.doc.lineAt(c);if(c==e){let C=g.number-a;d+=l*C+u*(e-s-C)}let v=l+u*g.length;o(new Ur(g.from,g.length,d,v,0)),d+=v,c=g.to+1}}replace(e,t,r){let i=this.length-t;if(i>0){let s=r[r.length-1];s instanceof Ft?r[r.length-1]=new Ft(s.length+i):r.push(null,new Ft(i-1))}if(e>0){let s=r[0];s instanceof Ft?r[0]=new Ft(e+s.length):r.unshift(new Ft(e-1),null)}return Jt.of(r)}decomposeLeft(e,t){t.push(new Ft(e-1),null)}decomposeRight(e,t){t.push(null,new Ft(this.length-e-1))}updateHeight(e,t=0,r=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let o=[],a=Math.max(t,i.from),l=-1;for(i.from>t&&o.push(new Ft(i.from-t-1).updateHeight(e,t));a<=s&&i.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let d=i.heights[i.index++];-1==l?l=d:Math.abs(d-l)>=zc&&(l=-2);let g=new Ln(c,d);g.outdated=!1,o.push(g),a+=c+1}a<=s&&o.push(null,new Ft(s-a).updateHeight(e,a));let u=Jt.of(o);return(l<0||Math.abs(u.height-this.height)>=zc||Math.abs(l-this.heightMetrics(e,t).perLine)>=zc)&&(e.heightChanged=!0),u}return(r||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class $j extends Jt{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return 1&this.flags}blockAt(e,t,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,r,i,s){let o=i+this.left.height,a=s+this.left.length+this.break,l=t==Qe.ByHeight?e<o:e<a,u=l?this.left.lineAt(e,t,r,i,s):this.right.lineAt(e,t,r,o,a);if(this.break||(l?u.to<a:u.from>a))return u;let c=t==Qe.ByPosNoHeight?Qe.ByPosNoHeight:Qe.ByPos;return l?u.join(this.right.lineAt(a,c,r,o,a)):this.left.lineAt(a,c,r,i,s).join(u)}forEachLine(e,t,r,i,s,o){let a=i+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,r,i,s,o),t>=l&&this.right.forEachLine(e,t,r,a,l,o);else{let u=this.lineAt(l,Qe.ByPos,r,i,s);e<u.from&&this.left.forEachLine(e,u.from-1,r,i,s,o),u.to>=e&&u.from<=t&&o(u),t>u.to&&this.right.forEachLine(u.to+1,t,r,a,l,o)}}replace(e,t,r){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of r)s.push(a);if(e>0&&mS(s,o-1),t<this.length){let a=s.length;this.decomposeRight(t,s),mS(s,a)}return Jt.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Jt.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,i){let{left:s,right:o}=this,a=t+s.length+this.break,l=null;return i&&i.from<=t+s.length&&i.more?l=s=s.updateHeight(e,t,r,i):s.updateHeight(e,t,r),i&&i.from<=a+o.length&&i.more?l=o=o.updateHeight(e,a,r,i):o.updateHeight(e,a,r),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mS(n,e){let t,r;null==n[e]&&(t=n[e-1])instanceof Ft&&(r=n[e+1])instanceof Ft&&n.splice(e-1,3,new Ft(t.length+1+r.length))}class nm{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Ln?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new Ln(r-this.pos,-1)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new gS(o,i,r)):(o||s||i>=5)&&this.addLineDeco(i,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ln(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let r=new Ft(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ln)return e;let t=new Ln(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let i=this.ensureLine();i.length+=r,i.collapsed+=r,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof Ln||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Ln(0,-1));let r=e;for(let i of this.nodes)i instanceof Ln&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,t,r,i){let s=new nm(r,e);return St.spans(t,r,i,s,0),s.finish(r)}}class Gj{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,i){(e<t||r&&r.heightRelevant||i&&i.heightRelevant)&&Ug(e,t,this.changes,5)}}function zj(n,e){let t=n.getBoundingClientRect(),r=n.ownerDocument,i=r.defaultView||window,s=Math.max(0,t.left),o=Math.min(i.innerWidth,t.right),a=Math.max(0,t.top),l=Math.min(i.innerHeight,t.bottom);for(let u=n.parentNode;u&&u!=r.body;)if(1==u.nodeType){let c=u,d=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&"visible"!=d.overflow){let g=c.getBoundingClientRect();s=Math.max(s,g.left),o=Math.min(o,g.right),a=Math.max(a,g.top),l=u==n.parentNode?g.bottom:Math.min(l,g.bottom)}u="absolute"==d.position||"fixed"==d.position?c.offsetParent:c.parentNode}else{if(11!=u.nodeType)break;u=u.host}return{left:s-t.left,right:Math.max(s,o)-t.left,top:a-(t.top+e),bottom:Math.max(a,l)-(t.top+e)}}function qj(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class rm{constructor(e,t,r){this.from=e,this.to=t,this.size=r}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,t){return Z.replace({widget:new Kj(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Kj extends Ms{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class yS{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=vS,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=$e.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(jc).some(r=>"function"!=typeof r&&"cm-lineWrapping"==r.class);this.heightOracle=new dS(t),this.stateDeco=e.facet(wl).filter(r=>"function"!=typeof r),this.heightMap=Jt.empty().applyChanges(this.stateDeco,Oe.empty,this.heightOracle.setDoc(e.doc),[new Fn(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Z.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let i=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new qc(s,o))}}this.viewports=e.sort((r,i)=>r.from-i.from),this.scaler=this.heightMap.height<=7e6?vS:new Jj(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(1==this.scaler.scale?e:bl(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(wl).filter(c=>"function"!=typeof c);let s=Fn.extendWithRanges(e.changedRanges,function(n,e,t){let r=new Gj;return St.compare(n,e,t,r,0),r.changes}(r,this.stateDeco,e?e.changes:Mt.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let u=!e.changes.empty||2&e.flags||l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,this.updateForViewport(),u&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(I1)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection="rtl"==r.direction?$e.RTL:$e.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=t.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let u=0,c=0;if(a.width&&a.height){let{scaleX:L,scaleY:F}=QM(t,a);(L>.005&&Math.abs(this.scaleX-L)>.005||F>.005&&Math.abs(this.scaleY-F)>.005)&&(this.scaleX=L,this.scaleY=F,u|=8,o=l=!0)}let d=(parseInt(r.paddingTop)||0)*this.scaleY,g=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=d||this.paddingBottom!=g)&&(this.paddingTop=d,this.paddingBottom=g,u|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=8);let v=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=v&&(this.scrollAnchorHeight=-1,this.scrollTop=v),this.scrolledToBottom=XM(e.scrollDOM);let C=(this.printing?qj:zj)(t,this.paddingTop),D=C.top-this.pixelViewport.top,M=C.bottom-this.pixelViewport.bottom;this.pixelViewport=C;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let A=a.width;if((this.contentDOMWidth!=A||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,u|=8),l){let L=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(L)&&(o=!0),o||i.lineWrapping&&Math.abs(A-this.contentDOMWidth)>i.charWidth){let{lineHeight:F,charWidth:H,textHeight:U}=e.docView.measureTextSize();o=F>0&&i.refresh(s,F,H,U,A/H,L),o&&(e.docView.minWidth=0,u|=8)}D>0&&M>0?c=Math.max(D,M):D<0&&M<0&&(c=Math.min(D,M)),i.heightChanged=!1;for(let F of this.viewports){let H=F.from==this.viewport.from?L:e.docView.measureVisibleLineHeights(F);this.heightMap=(o?Jt.empty().applyChanges(this.stateDeco,Oe.empty,this.heightOracle,[new Fn(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new pS(F.from,H))}i.heightChanged&&(u|=2)}let N=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return N&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(2&u||N)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new qc(i.lineAt(o-1e3*r,Qe.ByHeight,s,0,0).from,i.lineAt(a+1e3*(1-r),Qe.ByHeight,s,0,0).to);if(t){let{head:u}=t.range;if(u<l.from||u>l.to){let g,c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=i.lineAt(u,Qe.ByPos,s,0,0);g="center"==t.y?(d.top+d.bottom)/2-c/2:"start"==t.y||"nearest"==t.y&&u<l.from?d.top:d.bottom-c,l=new qc(i.lineAt(g-500,Qe.ByHeight,s,0,0).from,i.lineAt(g+c+500,Qe.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let r=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new qc(this.heightMap.lineAt(r,Qe.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,Qe.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,Qe.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,Qe.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(0==e||i<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=a+Math.max(10,Math.min(r,250)))&&i>o-2e3&&s<a+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let i of e)t.touchesRange(i.from,i.to)||r.push(new rm(t.mapPos(i.from),t.mapPos(i.to),i.size));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,i=r?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=$e.LTR&&!r)return[];let a=[],l=(u,c,d,g)=>{if(c-u<s)return;let v=this.state.selection.main,C=[v.from];v.empty||C.push(v.to);for(let M of C)if(M>u&&M<c)return l(u,M-10,d,g),void l(M+10,c,d,g);let D=function(n,e){for(let t of n)if(e(t))return t}(e,M=>M.from>=d.from&&M.to<=d.to&&Math.abs(M.from-u)<s&&Math.abs(M.to-c)<s&&!C.some(x=>M.from<x&&M.to>x));if(!D){if(c<d.to&&t&&r&&t.visibleRanges.some(M=>M.from<=c&&M.to>=c)){let M=t.moveToLineBoundary(V.cursor(c),!1,!0).head;M>u&&(c=M)}D=new rm(u,c,this.gapSize(d,u,c,g))}a.push(D)};for(let u of this.viewportLines){if(u.length<o)continue;let c=Qj(u.from,u.to,this.stateDeco);if(c.total<o)continue;let g,v,d=this.scrollTarget?this.scrollTarget.range.head:null;if(r){let D,M,C=i/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=d){let x=Qc(c,d),A=((this.visibleBottom-this.visibleTop)/2+C)/u.height;D=x-A,M=x+A}else D=(this.visibleTop-u.top-C)/u.height,M=(this.visibleBottom-u.top+C)/u.height;g=Kc(c,D),v=Kc(c,M)}else{let M,x,C=c.total*this.heightOracle.charWidth,D=i*this.heightOracle.charWidth;if(null!=d){let A=Qc(c,d),N=((this.pixelViewport.right-this.pixelViewport.left)/2+D)/C;M=A-N,x=A+N}else M=(this.pixelViewport.left-D)/C,x=(this.pixelViewport.right+D)/C;g=Kc(c,M),v=Kc(c,x)}g>u.from&&l(u.from,g,u,c),v<u.to&&l(v,u.to,u,c)}return a}gapSize(e,t,r,i){let s=Qc(i,r)-Qc(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){rm.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Z.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];St.spans(e,this.viewport.from,this.viewport.to,{span(i,s){t.push({from:i,to:s})},point(){}},20);let r=t.length!=this.visibleRanges.length||this.visibleRanges.some((i,s)=>i.from!=t[s].from||i.to!=t[s].to);return this.visibleRanges=t,r?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||bl(this.heightMap.lineAt(e,Qe.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return bl(this.heightMap.lineAt(this.scaler.fromDOM(e),Qe.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return bl(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class qc{constructor(e,t){this.from=e,this.to=t}}function Qj(n,e,t){let r=[],i=n,s=0;return St.spans(t,n,e,{span(){},point(o,a){o>i&&(r.push({from:i,to:o}),s+=o-i),i=a}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function Kc({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let i=0;;i++){let{from:s,to:o}=e[i],a=o-s;if(r<=a)return s+r;r-=a}}function Qc(n,e){let t=0;for(let{from:r,to:i}of n.ranges){if(e<=i){t+=e-r;break}t+=i-r}return t/n.total}const vS={toDOM:n=>n,fromDOM:n=>n,scale:1};class Jj{constructor(e,t,r){let i=0,s=0,o=0;this.viewports=r.map(({from:a,to:l})=>{let u=t.lineAt(a,Qe.ByPos,e,0,0).top,c=t.lineAt(l,Qe.ByPos,e,0,0).bottom;return i+=c-u,{from:a,to:l,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}}function bl(n,e){if(1==e.scale)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new Ur(n.from,n.length,t,r-t,Array.isArray(n._content)?n._content.map(i=>bl(i,e)):n._content)}const Yc=Y.define({combine:n=>n.join(" ")}),im=Y.define({combine:n=>n.indexOf(!0)>-1}),sm=Vi.newName(),wS=Vi.newName(),CS=Vi.newName(),bS={"&light":"."+wS,"&dark":"."+CS};function om(n,e,t){return new Vi(e,{finish:r=>/&/.test(r)?r.replace(/&\w*/,i=>{if("&"==i)return n;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):n+" "+r})}const Zj=om("."+sm,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},bS);class Xj{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(vr.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+="\uffff"}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i);let s=this.text.length;this.readNode(i);let o=i.nextSibling;if(o==t)break;let a=je.get(i),l=je.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:Rc(i))||Rc(o)&&("BR"!=i.nodeName||i.cmIgnore)&&this.text.length>s)&&this.lineBreak(),i=o}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let a,s=-1,o=1;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(a=i.exec(t))&&(s=a.index,o=a[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);r=s+o}}readNode(e){if(e.cmIgnore)return;let t=je.get(e),r=t&&t.overrideDOMText;if(null!=r){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(3==e.nodeType?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(e8(e,r.node,r.offset)?t:0))}}function e8(n,e,t){for(;;){if(!e||t<pi(e))return!1;if(e==n)return!0;t=Ds(e)+1,e=e.parentNode}}class DS{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class t8{constructor(e,t,r,i){this.typeOver=i,this.bounds=null,this.text="";let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,r,0))){let a=s||o?[]:function(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new DS(t,r)),(i!=t||s!=r)&&e.push(new DS(i,s))),e}(e),l=new Xj(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=function(n,e){if(0==n.length)return null;let t=n[0].pos,r=2==n.length?n[1].pos:t;return t>-1&&r>-1?V.single(t+e,r+e):null}(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!Pg(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),u=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Pg(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),c=e.viewport;if((Q.ios||Q.chrome)&&e.state.selection.main.empty&&l!=u&&(c.from>0||c.to<e.state.doc.length)){let d=Math.min(l,u),g=Math.max(l,u),v=c.from-d,C=c.to-g;(0==v||1==v||0==d)&&(0==C||-1==C||g==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=V.single(u,l)}}}function _S(n,e){let t,{newSel:r}=e,i=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=i.from,u=null;(8===s||Q.android&&e.text.length<a-o)&&(l=i.to,u="end");let c=function(n,e,t,r){let i=Math.min(n.length,e.length),s=0;for(;s<i&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&n.length==e.length)return null;let o=n.length,a=e.length;for(;o>0&&a>0&&n.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;return"end"==r&&(t-=o+Math.max(0,s-Math.min(o,a))-s),o<s&&n.length<e.length?(s-=t<=s&&t>=o?s-t:0,a=s+(a-o),o=s):a<s&&(s-=t<=s&&t>=a?s-t:0,o=s+(o-a),a=s),{from:s,toA:o,toB:a}}(n.state.doc.sliceString(o,a,"\uffff"),e.text,l-o,u);c&&(Q.chrome&&13==s&&c.toB==c.from+2&&"\uffff\uffff"==e.text.slice(c.from,c.toB)&&c.toB--,t={from:o+c.from,to:o+c.toA,insert:Oe.of(e.text.slice(c.from,c.toB).split("\uffff"))})}else r&&(!n.hasFocus&&n.state.facet(Hc)||r.main.eq(i))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!i.empty&&r&&r.main.empty?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,i.to)}:t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,i.to))}:(Q.mac||Q.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&"off"==n.contentDOM.getAttribute("autocorrect")?(r&&2==t.insert.length&&(r=V.single(r.main.anchor-1,r.main.head-1)),t={from:i.from,to:i.to,insert:Oe.of([" "])}):Q.chrome&&t&&t.from==t.to&&t.from==i.head&&"\n "==t.insert.toString()&&n.lineWrapping&&(r&&(r=V.single(r.main.anchor-1,r.main.head-1)),t={from:i.from,to:i.to,insert:Oe.of([" "])}),t){if(Q.ios&&n.inputState.flushIOSKey(t)||Q.android&&(t.to==i.to&&(t.from==i.from||t.from==i.from-1&&" "==n.state.sliceDoc(t.from,i.from))&&1==t.insert.length&&2==t.insert.lines&&Fo(n.contentDOM,"Enter",13)||(t.from==i.from-1&&t.to==i.to&&0==t.insert.length||8==s&&t.insert.length<t.to-t.from&&t.to>i.head)&&Fo(n.contentDOM,"Backspace",8)||t.from==i.from&&t.to==i.to+1&&0==t.insert.length&&Fo(n.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let a,l=()=>a||(a=function(n,e,t){let r,i=n.state,s=i.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let a=s.from<e.from?i.sliceDoc(s.from,e.from):"",l=s.to>e.to?i.sliceDoc(e.to,s.to):"";r=i.replaceSelection(n.state.toText(a+e.insert.sliceString(0,void 0,n.state.lineBreak)+l))}else{let a=i.changes(e),l=t&&t.main.to<=a.newLength?t.main:void 0;if(i.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c,u=n.state.sliceDoc(e.from,e.to),d=t&&j1(n,t.main.head);c=d?{from:d.from,to:d.to-(e.insert.length-(e.to-e.from))}:n.state.doc.lineAt(s.head);let g=s.to-e.to,v=s.to-s.from;r=i.changeByRange(C=>{if(C.from==s.from&&C.to==s.to)return{changes:a,range:l||C.map(a)};let D=C.to-g,M=D-u.length;if(C.to-C.from!=v||n.state.sliceDoc(M,D)!=u||C.to>=c.from&&C.from<=c.to)return{range:C};let x=i.changes({from:M,to:D,insert:e.insert}),A=C.to-s.to;return{changes:x,range:l?V.range(Math.max(0,l.anchor+A),Math.max(0,l.head+A)):C.map(x)}})}else r={changes:a,selection:l&&i.selection.replaceRange(l)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),i.update(r,{userEvent:o,scrollIntoView:!0})}(n,t,r));return n.state.facet(A1).some(u=>u(n,t.from,t.to,o,l))||n.dispatch(l()),!0}if(r&&!r.main.eq(i)){let o=!1,a="select";return n.inputState.lastSelectionTime>Date.now()-50&&("select"==n.inputState.lastSelectionOrigin&&(o=!0),a=n.inputState.lastSelectionOrigin),n.dispatch({selection:r,scrollIntoView:o,userEvent:a}),!0}return!1}const o8={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},am=Q.ie&&Q.ie_version<=11;class a8{constructor(e){this.view=e,this.active=!1,this.selectionRange=new KH,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(Q.ie&&Q.ie_version<=11||Q.ios&&e.composing)&&t.some(r=>"childList"==r.type&&r.removedNodes.length||"characterData"==r.type&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),am&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){"change"==e.type&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(Hc)?r.root.activeElement!=this.dom:!Pc(r.dom,i))return;let s=i.anchorNode&&r.docView.nearest(i.anchorNode);s&&s.ignoreEvent(e)?t||(this.selectionChanged=!1):(Q.ie&&Q.ie_version<=11||Q.android&&Q.chrome)&&!r.state.selection.main.empty&&i.focusNode&&pl(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Nc(e.root);if(!t)return!1;let r=Q.safari&&11==e.root.nodeType&&function(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom&&function(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return SS(n,i)}let t=null;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),t?SS(n,t):null}(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let i=Pc(this.dom,r);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&function(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,pi(t));;)if(r){if(1!=t.nodeType)return!1;let i=t.childNodes[r-1];"false"==i.contentEditable?r--:(t=i,r=pi(t))}else{if(t==n)return!0;r=Ds(t),t=t.parentNode}}(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(1==r.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else{if(11!=r.nodeType)break;r=r.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,o8),am&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),am&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;this.delayedAndroidKey||(this.flushingAndroidKey=this.view.win.requestAnimationFrame(()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Fo(this.dom,s.key,s.keyCode))})),(!this.delayedAndroidKey||"Enter"==e)&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(null===(r=this.delayedAndroidKey)||void 0===r?void 0:r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);!o||(o.typeOver&&(i=!0),-1==t?({from:t,to:r}=o):(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:i}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),i=this.selectionChanged&&Pc(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new t8(this.view,e,t,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,i=_S(this.view,t);return this.view.state==r&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.flags|=4),"childList"==e.type){let r=MS(t,e.previousSibling||e.target.previousSibling,-1),i=MS(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener("change",this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener("change",this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,r;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(r=this.resizeScroll)||void 0===r||r.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function MS(n,e,t){for(;e;){let r=je.get(e);if(r&&r.parent==n)return r;let i=e.parentNode;e=i!=n.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function SS(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return pl(o.node,o.offset,i,s)&&([t,r,i,s]=[i,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}}let he=(()=>{class n{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:r}=t;this.dispatchTransactions=t.dispatchTransactions||r&&(i=>i.forEach(s=>r(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(n){for(;n;){if(n&&(9==n.nodeType||11==n.nodeType&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}(t.parent)||document,this.viewState=new yS(t.state||vr.create(t)),t.scrollTo&&t.scrollTo.is(Bc)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(vl).map(i=>new Qg(i));for(let i of this.plugins)i.update(this);this.observer=new a8(this),this.inputState=new Sj(this),this.inputState.ensureHandlers(this.plugins),this.docView=new B1(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...t){let r=1==t.length&&t[0]instanceof jr?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(r,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let s,r=!1,i=!1,o=this.state;for(let v of t){if(v.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=v.state}if(this.destroyed)return void(this.viewState.state=o);let a=this.hasFocus,l=0,u=null;t.some(v=>v.annotation(lS))?(this.inputState.notifiedFocused=a,l=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,u=uS(o,a),u||(l=1));let c=this.observer.delayedAndroidKey,d=null;if(c?(this.observer.clearDelayedAndroidKey(),d=this.observer.readChange(),(d&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(d=null)):this.observer.clear(),o.facet(vr.phrases)!=this.state.facet(vr.phrases))return this.setState(o);s=$c.create(this,o,t),s.flags|=l;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let v of t){if(g&&(g=g.map(v.changes)),v.scrollIntoView){let{main:C}=v.state.selection;g=new Vo(C.empty?C:V.cursor(C.head,C.head>C.anchor?-1:1))}for(let C of v.effects)C.is(Bc)&&(g=C.value.clip(this.state))}this.viewState.update(s,g),this.bidiCache=Jc.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),r=this.docView.update(s),this.state.facet(Cl)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(r,t.some(v=>v.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Yc)!=s.state.facet(Yc)&&(this.viewState.mustMeasureContent=!0),(r||i||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),r&&this.docViewUpdate(),!s.empty)for(let v of this.state.facet(Kg))try{v(s)}catch(C){Cr(this.state,C,"update listener")}(u||d)&&Promise.resolve().then(()=>{u&&this.state==u.startState&&this.dispatch(u),d&&!_S(this,d)&&c.force&&Fo(this.contentDOM,c.key,c.keyCode)})}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let r=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new yS(t),this.plugins=t.facet(vl).map(i=>new Qg(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new B1(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(t){let r=t.startState.facet(vl),i=t.state.facet(vl);if(r!=i){let s=[];for(let o of i){let a=r.indexOf(o);if(a<0)s.push(new Qg(o));else{let l=this.plugins[a];l.mustUpdate=t,s.push(l)}}for(let o of this.plugins)o.mustUpdate!=t&&o.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=t;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);r!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let r=t.value;if(r&&r.docViewUpdate)try{r.docViewUpdate(this)}catch(i){Cr(this.state,i,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let r=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:a}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(a<0)if(XM(i))o=-1,a=this.viewState.heightMap.height;else{let C=this.viewState.scrollAnchorAt(s);o=C.from,a=C.top}this.updateState=1;let u=this.viewState.measure(this);if(!u&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];4&u||([this.measureRequests,c]=[c,this.measureRequests]);let d=c.map(C=>{try{return C.read(this)}catch(D){return Cr(this.state,D),xS}}),g=$c.create(this,this.state,[]),v=!1;g.flags|=u,r?r.flags|=u:r=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),v=this.docView.update(g),v&&this.docViewUpdate());for(let C=0;C<c.length;C++)if(d[C]!=xS)try{let D=c[C];D.write&&D.write(d[C],this)}catch(D){Cr(this.state,D)}if(v&&this.docView.updateSelection(!0),!g.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}{let D=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-a;if(D>1||D<-1){s+=D,i.scrollTop=s/this.scaleY,a=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let l of this.state.facet(Kg))l(r)}get themeClasses(){return sm+" "+(this.state.facet(im)?CS:wS)+" "+this.state.facet(Yc)}updateAttrs(){let t=ES(this,N1,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Hc)?"true":"false",class:"cm-content",style:`${Q.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),ES(this,jc,r);let i=this.observer.ignore(()=>{let s=$g(this.contentDOM,this.contentAttrs,r),o=$g(this.dom,this.editorAttrs,t);return s||o});return this.editorAttrs=t,this.contentAttrs=r,i}showAnnouncements(t){let r=!0;for(let i of t)for(let s of i.effects)s.is(n.announce)&&(r&&(this.announceDOM.textContent=""),r=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=s.value)}mountStyles(){this.styleModules=this.state.facet(Cl);let t=this.state.facet(n.cspNonce);Vi.mount(this.root,this.styleModules.concat(Zj).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===t.key)return void(this.measureRequests[r]=t);this.measureRequests.push(t)}}plugin(t){let r=this.pluginMap.get(t);return(void 0===r||r&&r.spec!=t)&&this.pluginMap.set(t,r=this.plugins.find(i=>i.spec==t)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,r,i){return em(this,t,q1(this,t,r,i))}moveByGroup(t,r){return em(this,t,q1(this,t,r,i=>function(n,e,t){let r=n.state.charCategorizer(e),i=r(t);return s=>{let o=r(s);return i==gt.Space&&(i=o),i==o}}(this,t.head,i)))}visualLineSide(t,r){let i=this.bidiSpans(t),s=this.textDirectionAt(t.from),o=i[r?i.length-1:0];return V.cursor(o.side(r,s)+t.from,o.forward(!r,s)?1:-1)}moveToLineBoundary(t,r,i=!0){return function(n,e,t,r){let i=Xg(n,e.head),s=r&&i.type==mn.Text&&(n.lineWrapping||i.widgetLineBreaks)?n.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head):null;if(s){let o=n.dom.getBoundingClientRect(),a=n.textDirectionAt(i.from),l=n.posAtCoords({x:t==(a==$e.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(null!=l)return V.cursor(l,t?-1:1)}return V.cursor(t?i.to:i.from,t?-1:1)}(this,t,r,i)}moveVertically(t,r,i){return em(this,t,function(n,e,t,r){let i=e.head,s=t?1:-1;if(i==(t?n.state.doc.length:0))return V.cursor(i,e.assoc);let a,o=e.goalColumn,l=n.contentDOM.getBoundingClientRect(),u=n.coordsAtPos(i,e.assoc||-1),c=n.documentTop;if(u)null==o&&(o=u.left-l.left),a=s<0?u.top:u.bottom;else{let v=n.viewState.lineBlockAt(i);null==o&&(o=Math.min(l.right-l.left,n.defaultCharacterWidth*(i-v.from))),a=(s<0?v.top:v.bottom)+c}let d=l.left+o,g=null!=r?r:n.viewState.heightOracle.textHeight>>1;for(let v=0;;v+=10){let C=a+(g+v)*s,D=G1(n,{x:d,y:C},!1,s);if(C<l.top||C>l.bottom||(s<0?D<i:D>i)){let M=n.docView.coordsForChar(D);return V.cursor(D,!M||C<M.top?-1:1,void 0,o)}}}(this,t,r,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,r=0){return this.docView.posFromDOM(t,r)}posAtCoords(t,r=!0){return this.readMeasured(),G1(this,t,r)}coordsAtPos(t,r=1){this.readMeasured();let i=this.docView.coordsAt(t,r);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(t),o=this.bidiSpans(s);return Fc(i,o[Ui.find(o,t-s.from,-1,r)].dir==$e.LTR==r>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(T1)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>u8)return b1(t.length);let i,r=this.textDirectionAt(t.from);for(let o of this.bidiCache)if(o.from==t.from&&o.dir==r&&(o.fresh||w1(o.isolates,i=F1(this,t))))return o.order;i||(i=F1(this,t));let s=function(n,e,t){if(!n)return[new Ui(0,0,e==Wg?1:0)];if(e==Ss&&!t.length&&!ij.test(n))return b1(n.length);if(t.length)for(;n.length>Ue.length;)Ue[Ue.length]=256;let r=[],i=e==Ss?0:1;return qg(n,i,i,t,0,n.length,r),r}(t.text,r,i);return this.bidiCache.push(new Jc(t.from,t.to,r,i,!0,s)),s}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Q.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{YM(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,r={}){return Bc.of(new Vo("number"==typeof t?V.cursor(t):t,r.y,r.x,r.yMargin,r.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:r}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return Bc.of(new Vo(V.cursor(i.from),"start","start",i.top-t,r,!0))}static domEventHandlers(t){return ct.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return ct.define(()=>({}),{eventObservers:t})}static theme(t,r){let i=Vi.newName(),s=[Yc.of(i),Cl.of(om(`.${i}`,t))];return r&&r.dark&&s.push(im.of(!0)),s}static baseTheme(t){return bs.lowest(Cl.of(om("."+sm,t,bS)))}static findFromDOM(t){var r;let i=t.querySelector(".cm-content"),s=i&&je.get(i)||je.get(t);return(null===(r=null==s?void 0:s.rootView)||void 0===r?void 0:r.view)||null}}return n.styleModule=Cl,n.inputHandler=A1,n.scrollHandler=O1,n.focusChangeEffect=k1,n.perLineTextDirection=T1,n.exceptionSink=E1,n.updateListener=Kg,n.editable=Hc,n.mouseSelectionStyle=x1,n.dragMovesSelection=S1,n.clickAddsSelectionRange=M1,n.decorations=wl,n.outerDecorations=P1,n.atomicRanges=Yg,n.bidiIsolatedRanges=R1,n.scrollMargins=L1,n.darkTheme=im,n.cspNonce=Y.define({combine:e=>e.length?e[0]:""}),n.contentAttributes=jc,n.editorAttributes=N1,n.lineWrapping=n.contentAttributes.of({class:"cm-lineWrapping"}),n.announce=st.define(),n})();const u8=4096,xS={};class Jc{constructor(e,t,r,i,s,o){this.from=e,this.to=t,this.dir=r,this.isolates=i,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let r=[],i=e.length?e[e.length-1].dir:$e.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!t.touchesRange(o.from,o.to)&&r.push(new Jc(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function ES(n,e,t){for(let r=n.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o="function"==typeof s?s(n):s;o&&Hg(o,t)}return t}const c8=Q.mac?"mac":Q.windows?"win":Q.linux?"linux":"key";function Zc(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),!1!==t&&e.shiftKey&&(n="Shift-"+n),n}const lm=Y.define({enables:bs.default(he.domEventHandlers({keydown:(n,e)=>function(n,e,t,r){let i=function(n){var t=!(jH&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||$H&&n.shiftKey&&n.key&&1==n.key.length||"Unidentified"==n.key)&&n.key||(n.shiftKey?dl:Bi)[n.keyCode]||n.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(e),o=xc(Io(i,0))==i.length&&" "!=i,a="",l=!1,u=!1,c=!1;Wi&&Wi.view==t&&Wi.scope==r&&(a=Wi.prefix+" ",Y1.indexOf(e.keyCode)<0&&(u=!0,Wi=null));let C,D,d=new Set,g=M=>{if(M){for(let x of M.run)if(!d.has(x)&&(d.add(x),x(t,e)))return M.stopPropagation&&(c=!0),!0;M.preventDefault&&(M.stopPropagation&&(c=!0),u=!0)}return!1},v=n[r];return v&&(g(v[a+Zc(i,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Q.windows&&e.ctrlKey&&e.altKey)&&(C=Bi[e.keyCode])&&C!=i?(g(v[a+Zc(C,e,!0)])||e.shiftKey&&(D=dl[e.keyCode])!=i&&D!=C&&g(v[a+Zc(D,e,!1)]))&&(l=!0):o&&e.shiftKey&&g(v[a+Zc(i,e,!0)])&&(l=!0),!l&&g(v._any)&&(l=!0)),u&&(l=!0),l&&c&&e.stopPropagation(),l}(function(n){let e=n.facet(lm),t=AS.get(e);return t||AS.set(e,t=function(n,e=c8){let t=Object.create(null),r=Object.create(null),i=(o,a)=>{let l=r[o];if(null==l)r[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,u,c)=>{var d,g;let v=t[o]||(t[o]=Object.create(null)),C=a.split(/ (?!$)/).map(x=>function(n,e){const t=n.split(/-(?!$)/);let i,s,o,a,r=t[t.length-1];"Space"==r&&(r=" ");for(let l=0;l<t.length-1;++l){const u=t[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else{if(!/^mod$/i.test(u))throw new Error("Unrecognized modifier name: "+u);"mac"==e?a=!0:s=!0}}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),a&&(r="Meta-"+r),o&&(r="Shift-"+r),r}(x,e));for(let x=1;x<C.length;x++){let A=C.slice(0,x).join(" ");i(A,!0),v[A]||(v[A]={preventDefault:!0,stopPropagation:!1,run:[N=>{let L=Wi={view:N,prefix:A,scope:o};return setTimeout(()=>{Wi==L&&(Wi=null)},4e3),!0}]})}let D=C.join(" ");i(D,!1);let M=v[D]||(v[D]={preventDefault:!1,stopPropagation:!1,run:(null===(g=null===(d=v._any)||void 0===d?void 0:d.run)||void 0===g?void 0:g.slice())||[]});l&&M.run.push(l),u&&(M.preventDefault=!0),c&&(M.stopPropagation=!0)};for(let o of n){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of a){let c=t[u]||(t[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let d in c)c[d].run.push(o.any)}let l=o[e]||o.key;if(l)for(let u of a)s(u,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return t}(e.reduce((r,i)=>r.concat(i),[]))),t}(e.state),n,e,"editor")}))}),AS=new WeakMap;let Wi=null;class _l{constructor(e,t,r,i,s){this.className=e,this.left=t,this.top=r,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(r.empty){let i=e.coordsAtPos(r.head,r.assoc||1);if(!i)return[];let s=OS(e);return[new _l(t,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}return function(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let r=Math.max(t.from,n.viewport.from),i=Math.min(t.to,n.viewport.to),s=n.textDirection==$e.LTR,o=n.contentDOM,a=o.getBoundingClientRect(),l=OS(n),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),d=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),g=a.right-(c?parseInt(c.paddingRight):0),v=Xg(n,r),C=Xg(n,i),D=v.type==mn.Text?v:null,M=C.type==mn.Text?C:null;if(D&&(n.lineWrapping||v.widgetLineBreaks)&&(D=NS(n,r,D)),M&&(n.lineWrapping||C.widgetLineBreaks)&&(M=NS(n,i,M)),D&&M&&D.from==M.from)return A(N(t.from,t.to,D));{let F=D?N(t.from,null,D):L(v,!1),H=M?N(null,t.to,M):L(C,!0),U=[];return(D||v).to<(M||C).from-(D&&M?1:0)||v.widgetLineBreaks>1&&F.bottom+n.defaultLineHeight/2<H.top?U.push(x(d,F.bottom,g,H.top)):F.bottom<H.top&&n.elementAtHeight((F.bottom+H.top)/2).type==mn.Text&&(F.bottom=H.top=(F.bottom+H.top)/2),A(F).concat(U).concat(A(H))}function x(F,H,U,ie){return new _l(e,F-l.left,H-l.top-.01,U-F,ie-H+.01)}function A({top:F,bottom:H,horizontal:U}){let ie=[];for(let re=0;re<U.length;re+=2)ie.push(x(U[re],F,U[re+1],H));return ie}function N(F,H,U){let ie=1e9,re=-1e9,ae=[];function le(Ce,Pe,Xe,G,tn){let It=n.coordsAtPos(Ce,Ce==U.to?-2:2),Ie=n.coordsAtPos(Xe,Xe==U.from?2:-2);!It||!Ie||(ie=Math.min(It.top,Ie.top,ie),re=Math.max(It.bottom,Ie.bottom,re),tn==$e.LTR?ae.push(s&&Pe?d:It.left,s&&G?g:Ie.right):ae.push(!s&&G?d:Ie.left,!s&&Pe?g:It.right))}let X=null!=F?F:U.from,ke=null!=H?H:U.to;for(let Ce of n.visibleRanges)if(Ce.to>X&&Ce.from<ke)for(let Pe=Math.max(Ce.from,X),Xe=Math.min(Ce.to,ke);;){let G=n.state.doc.lineAt(Pe);for(let tn of n.bidiSpans(G)){let It=tn.from+G.from,Ie=tn.to+G.from;if(It>=Xe)break;Ie>Pe&&le(Math.max(It,Pe),null==F&&It<=X,Math.min(Ie,Xe),null==H&&Ie>=ke,tn.dir)}if(Pe=G.to+1,Pe>=Xe)break}return 0==ae.length&&le(X,null==F,ke,null==H,n.textDirection),{top:ie,bottom:re,horizontal:ae}}function L(F,H){let U=a.top+(H?F.top:F.bottom);return{top:U,bottom:U,horizontal:[]}}}(e,t,r)}}function OS(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==$e.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function NS(n,e,t){let r=V.cursor(e);return{from:Math.max(t.from,n.moveToLineBoundary(r,!1,!0).from),to:Math.min(t.to,n.moveToLineBoundary(r,!0,!0).from),type:mn.Text}}class y8{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Xc)!=e.state.facet(Xc)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(Xc);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,r)=>!function(n,e){return n.constructor==e.constructor&&n.eq(e)}(t,this.drawn[r]))){let t=this.dom.firstChild,r=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[r].constructor&&i.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Xc=Y.define();function PS(n){return[ct.define(e=>new y8(e,n)),Xc.of(n)]}const RS=!Q.ios,Bo=Y.define({combine:n=>Li(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function v8(n={}){return[Bo.of(n),C8,b8,D8,I1.of(!0)]}function FS(n){return n.startState.facet(Bo)!=n.state.facet(Bo)}const C8=PS({above:!0,markers(n){let{state:e}=n,t=e.facet(Bo),r=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty?!s||RS:t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=i.empty?i:V.cursor(i.head,i.head>i.anchor?-1:1);for(let l of _l.forRange(n,o,a))r.push(l)}}return r},update(n,e){n.transactions.some(r=>r.selection)&&(e.style.animationName="cm-blink"==e.style.animationName?"cm-blink2":"cm-blink");let t=FS(n);return t&&LS(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){LS(e.state,n)},class:"cm-cursorLayer"});function LS(n,e){e.style.animationDuration=n.facet(Bo).cursorBlinkRate+"ms"}const b8=PS({above:!1,markers:n=>n.state.selection.ranges.map(e=>e.empty?[]:_l.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t)),update:(n,e)=>n.docChanged||n.selectionSet||n.viewportChanged||FS(n),class:"cm-selectionLayer"}),um={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};RS&&(um[".cm-line"].caretColor="transparent !important",um[".cm-content"]={caretColor:"transparent !important"});const D8=bs.highest(he.theme(um));function BS(n,e,t,r,i){e.lastIndex=0;for(let a,s=n.iterRange(t,r),o=t;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)i(o+a.index,a)}class cm{constructor(e){const{regexp:t,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(a,l,u,c)=>i(c,u,u+a[0].length,a,l);else if("function"==typeof r)this.addMatch=(a,l,u,c)=>{let d=r(a,l,u);d&&c(u,u+a[0].length,d)};else{if(!r)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(a,l,u,c)=>c(u,u+a[0].length,r)}this.boundary=s,this.maxLength=o}createDeco(e){let t=new di,r=t.add.bind(t);for(let{from:i,to:s}of function(n,e){let t=n.visibleRanges;if(1==t.length&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let r=[];for(let{from:i,to:s}of t)i=Math.max(n.state.doc.lineAt(i).from,i-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}(e,this.maxLength))BS(e.state.doc,this.regexp,i,s,(o,a)=>this.addMatch(a,e,o,r));return t.finish()}updateDeco(e,t){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(r=Math.min(a,r),i=Math.max(l,i))}),e.viewportChanged||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),r,i):t}updateRange(e,t,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),a=Math.min(s.to,i);if(a>o){let l=e.state.doc.lineAt(o),u=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),d=Math.min(s.to,u.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<u.to;a++)if(this.boundary.test(u.text[a-u.from])){d=a;break}}let v,g=[],C=(D,M,x)=>g.push(x.range(D,M));if(l==u)for(this.regexp.lastIndex=c-l.from;(v=this.regexp.exec(l.text))&&v.index<d-l.from;)this.addMatch(v,e,v.index+l.from,C);else BS(e.state.doc,this.regexp,c,d,(D,M)=>this.addMatch(M,e,D,C));t=t.update({filterFrom:c,filterTo:d,filter:(D,M)=>D<c||M>d,add:g})}}return t}}const fm=null!=/x/.unicode?"gu":"g",S8=new RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]",fm),x8={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let hm=null;const ef=Y.define({combine(n){let e=Li(n,{render:null,specialChars:S8,addSpecialChars:null});return(e.replaceTabs=!function(){var n;if(null==hm&&"undefined"!=typeof document&&document.body){let e=document.body.style;hm=null!=(null!==(n=e.tabSize)&&void 0!==n?n:e.MozTabSize)}return hm||!1}())&&(e.specialChars=new RegExp("\t|"+e.specialChars.source,fm)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,fm)),e}});function A8(n={}){return[ef.of(n),HS||(HS=ct.fromClass(class{constructor(n){this.view=n,this.decorations=Z.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(ef)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new cm({regexp:n.specialChars,decoration:(e,t,r)=>{let{doc:i}=t.state,s=Io(e[0],0);if(9==s){let o=i.lineAt(r),a=t.state.tabSize,l=hl(o.text,a,r-o.from);return Z.replace({widget:new N8((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Z.replace({widget:new O8(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(ef);n.startState.facet(ef)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))]}let HS=null;class O8 extends Ms{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=(n=this.code)>=32?"\u2022":10==n?"\u2424":String.fromCharCode(9216+n),r=e.state.phrase("Control character")+" "+(x8[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,t);var n;if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class N8 extends Ms{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const pm=Y.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}}),zS=ct.fromClass(class{constructor(n){this.input=n.state.facet(Ho),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(pm);this.top=new af(n,!0,e.topContainer),this.bottom=new af(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(pm);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new af(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new af(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Ho);if(t!=this.input){let r=t.filter(l=>l),i=[],s=[],o=[],a=[];for(let l of r){let c,u=this.specs.indexOf(l);u<0?(c=l(n.view),a.push(c)):(c=this.panels[u],c.update&&c.update(n)),i.push(c),(c.top?s:o).push(c)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>he.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class af{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=qS(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=qS(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function qS(n){let e=n.nextSibling;return n.remove(),e}const Ho=Y.define({enables:zS});class Gi extends No{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Gi.prototype.elementClass="",Gi.prototype.toDOM=void 0,Gi.prototype.mapMode=gn.TrackBefore,Gi.prototype.startSide=Gi.prototype.endSide=-1,Gi.prototype.point=!0;const o3=1024;let a3=0;class Zn{constructor(e,t){this.from=e,this.to=t}}class ye{constructor(e={}){this.id=a3++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=yn.match(e)),t=>{let r=e(t);return void 0===r?null:[this,r]}}}ye.closedBy=new ye({deserialize:n=>n.split(" ")}),ye.openedBy=new ye({deserialize:n=>n.split(" ")}),ye.group=new ye({deserialize:n=>n.split(" ")}),ye.isolate=new ye({deserialize:n=>{if(n&&"rtl"!=n&&"ltr"!=n&&"auto"!=n)throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}}),ye.contextHash=new ye({perNode:!0}),ye.lookAhead=new ye({perNode:!0}),ye.mounted=new ye({perNode:!0});class Al{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[ye.mounted.id]}}const l3=Object.create(null);class yn{constructor(e,t,r,i=0){this.name=e,this.props=t,this.id=r,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):l3,i=new yn(e.name||"",t,e.id,(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0));if(e.props)for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}return i}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(ye.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let i of r.split(" "))t[i]=e[r];return r=>{for(let i=r.prop(ye.group),s=-1;s<(i?i.length:0);s++){let o=t[s<0?r.name:i[s]];if(o)return o}}}}yn.none=new yn("",Object.create(null),0,8);class Cm{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let i=null;for(let s of e){let o=s(r);o&&(i||(i=Object.assign({},r.props)),i[o[0].id]=o[1])}t.push(i?new yn(r.name,i,r.id,r.flags):r)}return new Cm(t)}}const lf=new WeakMap,tx=new WeakMap;var nt=(()=>{return(n=nt||(nt={}))[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",nt;var n})();class Ye{constructor(e,t,r,i,s){if(this.type=e,this.children=t,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props["number"==typeof o?o:o.id]=a}}toString(){let e=Al.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let i=r.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new uf(this.topNode,e)}cursorAt(e,t=0,r=0){let i=lf.get(this)||this.topNode,s=new uf(i);return s.moveTo(e,t),lf.set(this,s._tree),s}get topNode(){return new Zt(this,0,0,null)}resolve(e,t=0){let r=kl(lf.get(this)||this.topNode,e,t,!1);return lf.set(this,r),r}resolveInner(e,t=0){let r=kl(tx.get(this)||this.topNode,e,t,!0);return tx.set(this,r),r}resolveStack(e,t=0){return function(n,e,t){let r=n.resolveInner(e,t),i=null;for(let s=r instanceof Zt?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(i||(i=[r])).push(o.resolve(e,t)),s=o}else{let o=Al.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Zt(o.tree,o.overlay[0].from+s.from,-1,s);(i||(i=[r])).push(kl(a,e,t,!1))}}return i?sx(i):r}(this,e,t)}iterate(e){let{enter:t,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,a=(o&nt.IncludeAnonymous)>0;for(let l=this.cursor(o|nt.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=i&&(!a&&l.type.isAnonymous||!1!==t(l))){if(l.firstChild())continue;u=!0}for(;u&&r&&(a||!l.type.isAnonymous)&&r(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Mm(yn.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,i)=>new Ye(this.type,t,r,i,this.propValues),e.makeTree||((t,r,i)=>new Ye(yn.none,t,r,i)))}static build(e){return function(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:i=o3,reused:s=[],minRepeatType:o=r.types.length}=n,a=Array.isArray(t)?new bm(t,t.length):t,l=r.types,u=0,c=0;function d(F,H,U,ie,re,ae){let{id:le,start:X,end:ke,size:Ce}=a,Pe=c;for(;Ce<0;){if(a.next(),-1==Ce)return U.push(s[le]),void ie.push(X-F);if(-3==Ce)return void(u=le);if(-4==Ce)return void(c=le);throw new RangeError(`Unrecognized record size: ${Ce}`)}let G,tn,Xe=l[le],It=X-F;if(ke-X<=i&&(tn=function(F,H){let U=a.fork(),ie=0,re=0,ae=0,le=U.end-i,X={size:0,start:0,skip:0};e:for(let ke=U.pos-F;U.pos>ke;){let Ce=U.size;if(U.id==H&&Ce>=0){X.size=ie,X.start=re,X.skip=ae,ae+=4,ie+=4,U.next();continue}let Pe=U.pos-Ce;if(Ce<0||Pe<ke||U.start<le)break;let Xe=U.id>=o?4:0,G=U.start;for(U.next();U.pos>Pe;){if(U.size<0){if(-3!=U.size)break e;Xe+=4}else U.id>=o&&(Xe+=4);U.next()}re=G,ie+=Ce,ae+=Xe}return(H<0||ie==F)&&(X.size=ie,X.start=re,X.skip=ae),X.size>4?X:void 0}(a.pos-H,re))){let Ie=new Uint16Array(tn.size-tn.skip),Et=a.pos-tn.size,nn=Ie.length;for(;a.pos>Et;)nn=x(tn.start,Ie,nn);G=new zi(Ie,ke-tn.start,r),It=tn.start-F}else{let Ie=a.pos-Ce;a.next();let Et=[],nn=[],We=le>=o?le:-1,Xi=0,Zr=ke;for(;a.pos>Ie;)We>=0&&a.id==We&&a.size>=0?(a.end<=Zr-i&&(C(Et,nn,X,Xi,a.end,Zr,We,Pe),Xi=Et.length,Zr=a.end),a.next()):ae>2500?g(X,Ie,Et,nn):d(X,Ie,Et,nn,We,ae+1);if(We>=0&&Xi>0&&Xi<Et.length&&C(Et,nn,X,Xi,X,Zr,We,Pe),Et.reverse(),nn.reverse(),We>-1&&Xi>0){let Zo=function(F){return(H,U,ie)=>{let le,X,re=0,ae=H.length-1;if(ae>=0&&(le=H[ae])instanceof Ye){if(!ae&&le.type==F&&le.length==ie)return le;(X=le.prop(ye.lookAhead))&&(re=U[ae]+le.length+X)}return D(F,H,U,ie,re)}}(Xe);G=Mm(Xe,Et,nn,0,Et.length,0,ke-X,Zo,Zo)}else G=D(Xe,Et,nn,ke-X,Pe-ke)}U.push(G),ie.push(It)}function g(F,H,U,ie){let re=[],ae=0,le=-1;for(;a.pos>H;){let{id:X,start:ke,end:Ce,size:Pe}=a;if(Pe>4)a.next();else{if(le>-1&&ke<le)break;le<0&&(le=Ce-i),re.push(X,ke,Ce),ae++,a.next()}}if(ae){let X=new Uint16Array(4*ae),ke=re[re.length-2];for(let Ce=re.length-3,Pe=0;Ce>=0;Ce-=3)X[Pe++]=re[Ce],X[Pe++]=re[Ce+1]-ke,X[Pe++]=re[Ce+2]-ke,X[Pe++]=Pe;U.push(new zi(X,re[2]-ke,r)),ie.push(ke-F)}}function C(F,H,U,ie,re,ae,le,X){let ke=[],Ce=[];for(;F.length>ie;)ke.push(F.pop()),Ce.push(H.pop()+U-re);F.push(D(r.types[le],ke,Ce,ae-re,X-ae)),H.push(re-U)}function D(F,H,U,ie,re=0,ae){if(u){let le=[ye.contextHash,u];ae=ae?[le].concat(ae):[le]}if(re>25){let le=[ye.lookAhead,re];ae=ae?[le].concat(ae):[le]}return new Ye(F,H,U,ie,ae)}function x(F,H,U){let{id:ie,start:re,end:ae,size:le}=a;if(a.next(),le>=0&&ie<o){let X=U;if(le>4){let ke=a.pos-(le-4);for(;a.pos>ke;)U=x(F,H,U)}H[--U]=X,H[--U]=ae-F,H[--U]=re-F,H[--U]=ie}else-3==le?u=ie:-4==le&&(c=ie);return U}let A=[],N=[];for(;a.pos>0;)d(n.start||0,n.bufferStart||0,A,N,-1,0);let L=null!==(e=n.length)&&void 0!==e?e:A.length?N[0]+A[0].length:0;return new Ye(l[n.topID],A.reverse(),N.reverse(),L)}(e)}}Ye.empty=new Ye(yn.none,[],[],0);class bm{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new bm(this.buffer,this.index)}}class zi{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return yn.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let r=this.buffer[e+3],i=this.set.types[this.buffer[e]],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),r==(e+=4))return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,i,s){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(nx(s,i,o[l+1],o[l+2])&&(a=l,r>0));l=o[l+3]);return a}slice(e,t,r){let i=this.buffer,s=new Uint16Array(t-e),o=0;for(let a=e,l=0;a<t;){s[l++]=i[a++],s[l++]=i[a++]-r;let u=s[l++]=i[a++]-r;s[l++]=i[a++]-e,o=Math.max(o,u)}return new zi(s,o,this.set)}}function nx(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function kl(n,e,t,r){for(var i;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof Zt&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:nt.IgnoreOverlays;if(r)for(let o=n,a=o.parent;a;o=a,a=o.parent)o instanceof Zt&&o.index<0&&(null===(i=a.enter(e,t,s))||void 0===i?void 0:i.from)!=o.from&&(n=a);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class rx{cursor(e=0){return new uf(this,e)}getChild(e,t=null,r=null){let i=ix(this,e,t,r);return i.length?i[0]:null}getChildren(e,t=null,r=null){return ix(this,e,t,r)}resolve(e,t=0){return kl(this,e,t,!1)}resolveInner(e,t=0){return kl(this,e,t,!0)}matchContext(e){return Dm(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(r=t,t=i.prevSibling):t=i}return r}get node(){return this}get next(){return this.parent}}class Zt extends rx{constructor(e,t,r,i){super(),this._tree=e,this.from=t,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,i,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=t>0?a.length:-1;e!=u;e+=t){let c=a[e],d=l[e]+o.from;if(nx(i,r,d,d+c.length))if(c instanceof zi){if(s&nt.ExcludeBuffers)continue;let g=c.findChild(0,c.buffer.length,t,r-d,i);if(g>-1)return new Wr(new u3(o,c,e,d),null,g)}else if(s&nt.IncludeAnonymous||!c.type.isAnonymous||_m(c)){let g;if(!(s&nt.IgnoreMounts)&&(g=Al.get(c))&&!g.overlay)return new Zt(g.tree,d,e,o);let v=new Zt(c,d,e,o);return s&nt.IncludeAnonymous||!v.type.isAnonymous?v:v.nextChild(t<0?c.children.length-1:0,t,r,i)}}if(s&nt.IncludeAnonymous||!o.type.isAnonymous||(e=o.index>=0?o.index+t:t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let i;if(!(r&nt.IgnoreOverlays)&&(i=Al.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:o,to:a}of i.overlay)if((t>0?o<=s:o<s)&&(t<0?a>=s:a>s))return new Zt(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function ix(n,e,t,r){let i=n.cursor(),s=[];if(!i.firstChild())return s;if(null!=t)for(let o=!1;!o;)if(o=i.type.is(t),!i.nextSibling())return s;for(;;){if(null!=r&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return null==r?s:[]}}function Dm(n,e,t=e.length-1){for(let r=n.parent;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class u3{constructor(e,t,r,i){this.parent=e,this.buffer=t,this.index=r,this.start=i}}class Wr extends rx{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new Wr(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&nt.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Wr(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Wr(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Wr(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];return s>i&&(e.push(r.slice(i,s,r.buffer[this.index+1])),t.push(0)),new Ye(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function sx(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let r=t instanceof Zt&&t.index<0?null:t.parent,i=n.slice();return r?i[e]=r:i.splice(e,1),new c3(i,t)}class c3{constructor(e,t){this.heads=e,this.node=t}get next(){return sx(this.heads)}}class uf{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Zt)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return!!e&&(e instanceof Zt?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,r);return!(s<0)&&(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&nt.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&nt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&nt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=i)}else({index:t,_parent:r}=this._tree);for(;r;({index:t,_parent:r}=r))if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let a=r._tree.children[s];if(this.mode&nt.IncludeAnonymous||a instanceof zi||!a.type.isAnonymous||_m(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;t=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)t=new Wr(this.buffer,t,this.stack[i]);return this.bufferNode=new Wr(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let i=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;i&&t&&t(this),i=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return Dm(this.node,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return Dm(this.node,e,i);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function _m(n){return n.children.some(e=>e instanceof zi||!e.type.isAnonymous||_m(e))}const ox=new WeakMap;function cf(n,e){if(!n.isAnonymous||e instanceof zi||e.type!=n)return 1;let t=ox.get(e);if(null==t){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof Ye)){t=1;break}t+=cf(n,r)}ox.set(e,t)}return t}function Mm(n,e,t,r,i,s,o,a,l){let u=0;for(let C=r;C<i;C++)u+=cf(n,e[C]);let c=Math.ceil(1.5*u/8),d=[],g=[];return function v(C,D,M,x,A){for(let N=M;N<x;){let L=N,F=D[N],H=cf(n,C[N]);for(N++;N<x;N++){let U=cf(n,C[N]);if(H+U>=c)break;H+=U}if(N==L+1){if(H>c){let U=C[L];v(U.children,U.positions,0,U.children.length,D[L]+A);continue}d.push(C[L])}else d.push(Mm(n,C,D,L,N,F,D[N-1]+C[N-1].length-F,null,l));g.push(F+A-s)}}(e,t,r,i,0),(a||l)(d,g,o)}class mi{constructor(e,t,r,i,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],r=!1){let i=[new mi(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,r=128){if(!t.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,u=0;;a++){let c=a<t.length?t[a]:null,d=c?c.fromA:1e9;if(d-l>=r)for(;o&&o.from<d;){let g=o;if(l>=g.from||d<=g.to||u){let v=Math.max(g.from,l)-u,C=Math.min(g.to,d)-u;g=v>=C?null:new mi(v,C,g.tree,g.offset+u,a>0,!!c)}if(g&&i.push(g),o.to>d)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,u=c.toA-c.toB}return i}}class ax{startParse(e,t,r){return"string"==typeof e&&(e=new d3(e)),r=r?r.length?r.map(i=>new Zn(i.from,i.to)):[new Zn(0,0)]:[new Zn(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let i=this.startParse(e,t,r);for(;;){let s=i.advance();if(s)return s}}}class d3{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new ye({perNode:!0});let C3=0;class Gr{constructor(e,t,r){this.set=e,this.base=t,this.modified=r,this.id=C3++}static define(e){if(null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new Gr([],null,[]);if(t.set.push(t),e)for(let r of e.set)t.set.push(r);return t}static defineModifier(){let e=new ff;return t=>t.modified.indexOf(e)>-1?t:ff.get(t.base||t,t.modified.concat(e).sort((r,i)=>r.id-i.id))}}let b3=0;class ff{constructor(){this.instances=[],this.id=b3++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(a=>a.base==e&&function(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}(t,a.modified));if(r)return r;let i=[],s=new Gr(i,e,t);for(let a of t)a.instances.push(s);let o=function(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,i=e.length;r<i;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}(t);for(let a of e.set)if(!a.modified.length)for(let l of o)i.push(ff.get(a,l));return s}}function M3(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let i of t.split(" "))if(i){let s=[],o=2,a=i;for(let d=0;;){if("..."==a&&d>0&&d+3==i.length){o=1;break}let g=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!g)throw new RangeError("Invalid path: "+i);if(s.push("*"==g[0]?"":'"'==g[0][0]?JSON.parse(g[0]):g[0]),d+=g[0].length,d==i.length)break;let v=i[d++];if(d==i.length&&"!"==v){o=0;break}if("/"!=v)throw new RangeError("Invalid path: "+i);a=i.slice(d)}let l=s.length-1,u=s[l];if(!u)throw new RangeError("Invalid path: "+i);let c=new hf(r,o,l>0?s.slice(0,l):null);e[u]=c.sort(e[u])}}return px.add(e)}const px=new ye;class hf{constructor(e,t,r,i){this.tags=e,this.mode=t,this.context=r,this.next=i}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function gx(n,e){let t=Object.create(null);for(let s of n)if(Array.isArray(s.tag))for(let o of s.tag)t[o.id]=s.class;else t[s.tag.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let a of s)for(let l of a.set){let u=t[l.id];if(u){o=o?o+" "+u:u;break}}return o},scope:r}}function mx(n,e,t,r=0,i=n.length){let s=new x3(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,i,"",s.highlighters),s.flush(i)}hf.empty=new hf([],2,null);class x3{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,i,s){let{type:o,from:a,to:l}=e;if(a>=r||l<=t)return;o.isTop&&(s=this.highlighters.filter(v=>!v.scope||v.scope(o)));let u=i,c=function(n){let e=n.type.prop(px);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}(e)||hf.empty,d=function(n,e){let t=null;for(let r of n){let i=r.style(e);i&&(t=t?t+" "+i:i)}return t}(s,c.tags);if(d&&(u&&(u+=" "),u+=d,1==c.mode&&(i+=(i?" ":"")+d)),this.startSpan(Math.max(t,a),u),c.opaque)return;let g=e.tree&&e.tree.prop(ye.mounted);if(g&&g.overlay){let v=e.node.enter(g.overlay[0].from+a,1),C=this.highlighters.filter(M=>!M.scope||M.scope(g.tree.type)),D=e.firstChild();for(let M=0,x=a;;M++){let A=M<g.overlay.length?g.overlay[M]:null,N=A?A.from+a:l,L=Math.max(t,x),F=Math.min(r,N);if(L<F&&D)for(;e.from<F&&(this.highlightRange(e,L,F,i,s),this.startSpan(Math.min(F,e.to),u),!(e.to>=N)&&e.nextSibling()););if(!A||N>r)break;x=A.to+a,x>t&&(this.highlightRange(v.cursor(),Math.max(t,A.from+a),Math.min(r,x),"",C),this.startSpan(Math.min(r,x),u))}D&&e.parent()}else if(e.firstChild()){g&&(i="");do{if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,i,s),this.startSpan(Math.min(r,e.to),u)}}while(e.nextSibling());e.parent()}}}const z=Gr.define,df=z(),qi=z(),yx=z(qi),vx=z(qi),Ki=z(),pf=z(Ki),xm=z(Ki),zr=z(),xs=z(zr),qr=z(),Kr=z(),Em=z(),Tl=z(Em),gf=z(),$={comment:df,lineComment:z(df),blockComment:z(df),docComment:z(df),name:qi,variableName:z(qi),typeName:yx,tagName:z(yx),propertyName:vx,attributeName:z(vx),className:z(qi),labelName:z(qi),namespace:z(qi),macroName:z(qi),literal:Ki,string:pf,docString:z(pf),character:z(pf),attributeValue:z(pf),number:xm,integer:z(xm),float:z(xm),bool:z(Ki),regexp:z(Ki),escape:z(Ki),color:z(Ki),url:z(Ki),keyword:qr,self:z(qr),null:z(qr),atom:z(qr),unit:z(qr),modifier:z(qr),operatorKeyword:z(qr),controlKeyword:z(qr),definitionKeyword:z(qr),moduleKeyword:z(qr),operator:Kr,derefOperator:z(Kr),arithmeticOperator:z(Kr),logicOperator:z(Kr),bitwiseOperator:z(Kr),compareOperator:z(Kr),updateOperator:z(Kr),definitionOperator:z(Kr),typeOperator:z(Kr),controlOperator:z(Kr),punctuation:Em,separator:z(Em),bracket:Tl,angleBracket:z(Tl),squareBracket:z(Tl),paren:z(Tl),brace:z(Tl),content:zr,heading:xs,heading1:z(xs),heading2:z(xs),heading3:z(xs),heading4:z(xs),heading5:z(xs),heading6:z(xs),contentSeparator:z(zr),list:z(zr),quote:z(zr),emphasis:z(zr),strong:z(zr),link:z(zr),monospace:z(zr),strikethrough:z(zr),inserted:z(),deleted:z(),changed:z(),invalid:z(),meta:gf,documentMeta:z(gf),annotation:z(gf),processingInstruction:z(gf),definition:Gr.defineModifier(),constant:Gr.defineModifier(),function:Gr.defineModifier(),standard:Gr.defineModifier(),local:Gr.defineModifier(),special:Gr.defineModifier()};var Am;gx([{tag:$.link,class:"tok-link"},{tag:$.heading,class:"tok-heading"},{tag:$.emphasis,class:"tok-emphasis"},{tag:$.strong,class:"tok-strong"},{tag:$.keyword,class:"tok-keyword"},{tag:$.atom,class:"tok-atom"},{tag:$.bool,class:"tok-bool"},{tag:$.url,class:"tok-url"},{tag:$.labelName,class:"tok-labelName"},{tag:$.inserted,class:"tok-inserted"},{tag:$.deleted,class:"tok-deleted"},{tag:$.literal,class:"tok-literal"},{tag:$.string,class:"tok-string"},{tag:$.number,class:"tok-number"},{tag:[$.regexp,$.escape,$.special($.string)],class:"tok-string2"},{tag:$.variableName,class:"tok-variableName"},{tag:$.local($.variableName),class:"tok-variableName tok-local"},{tag:$.definition($.variableName),class:"tok-variableName tok-definition"},{tag:$.special($.variableName),class:"tok-variableName2"},{tag:$.definition($.propertyName),class:"tok-propertyName tok-definition"},{tag:$.typeName,class:"tok-typeName"},{tag:$.namespace,class:"tok-namespace"},{tag:$.className,class:"tok-className"},{tag:$.macroName,class:"tok-macroName"},{tag:$.propertyName,class:"tok-propertyName"},{tag:$.operator,class:"tok-operator"},{tag:$.comment,class:"tok-comment"},{tag:$.meta,class:"tok-meta"},{tag:$.invalid,class:"tok-invalid"},{tag:$.punctuation,class:"tok-punctuation"}]);const Es=new ye;const A3=new ye;let Xn=(()=>{class n{constructor(t,r,i=[],s=""){this.data=t,this.name=s,vr.prototype.hasOwnProperty("tree")||Object.defineProperty(vr.prototype,"tree",{get(){return Lt(this)}}),this.parser=r,this.extension=[Qi.of(this),vr.languageData.of((o,a,l)=>{let u=Cx(o,a,l),c=u.type.prop(Es);if(!c)return[];let d=o.facet(c),g=u.type.prop(A3);if(g){let v=u.resolve(a-u.from,l);for(let C of g)if(C.test(v,o)){let D=o.facet(C.facet);return"replace"==C.type?D:D.concat(d)}}return d})].concat(i)}isActiveAt(t,r,i=-1){return Cx(t,r,i).type.prop(Es)==this.data}findRegions(t){let r=t.facet(Qi);if((null==r?void 0:r.data)==this.data)return[{from:0,to:t.doc.length}];if(!r||!r.allowsNesting)return[];let i=[],s=(o,a)=>{if(o.prop(Es)==this.data)return void i.push({from:a,to:a+o.length});let l=o.prop(ye.mounted);if(l){if(l.tree.prop(Es)==this.data){if(l.overlay)for(let u of l.overlay)i.push({from:u.from+a,to:u.to+a});else i.push({from:a,to:a+o.length});return}if(l.overlay){let u=i.length;if(s(l.tree,l.overlay[0].from+a),i.length>u)return}}for(let u=0;u<o.children.length;u++){let c=o.children[u];c instanceof Ye&&s(c,o.positions[u]+a)}};return s(Lt(t),0),i}get allowsNesting(){return!0}}return n.setState=st.define(),n})();function Cx(n,e,t){let r=n.facet(Qi),i=Lt(n).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,t,nt.ExcludeBuffers))s.type.isTop&&(i=s);return i}function Lt(n){let e=n.field(Xn.state,!1);return e?e.tree:Ye.empty}function Tm(n,e,t=50){var r;let i=null===(r=n.field(Xn.state,!1))||void 0===r?void 0:r.context;if(!i)return null;let s=i.viewport;i.updateViewport({from:0,to:e});let o=i.isDone(e)||i.work(t,e)?i.tree:null;return i.updateViewport(s),o}class k3{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let Il=null;class $o{constructor(e,t,r=[],i,s,o,a,l){this.parser=e,this.state=t,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new $o(e,t,[],Ye.empty,0,r,[],null)}startParse(){return this.parser.startParse(new k3(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ye.empty&&this.isDone(null!=t?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if("number"==typeof e){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i){if(this.fragments=this.withoutTempSkipped(mi.addTree(i,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(r=this.parse.stoppedAt)&&void 0!==r?r:this.state.doc.length,this.tree=i,this.parse=null,!(this.treeLen<(null!=t?t:this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(mi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Il;Il=this;try{return e()}finally{Il=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=bx(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,d,g)=>l.push({fromA:u,toA:c,fromB:d,toB:g})),r=mi.applyChanges(r,l),i=Ye.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),d=e.mapPos(u.to,-1);c<d&&a.push({from:c,to:d})}}}return new $o(this.parser,t,r,i,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=bx(this.fragments,i,s),this.skipped.splice(r--,1))}return!(this.skipped.length>=t||(this.reset(),0))}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends ax{createParse(t,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let l=Il;if(l){for(let u of i)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new Ye(yn.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return Il}}function bx(n,e,t){return mi.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Uo{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new Uo(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=$o.create(e.facet(Qi).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new Uo(r)}}Xn.state=Mn.define({create:Uo.init,update(n,e){for(let t of e.effects)if(t.is(Xn.setState))return t.value;return e.startState.facet(Qi)!=e.state.facet(Qi)?Uo.init(e.state):n.apply(e)}});let Dx=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(Dx=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Im="undefined"!=typeof navigator&&(null===(Am=navigator.scheduling)||void 0===Am?void 0:Am.isInputPending)?()=>navigator.scheduling.isInputPending():null,_x=ct.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Xn.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Xn.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Dx(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(Xn.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Im?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<i&&r.doc.length>i+1e3,l=s.context.work(()=>Im&&Im()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Xn.setState.of(new Uo(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Cr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Qi=Y.define({combine:n=>n.length?n[0]:null,enables:n=>[Xn.state,_x,he.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class T3{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const Sx=Y.define(),Ol=Y.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function As(n){let e=n.facet(Ol);return 9==e.charCodeAt(0)?n.tabSize*e.length:e.length}function Wo(n,e){let t="",r=n.tabSize,i=n.facet(Ol)[0];if("\t"==i){for(;e>=r;)t+="\t",e-=r;i=" "}for(let s=0;s<e;s++)t+=i;return t}function mf(n,e){n instanceof vr&&(n=new Nl(n));for(let r of n.state.facet(Sx)){let i=r(n,e);if(void 0!==i)return i}let t=Lt(n.state);return t.length>=e?function(n,e,t){let r=e.resolveStack(t),i=r.node.enterUnfinishedNodesBefore(t);if(i!=r.node){let s=[];for(let o=i;o!=r.node;o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return xx(r,n,t)}(n,t,e):null}class Nl{constructor(e,t={}){this.state=e,this.options=t,this.unit=As(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return null!=i&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,t);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return hl(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const I3=new ye;function xx(n,e,t){for(let r=n;r;r=r.next){let i=P3(r.node);if(i)return i(Om.create(e,t,r))}return 0}function P3(n){let e=n.type.prop(I3);if(e)return e;let r,t=n.firstChild;if(t&&(r=t.type.prop(ye.closedBy))){let i=n.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>function(n,e,t,r,i){let s=n.textAfter,o=s.match(/^\s*/)[0].length,a=r&&s.slice(o,o+r.length)==r||i==n.pos+o,l=e?function(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let i=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=null==i||i<=s.from?s.to:Math.min(s.to,i);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==r)return null;if(!l.type.isSkipped)return l.from<o?t:null;a=l.to}}(n):null;return l?n.column(a?l.from:l.to):n.baseIndent+(a?0:n.unit*t)}(o,!0,1,void 0,s&&!function(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}(o)?i.from:void 0)}return null==n.parent?R3:null}function R3(){return 0}class Om extends Nl{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new Om(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(F3(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return xx(this.context.next,this.base,this.pos)}}function F3(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}const B3=Y.define(),H3=new ye;function $3(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Pl(n,e,t){for(let r of n.facet(B3)){let i=r(n,e,t);if(i)return i}return function(n,e,t){let r=Lt(n);if(r.length<t)return null;let s=null;for(let o=r.resolveStack(t,1);o;o=o.next){let a=o.node;if(a.to<=t||a.from>t)continue;if(s&&a.from<e)break;let l=a.type.prop(H3);if(l&&(a.to<r.length-50||r.length==n.doc.length||!$3(a))){let u=l(a,n);u&&u.from<=t&&u.from>=e&&u.to>t&&(s=u)}}return s}(n,e,t)}function Ax(n,e){let t=e.mapPos(n.from,1),r=e.mapPos(n.to,-1);return t>=r?void 0:{from:t,to:r}}const Rl=st.define({map:Ax}),Go=st.define({map:Ax});const Yi=Mn.define({create:()=>Z.none,update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(Rl)&&!U3(n,t.value.from,t.value.to)){let{preparePlaceholder:r}=e.state.facet(Rm),i=r?Z.replace({widget:new Q3(r(e.state,t.value))}):Ox;n=n.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(Go)&&(n=n.update({filter:(r,i)=>t.value.from!=r||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:r}=e.selection.main;n.between(r,r,(i,s)=>{i<r&&s>r&&(t=!0)}),t&&(n=n.update({filterFrom:r,filterTo:r,filter:(i,s)=>s<=r||i>=r}))}return n},provide:n=>he.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(r,i)=>{t.push(r,i)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let r=n[t++],i=n[t++];if("number"!=typeof r||"number"!=typeof i)throw new RangeError("Invalid JSON for fold state");e.push(Ox.range(r,i))}return Z.set(e,!0)}});function U3(n,e,t){let r=!1;return n.between(e,e,(i,s)=>{i==e&&s==t&&(r=!0)}),r}function Pm(n,e){return n.field(Yi,!1)?e:e.concat(st.appendConfig.of(function(n){let e=[Yi,J3];return n&&e.push(Rm.of(n)),e}()))}function yf(n,e,t=!0){let r=n.state.doc.lineAt(e.from).number,i=n.state.doc.lineAt(e.to).number;return he.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${i}.`)}const K3={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},Rm=Y.define({combine:n=>Li(n,K3)});function Ix(n,e){let{state:t}=n,r=t.facet(Rm),i=o=>{let a=n.lineBlockAt(n.posAtDOM(o.target)),l=function(n,e,t){var r;let i=null;return null===(r=n.field(Yi,!1))||void 0===r||r.between(e,t,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}(n.state,a.from,a.to);l&&n.dispatch({effects:Go.of(l)}),o.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,i,e);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const Ox=Z.replace({widget:new class extends Ms{toDOM(n){return Ix(n,null)}}});class Q3 extends Ms{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Ix(e,this.value)}}const J3=he.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ll{constructor(e,t){let r;function i(a){let l=Vi.newName();return(r||(r=Object.create(null)))["."+l]=a,l}this.specs=e;const s="string"==typeof t.all?t.all:t.all?i(t.all):void 0,o=t.scope;this.scope=o instanceof Xn?a=>a.prop(Es)==o.data:o?a=>a==o:void 0,this.style=gx(e.map(a=>({tag:a.tag,class:a.class||i(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=r?new Vi(r):null,this.themeType=t.themeType}static define(e,t){return new Ll(e,t||{})}}const Lm=Y.define(),Nx=Y.define({combine:n=>n.length?[n[0]]:null});function vf(n){let e=n.facet(Lm);return e.length?e:n.facet(Nx)}function Px(n,e){let r,t=[X3];return n instanceof Ll&&(n.module&&t.push(he.styleModule.of(n.module)),r=n.themeType),t.push((null==e?void 0:e.fallback)?Nx.of(n):r?Lm.computeN([he.darkTheme],i=>i.facet(he.darkTheme)==("dark"==r)?[n]:[]):Lm.of(n)),t}class Z3{constructor(e){this.markCache=Object.create(null),this.tree=Lt(e.state),this.decorations=this.buildDeco(e,vf(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Lt(e.state),r=vf(e.state),i=r!=vf(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!i&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return Z.none;let r=new di;for(let{from:i,to:s}of e.visibleRanges)mx(this.tree,t,(o,a,l)=>{r.add(o,a,this.markCache[l]||(this.markCache[l]=Z.mark({class:l})))},i,s);return r.finish()}}const X3=bs.high(ct.fromClass(Z3,{decorations:n=>n.decorations})),e$=Ll.define([{tag:$.meta,color:"#404740"},{tag:$.link,textDecoration:"underline"},{tag:$.heading,textDecoration:"underline",fontWeight:"bold"},{tag:$.emphasis,fontStyle:"italic"},{tag:$.strong,fontWeight:"bold"},{tag:$.strikethrough,textDecoration:"line-through"},{tag:$.keyword,color:"#708"},{tag:[$.atom,$.bool,$.url,$.contentSeparator,$.labelName],color:"#219"},{tag:[$.literal,$.inserted],color:"#164"},{tag:[$.string,$.deleted],color:"#a11"},{tag:[$.regexp,$.escape,$.special($.string)],color:"#e40"},{tag:$.definition($.variableName),color:"#00f"},{tag:$.local($.variableName),color:"#30a"},{tag:[$.typeName,$.namespace],color:"#085"},{tag:$.className,color:"#167"},{tag:[$.special($.variableName),$.macroName],color:"#256"},{tag:$.definition($.propertyName),color:"#00c"},{tag:$.comment,color:"#940"},{tag:$.invalid,color:"#f00"}]),o$=new ye;function Vm(n,e,t){let r=n.prop(e<0?ye.openedBy:ye.closedBy);if(r)return r;if(1==n.name.length){let i=t.indexOf(n.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function Bm(n){let e=n.type.prop(o$);return e?e(n.node):n}function er(n,e,t,r={}){let i=r.maxScanDistance||1e4,s=r.brackets||"()[]{}",o=Lt(n),a=o.resolveInner(e,t);for(let l=a;l;l=l.parent){let u=Vm(l.type,t,s);if(u&&l.from<l.to){let c=Bm(l);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return a$(0,0,t,l,c,u,s)}}return function(n,e,t,r,i,s,o){let a=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=t>0)return null;let u={from:t<0?e-1:e,to:t>0?e+1:e},c=n.doc.iterRange(e,t>0?n.doc.length:0),d=0;for(let g=0;!c.next().done&&g<=s;){let v=c.value;t<0&&(g+=v.length);let C=e+g*t;for(let D=t>0?0:v.length-1,M=t>0?v.length:-1;D!=M;D+=t){let x=o.indexOf(v[D]);if(!(x<0||r.resolveInner(C+D,1).type!=i))if(x%2==0==t>0)d++;else{if(1==d)return{start:u,end:{from:C+D,to:C+D+1},matched:x>>1==l>>1};d--}}t>0&&(g+=v.length)}return c.done?{start:u,matched:!1}:null}(n,e,t,o,a.type,i,s)}function a$(n,e,t,r,i,s,o){let a=r.parent,l={from:i.from,to:i.to},u=0,c=null==a?void 0:a.cursor();if(c&&(t<0?c.childBefore(r.from):c.childAfter(r.to)))do{if(t<0?c.to<=r.from:c.from>=r.to){if(0==u&&s.indexOf(c.type.name)>-1&&c.from<c.to){let d=Bm(c);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}if(Vm(c.type,t,o))u++;else if(Vm(c.type,-t,o)){if(0==u){let d=Bm(c);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}u--}}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function Vx(n,e,t,r=0,i=0){null==e&&-1==(e=n.search(/[^\s\u00a0]/))&&(e=n.length);let s=i;for(let o=r;o<e;o++)9==n.charCodeAt(o)?s+=t-s%t:s++;return s}class Hm{constructor(e,t,r,i){this.string=e,this.tabSize=t,this.indentUnit=r,this.overrideIndent=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let r,t=this.string.charAt(this.pos);if(r="string"==typeof e?t==e:t&&(e instanceof RegExp?e.test(t):e(t)),r)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Vx(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return null!==(e=this.overrideIndent)&&void 0!==e?e:Vx(this.string,null,this.tabSize)}match(e,t,r){if("string"==typeof e){let i=o=>r?o.toLowerCase():o;return i(this.string.substr(this.pos,e.length))==i(e)?(!1!==t&&(this.pos+=e.length),!0):null}{let i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}}function c$(n){if("object"!=typeof n)return n;let e={};for(let t in n){let r=n[t];e[t]=r instanceof Array?r.slice():r}return e}const Bx=new WeakMap;class jm extends Xn{constructor(e){let i,t=function(n){return Y.define({combine:n?e=>e.concat(n):void 0})}(e.languageData),r={name:(n=e).name||"",token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||c$,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||Um};var n;super(t,new class extends ax{createParse(o,a,l){return new h$(i,o,a,l)}},[Sx.of((o,a)=>this.getIndent(o,a))],e.name),this.topNode=function(n){let e=yn.define({id:Vl.length,name:"Document",props:[Es.add(()=>n)],top:!0});return Vl.push(e),e}(t),i=this,this.streamParser=r,this.stateAfter=new ye({perNode:!0}),this.tokenTable=e.tokenTable?new Gx(r.tokenTable):p$}static define(e){return new jm(e)}getIndent(e,t){let r=Lt(e.state),i=r.resolve(t);for(;i&&i.type!=this.topNode;)i=i.parent;if(!i)return null;let s,{overrideIndentation:o}=e.options;o&&(s=Bx.get(e.state),null!=s&&s<t-1e4&&(s=void 0));let l,u,a=$m(this,r,0,i.from,null!=s?s:t);if(a?(u=a.state,l=a.pos+1):(u=this.streamParser.startState(e.unit),l=0),t-l>1e4)return null;for(;l<t;){let d=e.state.doc.lineAt(l),g=Math.min(t,d.to);if(d.length){let v=o?o(d.from):-1,C=new Hm(d.text,e.state.tabSize,e.unit,v<0?void 0:v);for(;C.pos<g-d.from;)jx(this.streamParser.token,C,u)}else this.streamParser.blankLine(u,e.unit);if(g==t)break;l=d.to+1}let c=e.lineAt(t);return o&&null==s&&Bx.set(e.state,c.from),this.streamParser.indent(u,/^\s*(.*)/.exec(c.text)[1],e)}get allowsNesting(){return!1}}function $m(n,e,t,r,i){let s=t>=r&&t+e.length<=i&&e.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:t+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=t+e.positions[o],u=a instanceof Ye&&l<i&&$m(n,a,l,r,i);if(u)return u}return null}function Hx(n,e,t,r,i){if(i&&t<=0&&r>=e.length)return e;!i&&e.type==n.topNode&&(i=!0);for(let s=e.children.length-1;s>=0;s--){let l,o=e.positions[s],a=e.children[s];if(o<r&&a instanceof Ye){if(!(l=Hx(n,a,t-o,r-o,i)))break;return i?new Ye(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}class h${constructor(e,t,r,i){this.lang=e,this.input=t,this.fragments=r,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let s=$o.get(),o=i[0].from,{state:a,tree:l}=function(n,e,t,r){for(let i of e){let l,o=i.to-(i.openEnd?25:0),a=i.from+(i.openStart?25:0)<=t&&o>t&&$m(n,i.tree,0-i.offset,t,o);if(a&&(l=Hx(n,i.tree,t+i.offset,a.pos+i.offset,!1)))return{state:a.state,tree:l}}return{state:n.streamParser.startState(r?As(r):4),tree:Ye.empty}}(e,r,o,null==s?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(As(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=$o.get(),t=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(t,this.chunkStart+2048);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)"\n"==t&&(t="");else{let r=t.indexOf("\n");r>-1&&(t=t.slice(0,r))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),r=e+t.length;for(let i=this.rangeIndex;;){let s=this.ranges[i].to;if(s>=r||(t=t.slice(0,s-(r-t.length)),i++,i==this.ranges.length))break;let o=this.ranges[i].from,a=this.lineAfter(o);t+=a,r=o+a.length}return{line:t,end:r}}skipGapsTo(e,t,r){for(;;){let i=this.ranges[this.rangeIndex].to,s=e+t;if(r>0?i>s:i>=s)break;t+=this.ranges[++this.rangeIndex].from-i}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,r,i,s){if(this.ranges.length>1){t+=s=this.skipGapsTo(t,s,1);let o=this.chunk.length;r+=s=this.skipGapsTo(r,s,-1),i+=this.chunk.length-o}return this.chunk.push(e,t,r,i),s}parseLine(e){let{line:t,end:r}=this.nextLine(),i=0,{streamParser:s}=this.lang,o=new Hm(t,e?e.state.tabSize:4,e?As(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=jx(s.token,o,this.state);if(a&&(i=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,4,i)),o.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ye.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:d$,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ye(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ye(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function jx(n,e,t){e.start=e.pos;for(let r=0;r<10;r++){let i=n(e,t);if(e.pos>e.start)return i}throw new Error("Stream parser failed to advance stream.")}const Um=Object.create(null),Vl=[yn.none],d$=new Cm(Vl),$x=[],Ux=Object.create(null),Wx=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Wx[n]=zx(Um,e);class Gx{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),Wx)}resolve(e){return e?this.table[e]||(this.table[e]=zx(this.extra,e)):0}}const p$=new Gx(Um);function Wm(n,e){$x.indexOf(n)>-1||($x.push(n),console.warn(e))}function zx(n,e){let t=[];for(let a of e.split(" ")){let l=[];for(let u of a.split(".")){let c=n[u]||$[u];c?"function"==typeof c?l.length?l=l.map(c):Wm(u,`Modifier ${u} used at start of tag`):l.length?Wm(u,`Tag ${u} used as modifier`):l=Array.isArray(c)?c:[c]:Wm(u,`Unknown highlighting tag ${u}`)}for(let u of l)t.push(u)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),i=r+" "+t.map(a=>a.id),s=Ux[i];if(s)return s.id;let o=Ux[i]=yn.define({id:Vl.length,name:r,props:[M3({[r]:t})]});return Vl.push(o),o.id}function zm(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let i=n(e,t);return!!i&&(r(t.update(i)),!0)}}const b$=zm(x$,0),D$=zm(Yx,0),_$=zm((n,e)=>Yx(n,e,function(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),i=t.to<=r.to?r:n.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=i.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return e}(e)),0);function qm(n,e){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}function Yx(n,e,t=e.selection.ranges){let r=t.map(s=>qm(e,s.from).block);if(!r.every(s=>s))return null;let i=t.map((s,o)=>function(n,{open:e,close:t},r,i){let c,d,s=n.sliceDoc(r-50,r),o=n.sliceDoc(i,i+50),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,u=s.length-a;if(s.slice(u-e.length,u)==e&&o.slice(l,l+t.length)==t)return{open:{pos:r-a,margin:a&&1},close:{pos:i+l,margin:l&&1}};i-r<=100?c=d=n.sliceDoc(r,i):(c=n.sliceDoc(r,r+50),d=n.sliceDoc(i-50,i));let g=/^\s*/.exec(c)[0].length,v=/\s*$/.exec(d)[0].length,C=d.length-v-t.length;return c.slice(g,g+e.length)==e&&d.slice(C,C+t.length)==t?{open:{pos:r+g+e.length,margin:/\s/.test(c.charAt(g+e.length))?1:0},close:{pos:i-v-t.length,margin:/\s/.test(d.charAt(C-1))?1:0}}:null}(e,r[o],s.from,s.to));if(2!=n&&!i.every(s=>s))return{changes:e.changes(t.map((s,o)=>i[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(1!=n&&i.some(s=>s)){let s=[];for(let a,o=0;o<i.length;o++)if(a=i[o]){let l=r[o],{open:u,close:c}=a;s.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function x$(n,e,t=e.selection.ranges){let r=[],i=-1;for(let{from:s,to:o}of t){let a=r.length,l=1e9,u=qm(e,s).line;if(u){for(let c=s;c<=o;){let d=e.doc.lineAt(c);if(d.from>i&&(s==o||o>d.from)){i=d.from;let g=/^\s*/.exec(d.text)[0].length,v=g==d.length,C=d.text.slice(g,g+u.length)==u?g:-1;g<d.text.length&&g<l&&(l=g),r.push({line:d,comment:C,token:u,indent:g,empty:v,single:!1})}c=d.to+1}if(l<1e9)for(let c=a;c<r.length;c++)r[c].indent<r[c].line.text.length&&(r[c].indent=l);r.length==a+1&&(r[a].single=!0)}}if(2!=n&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:u,empty:c,single:d}of r)(d||!c)&&s.push({from:a.from+u,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}if(1!=n&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of r)if(a>=0){let u=o.from+a,c=u+l.length;" "==o.text[c-o.from]&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const Km=Fi.define(),E$=Fi.define(),A$=Y.define(),Jx=Y.define({combine:n=>Li(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,i)=>e(r,i)||t(r,i)})}),Qm=Mn.define({create:()=>Zm.empty,update(n,e){let t=e.state.facet(Jx),r=e.annotation(Km);if(r){let l=Sn.fromTransaction(e,r.selection),u=r.side,c=0==u?n.undone:n.done;return c=l?bf(c,c.length,t.minDepth,l):Xx(c,e.startState.selection),new Zm(0==u?r.rest:c,0==u?c:r.rest)}let i=e.annotation(E$);if(("full"==i||"before"==i)&&(n=n.isolate()),!1===e.annotation(jr.addToHistory))return e.changes.empty?n:n.addMapping(e.changes.desc);let s=Sn.fromTransaction(e),o=e.annotation(jr.time),a=e.annotation(jr.userEvent);return s?n=n.addChanges(s,o,a,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,a,t.newGroupDelay)),("full"==i||"after"==i)&&(n=n.isolate()),n},toJSON:n=>({done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}),fromJSON:n=>new Zm(n.done.map(Sn.fromJSON),n.undone.map(Sn.fromJSON))});function k$(n={}){return[Qm,Jx.of(n),he.domEventHandlers({beforeinput(e,t){let r="historyUndo"==e.inputType?Ym:"historyRedo"==e.inputType?Cf:null;return!!r&&(e.preventDefault(),r(t))}})]}function wf(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let i=t.field(Qm,!1);if(!i)return!1;let s=i.pop(n,t,e);return!!s&&(r(s),!0)}}const Ym=wf(0,!1),Cf=wf(1,!1),T$=wf(0,!0),I$=wf(1,!0);class Sn{constructor(e,t,r,i,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new Sn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(r=this.startSelection)||void 0===r?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new Sn(e.changes&&Mt.fromJSON(e.changes),[],e.mapped&&Hr.fromJSON(e.mapped),e.startSelection&&V.fromJSON(e.startSelection),e.selectionsAfter.map(V.fromJSON))}static fromTransaction(e,t){let r=tr;for(let i of e.startState.facet(A$)){let s=i(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new Sn(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,tr)}static selection(e){return new Sn(void 0,tr,void 0,void 0,e)}}function bf(n,e,t,r){let s=n.slice(e+1>t+20?e-t-1:0,e);return s.push(r),s}function Zx(n,e){return n.length?e.length?n.concat(e):n:e}const tr=[];function Xx(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),bf(n,n.length-1,1e9,t.setSelAfter(r)))}return[Sn.selection([e])]}function R$(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Jm(n,e){if(!n.length)return n;let t=n.length,r=tr;for(;t;){let i=F$(n[t-1],e,r);if(i.changes&&!i.changes.empty||i.effects.length){let s=n.slice(0,t);return s[t-1]=i,s}e=i.mapped,t--,r=i.selectionsAfter}return r.length?[Sn.selection(r)]:tr}function F$(n,e,t){let r=Zx(n.selectionsAfter.length?n.selectionsAfter.map(a=>a.map(e)):tr,t);if(!n.changes)return Sn.selection(r);let i=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new Sn(i,st.mapEffects(n.effects,e),o,n.startSelection.map(s),r)}const L$=/^(input\.type|delete)($|\.)/;let Zm=(()=>{class n{constructor(t,r,i=0,s){this.done=t,this.undone=r,this.prevTime=i,this.prevUserEvent=s}isolate(){return this.prevTime?new n(this.done,this.undone):this}addChanges(t,r,i,s,o){let a=this.done,l=a[a.length-1];return a=l&&l.changes&&!l.changes.empty&&t.changes&&(!i||L$.test(i))&&(!l.selectionsAfter.length&&r-this.prevTime<s.newGroupDelay&&s.joinToEvent(o,function(n,e){let t=[],r=!1;return n.iterChangedRanges((i,s)=>t.push(i,s)),e.iterChangedRanges((i,s,o,a)=>{for(let l=0;l<t.length;){let u=t[l++],c=t[l++];a>=u&&o<=c&&(r=!0)}}),r}(l.changes,t.changes))||"input.type.compose"==i)?bf(a,a.length-1,s.minDepth,new Sn(t.changes.compose(l.changes),Zx(t.effects,l.effects),l.mapped,l.startSelection,tr)):bf(a,a.length,s.minDepth,t),new n(a,tr,r,i)}addSelection(t,r,i,s){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:tr;return o.length>0&&r-this.prevTime<s&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&function(n,e){return n.ranges.length==e.ranges.length&&0===n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length}(o[o.length-1],t)?this:new n(Xx(this.done,t),this.undone,r,i)}addMapping(t){return new n(Jm(this.done,t),Jm(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,r,i){let s=0==t?this.done:this.undone;if(0==s.length)return null;let o=s[s.length-1],a=o.selectionsAfter[0]||r.selection;if(i&&o.selectionsAfter.length)return r.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:Km.of({side:t,rest:R$(s),selection:a}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let l=1==s.length?tr:s.slice(0,s.length-1);return o.mapped&&(l=Jm(l,o.mapped)),r.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:Km.of({side:t,rest:l,selection:a}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}return null}}return n.empty=new n(tr,tr),n})();const V$=[{key:"Mod-z",run:Ym,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Cf,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Cf,preventDefault:!0},{key:"Mod-u",run:T$,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:I$,preventDefault:!0}];function zo(n,e){return V.create(n.ranges.map(e),n.mainIndex)}function Qr(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function nr({state:n,dispatch:e},t){let r=zo(n.selection,t);return!r.eq(n.selection,!0)&&(e(Qr(n,r)),!0)}function Hl(n,e){return V.cursor(e?n.to:n.from)}function Df(n,e){return nr(n,t=>t.empty?n.moveByChar(t,e):Hl(t,e))}function Xt(n){return n.textDirectionAt(n.state.selection.main.head)==$e.LTR}const Xm=n=>Df(n,!Xt(n)),eE=n=>Df(n,Xt(n));function _f(n,e){return nr(n,t=>t.empty?n.moveByGroup(t,e):Hl(t,e))}function $$(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function Mf(n,e,t){let o,a,r=Lt(n).resolveInner(e.head),i=t?ye.closedBy:ye.openedBy;for(let l=e.head;;){let u=t?r.childAfter(l):r.childBefore(l);if(!u)break;$$(n,u,i)?r=u:l=t?u.to:u.from}return a=r.type.prop(i)&&(o=t?er(n,r.from,1):er(n,r.to,-1))&&o.matched?t?o.end.to:o.end.from:t?r.to:r.from,V.cursor(a,t?-1:1)}function iE(n,e){return nr(n,t=>{if(!t.empty)return Hl(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}"undefined"!=typeof Intl&&Intl;const sE=n=>iE(n,!1),oE=n=>iE(n,!0);function aE(n){let i,e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0;if(e){for(let s of n.state.facet(he.scrollMargins)){let o=s(n);(null==o?void 0:o.top)&&(t=Math.max(null==o?void 0:o.top,t)),(null==o?void 0:o.bottom)&&(r=Math.max(null==o?void 0:o.bottom,r))}i=n.scrollDOM.clientHeight-t-r}else i=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,i-5)}}function lE(n,e){let s,t=aE(n),{state:r}=n,i=zo(r.selection,o=>o.empty?n.moveVertically(o,e,t.height):Hl(o,e));if(i.eq(r.selection))return!1;if(t.selfScroll){let o=n.coordsAtPos(r.selection.main.head),a=n.scrollDOM.getBoundingClientRect(),l=a.top+t.marginTop,u=a.bottom-t.marginBottom;o&&o.top>l&&o.bottom<u&&(s=he.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-l}))}return n.dispatch(Qr(r,i),{effects:s}),!0}const uE=n=>lE(n,!1),ey=n=>lE(n,!0);function Ji(n,e,t){let r=n.lineBlockAt(e.head),i=n.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?r.to:r.from)&&(i=n.moveToLineBoundary(e,t,!1)),!t&&i.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(i=V.cursor(r.from+s))}return i}const cE=n=>nr(n,e=>Ji(n,e,!0)),fE=n=>nr(n,e=>Ji(n,e,!1));function Vn(n,e){let t=zo(n.state.selection,r=>{let i=e(r);return V.range(r.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return!t.eq(n.state.selection)&&(n.dispatch(Qr(n.state,t)),!0)}function Sf(n,e){return Vn(n,t=>n.moveByChar(t,e))}const dE=n=>Sf(n,!Xt(n)),pE=n=>Sf(n,Xt(n));function xf(n,e){return Vn(n,t=>n.moveByGroup(t,e))}function mE(n,e){return Vn(n,t=>n.moveVertically(t,e))}const yE=n=>mE(n,!1),vE=n=>mE(n,!0);function wE(n,e){return Vn(n,t=>n.moveVertically(t,e,aE(n).height))}const CE=n=>wE(n,!1),bE=n=>wE(n,!0),DE=({state:n,dispatch:e})=>(e(Qr(n,{anchor:0})),!0),_E=({state:n,dispatch:e})=>(e(Qr(n,{anchor:n.doc.length})),!0),ME=({state:n,dispatch:e})=>(e(Qr(n,{anchor:n.selection.main.anchor,head:0})),!0),SE=({state:n,dispatch:e})=>(e(Qr(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0);function qo(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,i=r.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(s);l<o?(t="delete.backward",l=Ef(n,l,!1)):l>o&&(t="delete.forward",l=Ef(n,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=Ef(n,o,!1),a=Ef(n,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:V.cursor(o,o<s.head?-1:1)}});return!i.changes.empty&&(n.dispatch(r.update(i,{scrollIntoView:!0,userEvent:t,effects:"delete.selection"==t?he.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Ef(n,e,t){if(n instanceof he)for(let r of n.state.facet(he.atomicRanges).map(i=>i(n)))r.between(e,e,(i,s)=>{i<e&&s>e&&(e=t?s:i)});return e}const xE=(n,e)=>qo(n,t=>{let o,a,r=t.from,{state:i}=n,s=i.doc.lineAt(r);if(!e&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(o=s.text.slice(0,r-s.from))){if("\t"==o[o.length-1])return r-1;let u=hl(o,i.tabSize)%As(i)||As(i);for(let c=0;c<u&&" "==o[o.length-1-c];c++)r--;a=r}else a=Pt(s.text,r-s.from,e,e)+s.from,a==r&&s.number!=(e?i.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(a-s.from,r-s.from))&&(a=Pt(s.text,a-s.from,!1,!1)+s.from);return a}),ty=n=>xE(n,!1),EE=n=>xE(n,!0),AE=(n,e)=>qo(n,t=>{let r=t.head,{state:i}=n,s=i.doc.lineAt(r),o=i.charCategorizer(r);for(let a=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?i.doc.lines:1)&&(r+=e?1:-1);break}let l=Pt(s.text,r-s.from,e)+s.from,u=s.text.slice(Math.min(r,l)-s.from,Math.max(r,l)-s.from),c=o(u);if(null!=a&&c!=a)break;(" "!=u||r!=t.head)&&(a=c),r=l}return r}),kE=n=>AE(n,!1);function Af(n){let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:i.from,to:s.to,ranges:[r]});t=s.number+1}return e}function TE(n,e,t){if(n.readOnly)return!1;let r=[],i=[];for(let s of Af(n)){if(t?s.to==n.doc.length:0==s.from)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),a=o.length+1;if(t){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let l of s.ranges)i.push(V.range(Math.min(n.doc.length,l.anchor+a),Math.min(n.doc.length,l.head+a)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let l of s.ranges)i.push(V.range(l.anchor-a,l.head-a))}}return!!r.length&&(e(n.update({changes:r,scrollIntoView:!0,selection:V.create(i,n.selection.mainIndex),userEvent:"move.line"})),!0)}function IE(n,e,t){if(n.readOnly)return!1;let r=[];for(let i of Af(n))r.push(t?{from:i.from,insert:n.doc.slice(i.from,i.to)+n.lineBreak}:{from:i.to,insert:n.lineBreak+n.doc.slice(i.from,i.to)});return e(n.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const OE=NE(!1);function NE(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(i=>{let{from:s,to:o}=i,a=e.doc.lineAt(s),l=!n&&s==o&&function(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let s,t=Lt(n).resolveInner(e),r=t.childBefore(e),i=t.childAfter(e);return r&&i&&r.to<=e&&i.from>=e&&(s=r.type.prop(ye.closedBy))&&s.indexOf(i.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(i.from).from&&!/\S/.test(n.sliceDoc(r.to,i.from))?{from:r.to,to:i.from}:null}(e,s);n&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let u=new Nl(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=mf(u,s);for(null==c&&(c=hl(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?({from:s,to:o}=l):s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",Wo(e,c)];return l&&d.push(Wo(e,u.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:Oe.of(d)},range:V.cursor(s+1+d[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function ny(n,e){let t=-1;return n.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let a=n.doc.lineAt(o);a.number>t&&(r.empty||r.to>a.from)&&(e(a,i,r),t=a.number),o=a.to+1}let s=n.changes(i);return{changes:i,range:V.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const PE=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new Nl(n,{overrideIndentation:s=>{let o=t[s];return null==o?-1:o}}),i=ny(n,(s,o,a)=>{let l=mf(r,s.from);if(null==l)return;/\S/.test(s.text)||(l=0);let u=/^\s*/.exec(s.text)[0],c=Wo(n,l);(u!=c||a.from<s.from+u.length)&&(t[s.from]=l,o.push({from:s.from,to:s.from+u.length,insert:c}))});return i.changes.empty||e(n.update(i,{userEvent:"indent"})),!0},kf=({state:n,dispatch:e})=>!n.readOnly&&(e(n.update(ny(n,(t,r)=>{r.push({from:t.from,insert:n.facet(Ol)})}),{userEvent:"input.indent"})),!0),ry=({state:n,dispatch:e})=>!n.readOnly&&(e(n.update(ny(n,(t,r)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let s=hl(i,n.tabSize),o=0,a=Wo(n,Math.max(0,s-As(n)));for(;o<i.length&&o<a.length&&i.charCodeAt(o)==a.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+i.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),RE=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:n=>nr(n,e=>Mf(n.state,e,!Xt(n))),shift:n=>Vn(n,e=>Mf(n.state,e,!Xt(n)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:n=>nr(n,e=>Mf(n.state,e,Xt(n))),shift:n=>Vn(n,e=>Mf(n.state,e,Xt(n)))},{key:"Alt-ArrowUp",run:({state:n,dispatch:e})=>TE(n,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:n,dispatch:e})=>IE(n,e,!1)},{key:"Alt-ArrowDown",run:({state:n,dispatch:e})=>TE(n,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:n,dispatch:e})=>IE(n,e,!0)},{key:"Escape",run:({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=V.create([t.main]):t.main.empty||(r=V.create([V.cursor(t.main.head)])),!!r&&(e(Qr(n,r)),!0)}},{key:"Mod-Enter",run:NE(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:n,dispatch:e})=>{let t=Af(n).map(({from:r,to:i})=>V.range(r,Math.min(i+1,n.doc.length)));return e(n.update({selection:V.create(t),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:n,dispatch:e})=>{let t=zo(n.selection,r=>{var i;for(let o=Lt(n).resolveStack(r.from,1);o;o=o.next){let{node:a}=o;if((a.from<r.from&&a.to>=r.to||a.to>r.to&&a.from<=r.from)&&(null===(i=a.parent)||void 0===i?void 0:i.parent))return V.range(a.to,a.from)}return r});return e(Qr(n,t)),!0},preventDefault:!0},{key:"Mod-[",run:ry},{key:"Mod-]",run:kf},{key:"Mod-Alt-\\",run:PE},{key:"Shift-Mod-k",run:n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Af(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),r=zo(e.selection,i=>n.moveVertically(i,!0)).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:n,dispatch:e})=>function(n,e,t){let r=!1,i=zo(n.selection,s=>{let o=er(n,s.head,-1)||er(n,s.head,1)||s.head>0&&er(n,s.head-1,1)||s.head<n.doc.length&&er(n,s.head+1,-1);if(!o||!o.end)return s;r=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return t?V.range(s.anchor,a):V.cursor(a)});return!!r&&(e(Qr(n,i)),!0)}(n,e,!1)},{key:"Mod-/",run:n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=qm(n.state,t.from);return r.line?b$(n):!!r.block&&_$(n)}},{key:"Alt-A",run:D$}].concat([{key:"ArrowLeft",run:Xm,shift:dE,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:n=>_f(n,!Xt(n)),shift:n=>xf(n,!Xt(n)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:n=>nr(n,e=>Ji(n,e,!Xt(n))),shift:n=>Vn(n,e=>Ji(n,e,!Xt(n))),preventDefault:!0},{key:"ArrowRight",run:eE,shift:pE,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:n=>_f(n,Xt(n)),shift:n=>xf(n,Xt(n)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:n=>nr(n,e=>Ji(n,e,Xt(n))),shift:n=>Vn(n,e=>Ji(n,e,Xt(n))),preventDefault:!0},{key:"ArrowUp",run:sE,shift:yE,preventDefault:!0},{mac:"Cmd-ArrowUp",run:DE,shift:ME},{mac:"Ctrl-ArrowUp",run:uE,shift:CE},{key:"ArrowDown",run:oE,shift:vE,preventDefault:!0},{mac:"Cmd-ArrowDown",run:_E,shift:SE},{mac:"Ctrl-ArrowDown",run:ey,shift:bE},{key:"PageUp",run:uE,shift:CE},{key:"PageDown",run:ey,shift:bE},{key:"Home",run:fE,shift:n=>Vn(n,e=>Ji(n,e,!1)),preventDefault:!0},{key:"Mod-Home",run:DE,shift:ME},{key:"End",run:cE,shift:n=>Vn(n,e=>Ji(n,e,!0)),preventDefault:!0},{key:"Mod-End",run:_E,shift:SE},{key:"Enter",run:OE},{key:"Mod-a",run:({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:ty,shift:ty},{key:"Delete",run:EE},{key:"Mod-Backspace",mac:"Alt-Backspace",run:kE},{key:"Mod-Delete",mac:"Alt-Delete",run:n=>AE(n,!0)},{mac:"Mod-Backspace",run:n=>qo(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)})},{mac:"Mod-Delete",run:n=>qo(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)})}].concat([{key:"Ctrl-b",run:Xm,shift:dE,preventDefault:!0},{key:"Ctrl-f",run:eE,shift:pE},{key:"Ctrl-p",run:sE,shift:yE},{key:"Ctrl-n",run:oE,shift:vE},{key:"Ctrl-a",run:n=>nr(n,e=>V.cursor(n.lineBlockAt(e.head).from,1)),shift:n=>Vn(n,e=>V.cursor(n.lineBlockAt(e.head).from))},{key:"Ctrl-e",run:n=>nr(n,e=>V.cursor(n.lineBlockAt(e.head).to,-1)),shift:n=>Vn(n,e=>V.cursor(n.lineBlockAt(e.head).to))},{key:"Ctrl-d",run:EE},{key:"Ctrl-h",run:ty},{key:"Ctrl-k",run:n=>qo(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)})},{key:"Ctrl-Alt-h",run:kE},{key:"Ctrl-o",run:({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Oe.of(["",""])},range:V.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||0==r.from||r.from==n.doc.length)return{range:r};let i=r.from,s=n.doc.lineAt(i),o=i==s.from?i-1:Pt(s.text,i-s.from,!1)+s.from,a=i==s.to?i+1:Pt(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:n.doc.slice(i,a).append(n.doc.slice(o,i))},range:V.cursor(a)}});return!t.changes.empty&&(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:ey}].map(n=>({mac:n.key,run:n.run,shift:n.shift})))),FE={"scene-heading":/^((?:\*{0,3}_?)?(?:(?:int|ext|fade|est|i\/e)[. ]).+)|^(?:\.(?!\.+))(.+)/i,character:/^\s*[A-Z][A-Z0-9 \t]*(?:\(O\.S\.\)|\(V\.O\.\))?\s*$/,dialogue:/^\s*(\^?)?(?:\n(?!\n+))([\s\S]+)/,parenthetical:/^(\(.+\))$/,transition:/^(>[^<\n\r]*|[A-Z ]+ TO:)$/,synopsis:/^(?:\=(?!\=+) *)(.*)/},EU=jm.define({name:"fountains",startState:()=>({inDialogue:!1}),token:function(n,e){n.skipToEnd();for(const t in FE)if(FE[t].test(n.string))return"character"===t&&(e.inDialogue=!0),t;return e.inDialogue?"dialogue":"action"},blankLine:function(n,e){n.inDialogue=!1},tokenTable:{"scene-heading":$.className,synopsis:$.docComment,action:$.lineComment,character:$.propertyName,dialogue:$.string,parenthetical:$.comment,centered:$.heading2,page_break:$.heading2,transition:$.keyword}}),AU=Ll.define([{tag:$.lineComment,fontFamily:"Courier"},{tag:$.docComment,color:"#888",fontFamily:"Courier"},{tag:$.className,fontWeight:600,textDecoration:"underline",fontFamily:"Courier"},{tag:$.heading2,fontWeight:100,display:"block",textAlign:"center",fontFamily:"Courier"},{tag:$.keyword,fontWeight:600,display:"block",textAlign:"right",fontFamily:"Courier",textDecoration:"underline"},{tag:$.comment,fontStyle:"italic",display:"block",fontFamily:"Courier",textAlign:"center"},{tag:$.propertyName,display:"block",fontFamily:"Courier",textAlign:"center"},{tag:$.string,display:"block",textAlign:"left",fontFamily:"Courier",marginLeft:"14em",marginRight:"10em"}]),TU=(()=>[A8(),k$(),v8(),Px(e$,{fallback:!0}),lm.of([...RE,...V$])])(),VE="function"==typeof String.prototype.normalize?n=>n.normalize("NFKD"):n=>n;class Ko{constructor(e,t,r=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?a=>s(VE(a)):VE,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Io(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=(n=e)<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))),r=this.bufferStart+this.bufferPos;this.bufferPos+=xc(e);let i=this.normalize(t);for(let s=0,o=r;;s++){let a=i.charCodeAt(s),l=this.match(a,o,this.bufferPos+this.bufferStart);if(s==i.length-1){if(l)return this.value=l,this;break}o==r&&s<t.length&&t.charCodeAt(s)==a&&o++}}var n}match(e,t,r){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:r}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?i={from:t,to:r}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}"undefined"!=typeof Symbol&&(Ko.prototype[Symbol.iterator]=function(){return this});const BE={from:-1,to:-1,match:/.*/.exec("")},iy="gm"+(null==/x/.unicode?"":"u");class sy{constructor(e,t,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=BE,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new HE(e,t,r,i,s);this.re=new RegExp(t,iy+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=Tf(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,i=r+t[0].length;if(this.matchPos=Tf(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}const oy=new WeakMap;class Qo{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let i=oy.get(e);if(!i||i.from>=r||i.to<=t){let a=new Qo(t,e.sliceString(t,r));return oy.set(e,a),a}if(i.from==t&&i.to==r)return i;let{text:s,from:o}=i;return o>t&&(s=e.sliceString(t,o)+s,o=t),i.to<r&&(s+=e.sliceString(i.to,r)),oy.set(e,new Qo(o,s)),new Qo(t,s.slice(t-o,r-o))}}class HE{constructor(e,t,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=BE,this.matchPos=Tf(e,i),this.re=new RegExp(t,iy+((null==r?void 0:r.ignoreCase)?"i":"")),this.test=null==r?void 0:r.test,this.flat=Qo.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,i=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this.matchPos=Tf(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Qo.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function Tf(n,e){if(e>=n.length)return e;let r,t=n.lineAt(e);for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}"undefined"!=typeof Symbol&&(sy.prototype[Symbol.iterator]=HE.prototype[Symbol.iterator]=function(){return this});class ly{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(n){try{return new RegExp(n,iy),!0}catch(e){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>"n"==r?"\n":"r"==r?"\r":"t"==r?"\t":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new zU(this):new WU(this)}getCursor(e,t=0,r){let i=e.doc?e:vr.create({doc:e});return null==r&&(r=i.doc.length),this.regexp?Jo(this,i,t,r):Yo(this,i,t,r)}}class WE{constructor(e){this.spec=e}}function Yo(n,e,t,r){return new Ko(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:i=>i.toLowerCase(),n.wholeWord?function(n,e){return(t,r,i,s)=>((s>t||s+i.length<r)&&(s=Math.max(0,t-2),i=n.sliceString(s,Math.min(n.length,r+2))),!(e(Of(i,t-s))==gt.Word&&e(Nf(i,t-s))==gt.Word||e(Nf(i,r-s))==gt.Word&&e(Of(i,r-s))==gt.Word))}(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}class WU extends WE{constructor(e){super(e)}nextMatch(e,t,r){let i=Yo(this.spec,e,r,e.doc.length).nextOverlapping();return i.done&&(i=Yo(this.spec,e,0,t).nextOverlapping()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=r;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),o=Yo(this.spec,e,s,i),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==t)return null;i-=1e4}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=Yo(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=Yo(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function Jo(n,e,t,r){return new sy(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?GU(e.charCategorizer(e.selection.main.head)):void 0},t,r)}function Of(n,e){return n.slice(Pt(n,e,!1),e)}function Nf(n,e){return n.slice(e,Pt(n,e))}function GU(n){return(e,t,r)=>!r[0].length||(n(Of(r.input,r.index))!=gt.Word||n(Nf(r.input,r.index))!=gt.Word)&&(n(Nf(r.input,r.index+r[0].length))!=gt.Word||n(Of(r.input,r.index+r[0].length))!=gt.Word)}class zU extends WE{nextMatch(e,t,r){let i=Jo(this.spec,e,r,e.doc.length).next();return i.done&&(i=Jo(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=1;;i++){let s=Math.max(t,r-1e4*i),o=Jo(this.spec,e,s,r),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==t||a.from>s+10))return a;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,r)=>"$"==r?"$":"&"==r?e.match[0]:"0"!=r&&+r<e.match.length?e.match[r]:t)}matchAll(e,t){let r=Jo(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=Jo(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Zi=st.define();function t4(n){var e=n.Pos;function t(f,h,p){if(h.line===p.line&&h.ch>=p.ch-1){var y=f.getLine(h.line).charCodeAt(h.ch);55296<=y&&y<=55551&&(p.ch+=1)}return{start:h,end:p}}var r=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"g<Up>",type:"keyToKey",toKeys:"gk"},{keys:"g<Down>",type:"keyToKey",toKeys:"gj"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<Del>",type:"keyToKey",toKeys:"x"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"keyToKey",toKeys:"i",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"g$",type:"motion",motion:"moveToEndOfDisplayLine"},{keys:"g^",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"g0",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"gn",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!0}},{keys:"gN",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!1}},{keys:"gq",type:"operator",operator:"hardWrap"},{keys:"gw",type:"operator",operator:"hardWrap",operatorArgs:{keepCursor:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-u>",type:"operatorMotion",operator:"delete",motion:"moveToStartOfLine",context:"insert"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<register>",type:"action",action:"replayMacro"},{keys:"q<register>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<register>",type:"action",action:"setMark"},{keys:'"<register>',type:"action",action:"setRegister"},{keys:"<C-r><register>",type:"action",action:"insertRegister",context:"insert",isEdit:!0},{keys:"<C-o>",type:"action",action:"oneNormalCommand",context:"insert"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<register>",type:"motion",motion:"textObjectManipulation"},{keys:"i<register>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],i=r.length,s=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"omap",shortName:"om"},{name:"noremap",shortName:"no"},{name:"nnoremap",shortName:"nn"},{name:"vnoremap",shortName:"vn"},{name:"inoremap",shortName:"ino"},{name:"onoremap",shortName:"ono"},{name:"unmap"},{name:"mapclear",shortName:"mapc"},{name:"nmapclear",shortName:"nmapc"},{name:"vmapclear",shortName:"vmapc"},{name:"imapclear",shortName:"imapc"},{name:"omapclear",shortName:"omapc"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"startinsert",shortName:"start"},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"vglobal",shortName:"v"},{name:"delete",shortName:"d"},{name:"join",shortName:"j"},{name:"normal",shortName:"norm"},{name:"global",shortName:"g"}],o=uA("");function u(f){var h=f.state.vim;return h.onPasteFn||(h.onPasteFn=function(){h.insertMode||(f.setCursor(At(f.getCursor(),0,1)),ea.enterInsertMode(f,{},h))}),h.onPasteFn}var M,c=/[\d]/,d=[n.isWordChar,function(f){return f&&!n.isWordChar(f)&&!/\s/.test(f)}],g=[function(f){return/\S/.test(f)}],v=["<",">"],C=["-",'"',".",":","_","/","+"],D=/^\w$/;try{M=new RegExp("^[\\p{Lu}]$","u")}catch(f){M=/^[A-Z]$/}function x(f,h){return h>=f.firstLine()&&h<=f.lastLine()}function A(f){return/^[a-z]$/.test(f)}function N(f){return-1!="()[]{}".indexOf(f)}function L(f){return c.test(f)}function F(f){return M.test(f)}function H(f){return/^\s*$/.test(f)}function U(f){return-1!=".?!".indexOf(f)}function ie(f,h){for(var p=0;p<h.length;p++)if(h[p]==f)return!0;return!1}var re={};function ae(f,h,p,m,y){if(void 0===h&&!y)throw Error("defaultValue is required unless callback is provided");if(p||(p="string"),re[f]={type:p,defaultValue:h,callback:y},m)for(var w=0;w<m.length;w++)re[m[w]]=re[f];h&&le(f,h)}function le(f,h,p,m){var y=re[f],w=(m=m||{}).scope;if(!y)return new Error("Unknown option: "+f);if("boolean"==y.type){if(h&&!0!==h)return new Error("Invalid argument: "+f+"="+h);!1!==h&&(h=!0)}y.callback?("local"!==w&&y.callback(h,void 0),"global"!==w&&p&&y.callback(h,p)):("local"!==w&&(y.value="boolean"==y.type?!!h:h),"global"!==w&&p&&(p.state.vim.options[f]={value:h}))}function X(f,h,p){var m=re[f],y=(p=p||{}).scope;if(!m)return new Error("Unknown option: "+f);if(m.callback){let w=h&&m.callback(void 0,h);return"global"!==y&&void 0!==w?w:"local"!==y?m.callback():void 0}return("global"!==y&&h&&h.state.vim.options[f]||"local"!==y&&m||{}).value}ae("filetype",void 0,"string",["ft"],function(f,h){if(void 0!==h){if(void 0===f){let p=h.getOption("mode");return"null"==p?"":p}h.setOption("mode",""==f?"null":f)}}),ae("textwidth",80,"number",["tw"],function(f,h){if(void 0!==h){if(void 0===f)return h.getOption("textwidth");var m=Math.round(f);m>1&&h.setOption("textwidth",m)}});var G,ke=function(){var f=100,h=-1,p=0,m=0,y=new Array(f);function b(S,E){(h+=E)>p?h=p:h<m&&(h=m);var k=y[(f+h)%f];if(k&&!k.find()){var P,O=E>0?1:-1,I=S.getCursor();do{if((k=y[(f+(h+=O))%f])&&(P=k.find())&&!sr(I,P))break}while(h<p&&h>m)}return k}return{cachedCursor:void 0,add:function(S,E,k){var P=y[h%f];function I(R){var j=++h%f,te=y[j];te&&te.clear(),y[j]=S.setBookmark(R)}if(P){var T=P.find();T&&!sr(T,E)&&I(E)}else I(E);I(k),p=h,(m=h-f+1)<0&&(m=0)},find:function(S,E){var k=h,O=b(S,E);return h=k,O&&O.find()},move:b}},Ce=function(f){return f?{changes:f.changes,expectCursorActivityForChange:f.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};class Pe{constructor(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=Ce()}exitMacroRecordMode(){var h=G.macroModeState;h.onRecordingDone&&h.onRecordingDone(),h.onRecordingDone=void 0,h.isRecording=!1}enterMacroRecordMode(h,p){var m=G.registerController.getRegister(p);if(m){if(m.clear(),this.latestRegister=p,h.openDialog){var y=ts("span",{class:"cm-vim-message"},"recording @"+p);this.onRecordingDone=h.openDialog(y,null,{bottom:!0})}this.isRecording=!0}}}function Xe(f){return f.state.vim||(f.state.vim={inputState:new cA,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeReturn:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{},expectLiteralNext:!1}),f.state.vim}function tn(){for(var f in G={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:ke(),macroModeState:new Pe,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new L4({}),searchHistoryController:new fA,exCommandHistoryController:new fA},re){var h=re[f];h.value=h.defaultValue}}var It,We,Ie={enterVimMode:function(f){f.setOption("disableInput",!0),f.setOption("showCursorWhenSelecting",!1),n.signal(f,"vim-mode-change",{mode:"normal"}),f.on("cursorActivity",FA),Xe(f),n.on(f.getInputField(),"paste",u(f))},leaveVimMode:function(f){f.setOption("disableInput",!1),f.off("cursorActivity",FA),n.off(f.getInputField(),"paste",u(f)),f.state.vim=null,zl&&clearTimeout(zl)},buildKeyMap:function(){},getRegisterController:function(){return G.registerController},resetVimGlobalState_:tn,getVimGlobalState_:function(){return G},maybeInitVimState_:Xe,suppressErrorLogging:!1,InsertModeKey:_y,map:function(f,h,p){_r.map(f,h,p)},unmap:function(f,h){return _r.unmap(f,h)},noremap:function(f,h,p){_r.map(f,h,p,!0)},mapclear:function(f){var h=r.length,p=i,m=r.slice(0,h-p);if(r=r.slice(h-p),f)for(var y=m.length-1;y>=0;y--){var w=m[y];if(f!==w.context)if(w.context)this._mapCommand(w);else{var b=["normal","insert","visual"];for(var _ in b)if(b[_]!==f){var S=Object.assign({},w);S.context=b[_],this._mapCommand(S)}}}},langmap:lA,vimKeyFromEvent:Ul,setOption:le,getOption:X,defineOption:ae,defineEx:function(f,h,p){if(h){if(0!==f.indexOf(h))throw new Error('(Vim.defineEx) "'+h+'" is not a prefix of "'+f+'", command not registered')}else h=f;NA[f]=p,_r.commandMap_[h]={name:f,shortName:h,type:"api"}},handleKey:function(f,h,p){var m=this.findKey(f,h,p);if("function"==typeof m)return m()},multiSelectHandleKey:function(f,h,p){var m=Xe(f),y=f,w=!1,b=(m=Ie.maybeInitVimState_(y)).visualBlock||m.wasInVisualBlock,_=y.isInMultiSelectMode();if(m.wasInVisualBlock&&!_?m.wasInVisualBlock=!1:_&&m.visualBlock&&(m.wasInVisualBlock=!0),"<Esc>"!=h||m.insertMode||m.visualMode||!_||"<Esc>"!=m.status)if(b||!_||y.inVirtualSelectionMode)w=Ie.handleKey(y,h,p);else{var S=My(m),E=m.inputState.changeQueueList||[];y.operation(function(){var O;y.curOp&&(y.curOp.isVimOp=!0);var k=0;y.forEachSelection(function(){y.state.vim.inputState.changeQueue=E[k];var P=y.getCursor("head"),I=y.getCursor("anchor"),T=ft(P,I)?0:-1,R=ft(P,I)?-1:0;P=At(P,0,T),I=At(I,0,R),y.state.vim.sel.head=P,y.state.vim.sel.anchor=I,w=Ie.handleKey(y,h,p),y.virtualSelection&&(E[k]=y.state.vim.inputState.changeQueue,y.state.vim=My(S)),k++}),(null==(O=y.curOp)?void 0:O.cursorActivity)&&!w&&(y.curOp.cursorActivity=!1),y.state.vim=m,m.inputState.changeQueueList=E,m.inputState.changeQueue=null},!0)}else Vt(y);return w&&!m.visualMode&&!m.insert&&m.visualMode!=y.somethingSelected()&&LA(y,m),w},findKey:function(f,h,p){var E,m=Xe(f),y=f;function b(){if("<Esc>"==h){if(m.visualMode)ei(y);else{if(!m.insertMode)return;ns(y)}return Vt(y),!0}}return!1===(E=m.insertMode?function(){if(b())return!0;m.inputState.keyBuffer.push(h);var k=m.inputState.keyBuffer.join(""),O=1==h.length,P=Ts.matchCommand(k,r,m.inputState,"insert"),I=m.inputState.changeQueue;if("none"==P.type)return Vt(y),!1;if("partial"==P.type){if(P.expectLiteralNext&&(m.expectLiteralNext=!0),It&&window.clearTimeout(It),It=O&&window.setTimeout(function(){m.insertMode&&m.inputState.keyBuffer.length&&Vt(y)},X("insertModeEscKeysTimeout")),O){var T=y.listSelections();(!I||I.removed.length!=T.length)&&(I=m.inputState.changeQueue=new R4),I.inserted+=h;for(var R=0;R<T.length;R++){var j=jn(T[R].anchor,T[R].head),te=es(T[R].anchor,T[R].head),J=y.getRange(j,y.state.overwrite?At(te,0,1):te);I.removed[R]=(I.removed[R]||"")+J}}return!O}if(m.expectLiteralNext=!1,It&&window.clearTimeout(It),P.command&&I){for(T=y.listSelections(),R=0;R<T.length;R++){var oe=T[R].head;y.replaceRange(I.removed[R]||"",At(oe,0,-I.inserted.length),oe,"+input")}G.macroModeState.lastInsertModeChanges.changes.pop()}return P.command||Vt(y),P.command}():function(){if(function(){var k=G.macroModeState;if(k.isRecording){if("q"==h)return k.exitMacroRecordMode(),Vt(y),!0;"mapping"!=p&&function(f,h){if(!f.isPlaying){var m=G.registerController.getRegister(f.latestRegister);m&&m.pushText(h)}}(k,h)}}()||b())return!0;m.inputState.keyBuffer.push(h);var k=m.inputState.keyBuffer.join("");if(/^[1-9]\d*$/.test(k))return!0;var O=/^(\d*)(.*)$/.exec(k);if(!O)return Vt(y),!1;var P=m.visualMode?"visual":"normal",I=O[2]||O[1];m.inputState.operatorShortcut&&m.inputState.operatorShortcut.slice(-1)==I&&(I=m.inputState.operatorShortcut);var T=Ts.matchCommand(I,r,m.inputState,P);return"none"==T.type?(Vt(y),!1):"partial"==T.type?(T.expectLiteralNext&&(m.expectLiteralNext=!0),!0):"clear"==T.type?(Vt(y),!0):(m.expectLiteralNext=!1,m.inputState.keyBuffer.length=0,(O=/^(\d*)(.*)$/.exec(k))&&O[1]&&"0"!=O[1]&&m.inputState.pushRepeatDigit(O[1]),T.command)}())?m.insertMode||1!==h.length?void 0:function(){return!0}:!0===E?function(){return!0}:function(){return y.operation(function(){y.curOp.isVimOp=!0;try{"keyToKey"==E.type?Zr(y,E.toKeys,E):Ts.processCommand(y,m,E)}catch(k){throw y.state.vim=void 0,Xe(y),Ie.suppressErrorLogging||console.log(k),k}return!0})}},handleEx:function(f,h){_r.processCommand(f,h)},defineMotion:function(f,h){yi[f]=h},defineAction:function(f,h){ea[f]=h},defineOperator:function(f,h){my[f]=h},mapCommand:function(f,h,p,m,y){var w={keys:f,type:h};for(var b in w[h]=p,w[h+"Args"]=m,y)w[b]=y[b];PA(w)},_mapCommand:PA,defineRegister:function(f,h){var p=G.registerController.registers;if(!f||1!=f.length)throw Error("Register name must be 1 character");if(p[f])throw Error("Register already defined "+f);p[f]=h,C.push(f)},exitVisualMode:ei,exitInsertMode:ns},Et=[],nn=!1;function Xi(f){if("<"==f[0]){var h=f.toLowerCase().slice(1,-1),p=h.split("-");if("lt"==(h=p.pop()||""))f="<";else if("space"==h)f=" ";else if("cr"==h)f="\n";else if(Xo[h]){var m=We.value,y={key:Xo[h],target:{value:m,selectionEnd:m.length,selectionStart:m.length}};return We.onKeyDown&&We.onKeyDown(y,We.value,b),void(We&&We.onKeyUp&&We.onKeyUp(y,We.value,b))}}if("\n"==f){var w=We;We=null,w.onClose&&w.onClose(w.value)}else We.value=(We.value||"")+f;function b(_){"string"==typeof _?We.value=_:We=null}}function Zr(f,h,p){var m=nn;if(p){if(-1!=Et.indexOf(p))return;Et.push(p),nn=0!=p.noremap}try{for(var b,y=Xe(f),w=/<(?:[CSMA]-)*\w+>|./gi;b=w.exec(h);){var _=b[0],S=y.insertMode;if(We)Xi(_);else if(!Ie.handleKey(f,_,"mapping")&&S&&y.insertMode){if("<"==_[0]){var k=_.toLowerCase().slice(1,-1),O=k.split("-");if("lt"==(k=O.pop()||""))_="<";else if("space"==k)_=" ";else if("cr"==k)_="\n";else{if(Xo.hasOwnProperty(k)){HA(f,_=Xo[k]);continue}_=_[0],w.lastIndex=b.index+1}}f.replaceSelection(_)}}}finally{if(Et.pop(),nn=!!Et.length&&m,!Et.length&&We){var P=We;We=null,Wl(f,P)}}}var Zo={Return:"CR",Backspace:"BS",Delete:"Del",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"CR"," ":"Space"},P4={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1,AltGraph:1,Dead:1,Unidentified:1},Xo={};function Ul(f,h){var w,p=f.key;if(!P4[p]){p.length>1&&"n"==p[0]&&(p=p.replace("Numpad","")),p=Zo[p]||p;var m="";if(f.ctrlKey&&(m+="C-"),f.altKey&&(m+="A-"),f.metaKey&&(m+="M-"),n.isMac&&f.altKey&&!f.metaKey&&!f.ctrlKey&&(m=m.slice(2)),(m||p.length>1)&&f.shiftKey&&(m+="S-"),h&&!h.expectLiteralNext&&1==p.length)if(o.keymap&&p in o.keymap)(0!=o.remapCtrl||!m)&&(p=o.keymap[p]);else if(p.charCodeAt(0)>255){var y=(null==(w=f.code)?void 0:w.slice(-1))||"";f.shiftKey||(y=y.toLowerCase()),y&&(p=y)}return(m+=p).length>1&&(m="<"+m+">"),m}}function lA(f,h){o.string!==f&&(o=uA(f)),o.remapCtrl=h}function uA(f){let h={};if(!f)return{keymap:h,string:""};function p(m){return m.split(/\\?(.)/).filter(Boolean)}return f.split(/((?:[^\\,]|\\.)+),/).map(m=>{if(!m)return;const y=m.split(/((?:[^\\;]|\\.)+);/);if(3==y.length){const w=p(y[1]),b=p(y[2]);if(w.length!==b.length)return;for(let _=0;_<w.length;++_)h[w[_]]=b[_]}else if(1==y.length){const w=p(m);if(w.length%2!=0)return;for(let b=0;b<w.length;b+=2)h[w[b]]=w[b+1]}}),{keymap:h,string:f}}"Left|Right|Up|Down|End|Home".split("|").concat(Object.keys(Zo)).forEach(function(f){Xo[(Zo[f]||"").toLowerCase()]=Xo[f.toLowerCase()]=f}),ae("langmap",void 0,"string",["lmap"],function(f,h){if(void 0===f)return o.string;lA(f)});class cA{constructor(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null,this.changeQueue=null}pushRepeatDigit(h){this.operator?this.motionRepeat=this.motionRepeat.concat(h):this.prefixRepeat=this.prefixRepeat.concat(h)}getRepeat(){var h=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(h=1,this.prefixRepeat.length>0&&(h*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(h*=parseInt(this.motionRepeat.join(""),10))),h}}function Vt(f,h){f.state.vim.inputState=new cA,f.state.vim.expectLiteralNext=!1,n.signal(f,"vim-command-done",h)}function R4(){this.removed=[],this.inserted=""}class Xr{constructor(h,p,m){this.clear(),this.keyBuffer=[h||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!p,this.blockwise=!!m}setText(h,p,m){this.keyBuffer=[h||""],this.linewise=!!p,this.blockwise=!!m}pushText(h,p){p&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(h)}pushInsertModeChanges(h){this.insertModeChanges.push(Ce(h))}pushSearchQuery(h){this.searchQueries.push(h)}clear(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1}toString(){return this.keyBuffer.join("")}}class L4{constructor(h){this.registers=h,this.unnamedRegister=h['"']=new Xr,h["."]=new Xr,h[":"]=new Xr,h["/"]=new Xr,h["+"]=new Xr}pushText(h,p,m,y,w){if("_"!==h){y&&"\n"!==m.charAt(m.length-1)&&(m+="\n");var b=this.isValidRegister(h)?this.getRegister(h):null;if(!b){switch(p){case"yank":this.registers[0]=new Xr(m,y,w);break;case"delete":case"change":-1==m.indexOf("\n")?this.registers["-"]=new Xr(m,y):(this.shiftNumericRegisters_(),this.registers[1]=new Xr(m,y))}return void this.unnamedRegister.setText(m,y,w)}F(h)?b.pushText(m,y):b.setText(m,y,w),"+"===h&&navigator.clipboard.writeText(m),this.unnamedRegister.setText(b.toString(),y)}}getRegister(h){return this.isValidRegister(h)?(h=h.toLowerCase(),this.registers[h]||(this.registers[h]=new Xr),this.registers[h]):this.unnamedRegister}isValidRegister(h){return h&&(ie(h,C)||D.test(h))}shiftNumericRegisters_(){for(var h=9;h>=2;h--)this.registers[h]=this.getRegister(""+(h-1))}}class fA{constructor(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}nextMatch(h,p){var m=this.historyBuffer,y=p?-1:1;null===this.initialPrefix&&(this.initialPrefix=h);for(var w=this.iterator+y;p?w>=0:w<m.length;w+=y)for(var b=m[w],_=0;_<=b.length;_++)if(this.initialPrefix==b.substring(0,_))return this.iterator=w,b;return w>=m.length?(this.iterator=m.length,this.initialPrefix):w<0?h:void 0}pushInput(h){var p=this.historyBuffer.indexOf(h);p>-1&&this.historyBuffer.splice(p,1),h.length&&this.historyBuffer.push(h)}reset(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}}var Ts={matchCommand:function(f,h,p,m){var y=function(f,h,p,m){m.operator&&(p="operatorPending");for(var y,w=[],b=[],S=nn?h.length-i:0;S<h.length;S++){var E=h[S];"insert"==p&&"insert"!=E.context||E.context&&E.context!=p||m.operator&&"action"==E.type||!(y=$4(f,E.keys))||("partial"==y&&w.push(E),"full"==y&&b.push(E))}return{partial:w.length&&w,full:b.length&&b}}(f,h,m,p);if(!y.full&&!y.partial)return{type:"none"};if(!y.full&&y.partial)return{type:"partial",expectLiteralNext:1==y.partial.length&&"<character>"==y.partial[0].keys.slice(-11)};for(var w,b=0;b<y.full.length;b++)w||(w=y.full[b]);if("<character>"==w.keys.slice(-11)||"<register>"==w.keys.slice(-10)){var S=function(f){var h=/^.*(<[^>]+>)$/.exec(f),p=h?h[1]:f.slice(-1);if(p.length>1)switch(p){case"<CR>":case"<S-CR>":p="\n";break;case"<Space>":case"<S-Space>":p=" ";break;default:p=""}return p}(f);if(!S||S.length>1)return{type:"clear"};p.selectedCharacter=S}return{type:"full",command:w}},processCommand:function(f,h,p){switch(h.inputState.repeatOverride=p.repeatOverride,p.type){case"motion":this.processMotion(f,h,p);break;case"operator":this.processOperator(f,h,p);break;case"operatorMotion":this.processOperatorMotion(f,h,p);break;case"action":this.processAction(f,h,p);break;case"search":this.processSearch(f,h,p);break;case"ex":case"keyToEx":this.processEx(f,h,p)}},processMotion:function(f,h,p){h.inputState.motion=p.motion,h.inputState.motionArgs=Bf(p.motionArgs),this.evalInput(f,h)},processOperator:function(f,h,p){var m=h.inputState;if(m.operator){if(m.operator==p.operator)return m.motion="expandToLine",m.motionArgs={linewise:!0,repeat:1},void this.evalInput(f,h);Vt(f)}m.operator=p.operator,m.operatorArgs=Bf(p.operatorArgs),p.keys.length>1&&(m.operatorShortcut=p.keys),p.exitVisualBlock&&(h.visualBlock=!1,ta(f)),h.visualMode&&this.evalInput(f,h)},processOperatorMotion:function(f,h,p){var m=h.visualMode,y=Bf(p.operatorMotionArgs);y&&m&&y.visualLine&&(h.visualLine=!0),this.processOperator(f,h,p),m||this.processMotion(f,h,p)},processAction:function(f,h,p){var m=h.inputState,y=m.getRepeat(),w=!!y,b=Bf(p.actionArgs)||{repeat:1};m.selectedCharacter&&(b.selectedCharacter=m.selectedCharacter),p.operator&&this.processOperator(f,h,p),p.motion&&this.processMotion(f,h,p),(p.motion||p.operator)&&this.evalInput(f,h),b.repeat=y||1,b.repeatIsExplicit=w,b.registerName=m.registerName,Vt(f),h.lastMotion=null,p.isEdit&&this.recordLastEdit(h,m,p),ea[p.action](f,b,h)},processSearch:function(f,h,p){if(f.getSearchCursor){var m=p.searchArgs.forward,y=p.searchArgs.wholeWordOnly;Dr(f).setReversed(!m);var w=m?"/":"?",b=Dr(f).getQuery(),_=f.getScrollInfo();switch(p.searchArgs.querySrc){case"prompt":var P=G.macroModeState;P.isPlaying?S(P.replaySearchQueries.shift(),!0,!1):Wl(f,{onClose:function(R){f.scrollTo(_.left,_.top),S(R,!0,!0);var j=G.macroModeState;j.isRecording&&function(f,h){if(!f.isPlaying){var m=G.registerController.getRegister(f.latestRegister);m&&m.pushSearchQuery&&m.pushSearchQuery(h)}}(j,R)},prefix:w,desc:"(JavaScript regexp)",onKeyUp:function(R,j,te){var Le,rn,J=Ul(R);"<Up>"==J||"<Down>"==J?(Le=R.target?R.target.selectionEnd:0,te(j=G.searchHistoryController.nextMatch(j,"<Up>"==J)||""),Le&&R.target&&(R.target.selectionEnd=R.target.selectionStart=Math.min(Le,R.target.value.length))):J&&"<Left>"!=J&&"<Right>"!=J&&G.searchHistoryController.reset();try{rn=Gl(f,j,!0,!0)}catch(kt){}rn?f.scrollIntoView(IA(f,!m,rn),30):(by(f),f.scrollTo(_.left,_.top))},onKeyDown:function(R,j,te){var J=Ul(R);"<Esc>"==J||"<C-c>"==J||"<C-[>"==J||"<BS>"==J&&""==j?(G.searchHistoryController.pushInput(j),G.searchHistoryController.reset(),Gl(f,b),by(f),f.scrollTo(_.left,_.top),n.e_stop(R),Vt(f),te(),f.focus()):"<Up>"==J||"<Down>"==J?n.e_stop(R):"<C-u>"==J&&(n.e_stop(R),te(""))}});break;case"wordUnderCursor":var I=wy(f,{noSymbol:!0}),T=!0;if(I||(I=wy(f,{noSymbol:!1}),T=!1),!I)return Fe(f,"No word under cursor"),void Vt(f);let R=f.getLine(I.start.line).substring(I.start.ch,I.end.ch);R=T&&y?"\\b"+R+"\\b":function(f){return f.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}(R),G.jumpList.cachedCursor=f.getCursor(),f.setCursor(I.start),S(R,!0,!1)}}function S(R,j,te){G.searchHistoryController.pushInput(R),G.searchHistoryController.reset();try{Gl(f,R,j,te)}catch(J){return Fe(f,"Invalid regex: "+R),void Vt(f)}Ts.processMotion(f,h,{keys:"",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:p.searchArgs.toJumplist}})}},processEx:function(f,h,p){function m(w){G.exCommandHistoryController.pushInput(w),G.exCommandHistoryController.reset(),_r.processCommand(f,w),f.state.vim&&Vt(f)}function y(w,b,_){var k,S=Ul(w);("<Esc>"==S||"<C-c>"==S||"<C-[>"==S||"<BS>"==S&&""==b)&&(G.exCommandHistoryController.pushInput(b),G.exCommandHistoryController.reset(),n.e_stop(w),Vt(f),_(),f.focus()),"<Up>"==S||"<Down>"==S?(n.e_stop(w),k=w.target?w.target.selectionEnd:0,_(b=G.exCommandHistoryController.nextMatch(b,"<Up>"==S)||""),k&&w.target&&(w.target.selectionEnd=w.target.selectionStart=Math.min(k,w.target.value.length))):"<C-u>"==S?(n.e_stop(w),_("")):S&&"<Left>"!=S&&"<Right>"!=S&&G.exCommandHistoryController.reset()}"keyToEx"==p.type?_r.processCommand(f,p.exArgs.input):Wl(f,h.visualMode?{onClose:m,prefix:":",value:"'<,'>",onKeyDown:y,selectValueOnOpen:!1}:{onClose:m,prefix:":",onKeyDown:y})},evalInput:function(f,h){var I,T,R,p=h.inputState,m=p.motion,y=p.motionArgs||{repeat:1},w=p.operator,b=p.operatorArgs||{},_=p.registerName,S=h.sel,E=Je(h.visualMode?vn(f,S.head):f.getCursor("head")),k=Je(h.visualMode?vn(f,S.anchor):f.getCursor("anchor")),O=Je(E),P=Je(k);if(w&&this.recordLastEdit(h,p),(R=void 0!==p.repeatOverride?p.repeatOverride:p.getRepeat())>0&&y.explicitRepeat?y.repeatIsExplicit=!0:(y.noRepeat||!y.explicitRepeat&&0===R)&&(R=1,y.repeatIsExplicit=!1),p.selectedCharacter&&(y.selectedCharacter=b.selectedCharacter=p.selectedCharacter),y.repeat=R,Vt(f),m){var j=yi[m](f,E,y,h,p);if(h.lastMotion=yi[m],!j)return;if(y.toJumplist){var te=G.jumpList,J=te.cachedCursor;J?(vA(f,J,j),delete te.cachedCursor):vA(f,E,j)}j instanceof Array?(T=j[0],I=j[1]):I=j,I||(I=Je(E)),h.visualMode?(h.visualBlock&&I.ch===1/0||(I=vn(f,I,O)),T&&(T=vn(f,T)),S.anchor=T=T||P,S.head=I,ta(f),vi(f,h,"<",ft(T,I)?T:I),vi(f,h,">",ft(T,I)?I:T)):w||(I=vn(f,I,O),f.setCursor(I.line,I.ch))}if(w){if(b.lastSel){T=P;var oe=b.lastSel,Le=Math.abs(oe.head.line-oe.anchor.line),rn=Math.abs(oe.head.ch-oe.anchor.ch);I=oe.visualLine?new e(P.line+Le,P.ch):oe.visualBlock?new e(P.line+Le,P.ch+rn):oe.head.line==oe.anchor.line?new e(P.line,P.ch+rn):new e(P.line+Le,P.ch),h.visualMode=!0,h.visualLine=oe.visualLine,h.visualBlock=oe.visualBlock,S=h.sel={anchor:T,head:I},ta(f)}else h.visualMode&&(b.lastSel={anchor:Je(S.anchor),head:Je(S.head),visualBlock:h.visualBlock,visualLine:h.visualLine});var kt,Ht,Se,Te,wn;if(h.visualMode){if(kt=jn(S.head,S.anchor),Ht=es(S.head,S.anchor),Se=h.visualLine||b.linewise,Te=h.visualBlock?"block":Se?"line":"char",wn=vy(f,{anchor:(jt=t(f,kt,Ht)).start,head:jt.end},Te),Se){var Ot=wn.ranges;if("block"==Te)for(var ni=0;ni<Ot.length;ni++)Ot[ni].head.ch=Bt(f,Ot[ni].head.line);else"line"==Te&&(Ot[0].head=new e(Ot[0].head.line+1,0))}}else{if(kt=Je(T||P),ft(Ht=Je(I||O),kt)){var Sy=kt;kt=Ht,Ht=Sy}(Se=y.linewise||b.linewise)?function(f,h,p){h.ch=0,p.ch=0,p.line++}(0,kt,Ht):y.forward&&function(f,h,p){var m=f.getRange(h,p);if(/\n\s*$/.test(m)){var y=m.split("\n");y.pop();for(var w=y.pop();y.length>0&&w&&H(w);w=y.pop())p.line--,p.ch=0;w?(p.line--,p.ch=Bt(f,p.line)):p.ch=0}}(f,kt,Ht),Te="char";var jt,xW=!y.inclusive||Se;wn=vy(f,{anchor:(jt=t(f,kt,Ht)).start,head:jt.end},Te,xW)}f.setSelections(wn.ranges,wn.primary),h.lastMotion=null,b.repeat=R,b.registerName=_,b.linewise=Se;var xy=my[w](f,b,wn.ranges,P,I);h.visualMode&&ei(f,null!=xy),xy&&f.setCursor(xy)}},recordLastEdit:function(f,h,p){var m=G.macroModeState;m.isPlaying||(f.lastEditInputState=h,f.lastEditActionCommand=p,m.lastInsertModeChanges.changes=[],m.lastInsertModeChanges.expectCursorActivityForChange=!1,m.lastInsertModeChanges.visualBlock=f.visualBlock?f.sel.head.line-f.sel.anchor.line:0)}},yi={moveToTopLine:function(f,h,p){var m=Dy(f).top+p.repeat-1;return new e(m,ti(f.getLine(m)))},moveToMiddleLine:function(f){var h=Dy(f),p=Math.floor(.5*(h.top+h.bottom));return new e(p,ti(f.getLine(p)))},moveToBottomLine:function(f,h,p){var m=Dy(f).bottom-p.repeat+1;return new e(m,ti(f.getLine(m)))},expandToLine:function(f,h,p){return new e(h.line+p.repeat-1,1/0)},findNext:function(f,h,p){var m=Dr(f),y=m.getQuery();if(y){var w=!p.forward;return w=m.isReversed()?!w:w,TA(f,y),IA(f,w,y,p.repeat)}},findAndSelectNextInclusive:function(f,h,p,m,y){var w=Dr(f),b=w.getQuery();if(b){var _=!p.forward,S=function(f,h,p,m,y){return f.operation(function(){void 0===m&&(m=1);var w=f.getCursor(),b=f.getSearchCursor(p,w),_=b.find(!h);!y.visualMode&&_&&sr(b.from(),w)&&b.find(!h);for(var S=0;S<m;S++)if(!(_=b.find(h))&&!(b=f.getSearchCursor(p,h?new e(f.lastLine()):new e(f.firstLine(),0))).find(h))return;return[b.from(),b.to()]})}(f,_=w.isReversed()?!_:_,b,p.repeat,m);if(S){if(y.operator)return S;var E=S[0],k=new e(S[1].line,S[1].ch-1);if(m.visualMode){(m.visualLine||m.visualBlock)&&(m.visualLine=!1,m.visualBlock=!1,n.signal(f,"vim-mode-change",{mode:"visual",subMode:""}));var O=m.sel.anchor;if(O)return w.isReversed()?p.forward?[O,E]:[O,k]:p.forward?[O,k]:[O,E]}else m.visualMode=!0,m.visualLine=!1,m.visualBlock=!1,n.signal(f,"vim-mode-change",{mode:"visual",subMode:""});return _?[k,E]:[E,k]}}},goToMark:function(f,h,p,m){var y=Hf(f,m,p.selectedCharacter||"");return y?p.linewise?{line:y.line,ch:ti(f.getLine(y.line))}:y:null},moveToOtherHighlightedEnd:function(f,h,p,m){if(m.visualBlock&&p.sameLine){var y=m.sel;return[vn(f,new e(y.anchor.line,y.head.ch)),vn(f,new e(y.head.line,y.anchor.ch))]}return[m.sel.head,m.sel.anchor]},jumpToMark:function(f,h,p,m){for(var y=h,w=0;w<p.repeat;w++){var b=y;for(var _ in m.marks)if(A(_)){var S=m.marks[_].find();if(!((p.forward?ft(S,b):ft(b,S))||p.linewise&&S.line==b.line)){var k=sr(b,y),O=p.forward?pA(b,S,y):pA(y,S,b);(k||O)&&(y=S)}}}return p.linewise&&(y=new e(y.line,ti(f.getLine(y.line)))),y},moveByCharacters:function(f,h,p){var y=p.repeat;return new e(h.line,p.forward?h.ch+y:h.ch-y)},moveByLines:function(f,h,p,m){var y=h,w=y.ch;switch(m.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:w=m.lastHPos;break;default:m.lastHPos=w}var b=p.repeat+(p.repeatOffset||0),_=p.forward?y.line+b:y.line-b,S=f.firstLine(),E=f.lastLine(),k=f.findPosV(y,p.forward?b:-b,"line",m.lastHSPos);return(p.forward?k.line>_:k.line<_)&&(_=k.line,w=k.ch),_<S&&y.line==S?this.moveToStartOfLine(f,h,p,m):_>E&&y.line==E?DA(f,h,p,m,!0):(p.toFirstChar&&(w=ti(f.getLine(_)),m.lastHPos=w),m.lastHSPos=f.charCoords(new e(_,w),"div").left,new e(_,w))},moveByDisplayLines:function(f,h,p,m){var y=h;switch(m.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:m.lastHSPos=f.charCoords(y,"div").left}var w=p.repeat,b=f.findPosV(y,p.forward?w:-w,"line",m.lastHSPos);if(b.hitSide)if(p.forward){var _=f.charCoords(b,"div");b=f.coordsChar({top:_.top+8,left:m.lastHSPos},"div")}else{var E=f.charCoords(new e(f.firstLine(),0),"div");E.left=m.lastHSPos,b=f.coordsChar(E,"div")}return m.lastHPos=b.ch,b},moveByPage:function(f,h,p){var y=p.repeat;return f.findPosV(h,p.forward?y:-y,"page")},moveByParagraph:function(f,h,p){return _A(f,h,p.repeat,p.forward?1:-1).start},moveBySentence:function(f,h,p){return function(f,h,p,m){function y(S,E){if(E.pos+E.dir<0||E.pos+E.dir>=E.line.length){if(E.ln+=E.dir,!x(S,E.ln))return E.line=null,E.ln=null,void(E.pos=null);E.line=S.getLine(E.ln),E.pos=E.dir>0?0:E.line.length-1}else E.pos+=E.dir}function w(S,E,k,O){var I=""===(P=S.getLine(E)),T={line:P,ln:E,pos:k,dir:O},R={ln:T.ln,pos:T.pos},j=""===T.line;for(y(S,T);null!==T.line;){if(R.ln=T.ln,R.pos=T.pos,""===T.line&&!j)return{ln:T.ln,pos:T.pos};if(I&&""!==T.line&&!H(T.line[T.pos]))return{ln:T.ln,pos:T.pos};U(T.line[T.pos])&&!I&&(T.pos===T.line.length-1||H(T.line[T.pos+1]))&&(I=!0),y(S,T)}var P=S.getLine(R.ln);R.pos=0;for(var te=P.length-1;te>=0;--te)if(!H(P[te])){R.pos=te;break}return R}function b(S,E,k,O){var I={line:S.getLine(E),ln:E,pos:k,dir:O},T={ln:I.ln,pos:null},R=""===I.line;for(y(S,I);null!==I.line;){if(""===I.line&&!R)return null!==T.pos?T:{ln:I.ln,pos:I.pos};if(U(I.line[I.pos])&&null!==T.pos&&(I.ln!==T.ln||I.pos+1!==T.pos))return T;""!==I.line&&!H(I.line[I.pos])&&(R=!1,T={ln:I.ln,pos:I.pos}),y(S,I)}var P=S.getLine(T.ln);T.pos=0;for(var j=0;j<P.length;++j)if(!H(P[j])){T.pos=j;break}return T}for(var _={ln:h.line,pos:h.ch};p>0;)_=m<0?b(f,_.ln,_.pos,m):w(f,_.ln,_.pos,m),p--;return new e(_.ln,_.pos)}(f,h,p.repeat,p.forward?1:-1)},moveByScroll:function(f,h,p,m){var w,y=f.getScrollInfo(),b=p.repeat;b||(b=y.clientHeight/(2*f.defaultTextHeight()));var _=f.charCoords(h,"local");if(p.repeat=b,!(w=yi.moveByDisplayLines(f,h,p,m)))return null;var S=f.charCoords(w,"local");return f.scrollTo(null,y.top+S.top-_.top),w},moveByWords:function(f,h,p){return function(f,h,p,m,y,w){var b=Je(h),_=[];(m&&!y||!m&&y)&&p++;for(var S=!(m&&y),E=0;E<p;E++){var k=bA(f,h,m,w,S);if(!k){var O=Bt(f,f.lastLine());_.push(m?{line:f.lastLine(),from:O,to:O}:{line:0,from:0,to:0});break}_.push(k),h=new e(k.line,m?k.to-1:k.from)}var P=_.length!=p,I=_[0],T=_.pop();return m&&!y?(!P&&(I.from!=b.ch||I.line!=b.line)&&(T=_.pop()),T&&new e(T.line,T.from)):m&&y?T&&new e(T.line,T.to-1):!m&&y?(!P&&(I.to!=b.ch||I.line!=b.line)&&(T=_.pop()),T&&new e(T.line,T.to)):T&&new e(T.line,T.from)}(f,h,p.repeat,!!p.forward,!!p.wordEnd,!!p.bigWord)},moveTillCharacter:function(f,h,p){var y=Cy(f,p.repeat,p.forward,p.selectedCharacter,h),w=p.forward?-1:1;return wA(w,p),y?(y.ch+=w,y):null},moveToCharacter:function(f,h,p){var m=p.repeat;return wA(0,p),Cy(f,m,p.forward,p.selectedCharacter,h)||h},moveToSymbol:function(f,h,p){return p.selectedCharacter&&function(f,h,p,m){var y=Je(f.getCursor()),w=p?1:-1,b=p?f.lineCount():-1,_=y.ch,S=y.line,E=f.getLine(S),k={lineText:E,nextCh:E.charAt(_),lastCh:null,index:_,symb:m,reverseSymb:(p?{")":"(","}":"{"}:{"(":")","{":"}"})[m],forward:p,depth:0,curMoveThrough:!1},O=X4[m];if(!O)return y;var P=CA[O].init,I=CA[O].isComplete;for(P&&P(k);S!==b&&h;){if(k.index+=w,k.nextCh=k.lineText.charAt(k.index),!k.nextCh){if(k.lineText=f.getLine(S+=w)||"",w>0)k.index=0;else{var T=k.lineText.length;k.index=T>0?T-1:0}k.nextCh=k.lineText.charAt(k.index)}I(k)&&(y.line=S,y.ch=k.index,h--)}return k.nextCh||k.curMoveThrough?new e(S,k.index):y}(f,p.repeat,p.forward,p.selectedCharacter)||h},moveToColumn:function(f,h,p,m){var y=p.repeat;return m.lastHPos=y-1,m.lastHSPos=f.charCoords(h,"div").left,function(f,h){var p=f.getCursor().line;return vn(f,new e(p,h-1))}(f,y)},moveToEol:function(f,h,p,m){return DA(f,h,p,m,!1)},moveToFirstNonWhiteSpaceCharacter:function(f,h){return new e(h.line,ti(f.getLine(h.line)))},moveToMatchedSymbol:function(f,h){for(var b,p=h,m=p.line,y=p.ch,w=f.getLine(m);y<w.length;y++)if((b=w.charAt(y))&&N(b)){var _=f.getTokenTypeAt(new e(m,y+1));if("string"!==_&&"comment"!==_)break}if(y<w.length){var S="<"===b||">"===b?/[(){}[\]<>]/:/[(){}[\]]/;return f.findMatchingBracket(new e(m,y),{bracketRegex:S}).to}return p},moveToStartOfLine:function(f,h){return new e(h.line,0)},moveToLineOrEdgeOfDocument:function(f,h,p){var m=p.forward?f.lastLine():f.firstLine();return p.repeatIsExplicit&&(m=p.repeat-f.getOption("firstLineNumber")),new e(m,ti(f.getLine(m)))},moveToStartOfDisplayLine:function(f){return f.execCommand("goLineLeft"),f.getCursor()},moveToEndOfDisplayLine:function(f){f.execCommand("goLineRight");var h=f.getCursor();return"before"==h.sticky&&h.ch--,h},textObjectManipulation:function(f,h,p,m){var b=p.selectedCharacter||"";"b"==b?b="(":"B"==b&&(b="{");var S,E,_=!p.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"}[b]){if(E=!0,!(S=SA(f,h,b,_))){var k=f.getSearchCursor(new RegExp("\\"+b,"g"),h);k.find()&&(S=SA(f,k.from(),b,_))}}else if({"'":!0,'"':!0,"`":!0}[b])E=!0,S=function(f,h,p,m){var _,S,E,k,y=Je(h),b=f.getLine(y.line).split(""),O=b.indexOf(p);if(y.ch<O)y.ch=O;else if(O<y.ch&&b[y.ch]==p){var P=/string/.test(f.getTokenTypeAt(At(h,0,1))),I=/string/.test(f.getTokenTypeAt(h));P&&!I||(S=y.ch,--y.ch)}if(b[y.ch]!=p||S)for(E=y.ch;E>-1&&!_;E--)b[E]==p&&(_=E+1);else _=y.ch+1;if(_&&!S)for(E=_,k=b.length;E<k&&!S;E++)b[E]==p&&(S=E);return _&&S?(m&&(--_,++S),{start:new e(y.line,_),end:new e(y.line,S)}):{start:y,end:y}}(f,h,b,_);else if("W"===b||"w"===b)for(var O=p.repeat||1;O-- >0;){var P=wy(f,{inclusive:_,innerWord:!_,bigWord:"W"===b,noSymbol:"W"===b,multiline:!0},S&&S.end);P&&(S||(S=P),S.end=P.end)}else if("p"===b)if(S=_A(f,h,p.repeat,0,_),p.linewise=!0,m.visualMode)m.visualLine||(m.visualLine=!0);else{var I=m.inputState.operatorArgs;I&&(I.linewise=!0),S.end.line--}else if("t"===b)S=function(f,h,p){var m=h;if(!n.findMatchingTag||!n.findEnclosingTag)return{start:m,end:m};var y=n.findMatchingTag(f,h)||n.findEnclosingTag(f,h);return y&&y.open&&y.close?p?{start:y.open.from,end:y.close.to}:{start:y.open.to,end:y.close.from}:{start:m,end:m}}(f,h,_);else if("s"===b){var T=f.getLine(h.line);h.ch>0&&U(T[h.ch])&&(h.ch-=1);var R=MA(f,h,p.repeat,1,_),j=MA(f,h,p.repeat,-1,_);H(f.getLine(j.line)[j.ch])&&H(f.getLine(R.line)[R.ch-1])&&(j={line:j.line,ch:j.ch+1}),S={start:j,end:R}}return S?f.state.vim.visualMode?function(f,h,p,m){var _,y=f.state.vim.sel,w=m?h:y.head,b=m?h:y.anchor;return ft(p,h)&&(_=p,p=h,h=_),ft(w,b)?(w=jn(h,w),b=es(b,p)):(b=jn(h,b),-1==(w=At(w=es(w,p),0,-1)).ch&&w.line!=f.firstLine()&&(w=new e(w.line-1,Bt(f,w.line-1)))),[b,w]}(f,S.start,S.end,E):[S.start,S.end]:null},repeatLastCharacterSearch:function(f,h,p){var m=G.lastCharacterSearch,y=p.repeat,w=p.forward===m.forward,b=(m.increment?1:0)*(w?-1:1);f.moveH(-b,"char"),p.inclusive=!!w;var _=Cy(f,y,w,m.selectedCharacter);return _?(_.ch+=b,_):(f.moveH(b,"char"),h)}};function hA(f,h){for(var p=[],m=0;m<h;m++)p.push(f);return p}var my={change:function(f,h,p){var m,y,w=f.state.vim,b=p[0].anchor,_=p[0].head;if(w.visualMode)if(h.fullLine)_.ch=Number.MAX_VALUE,_.line--,f.setSelection(b,_),y=f.getSelection(),f.replaceSelection(""),m=b;else{y=f.getSelection();var k=hA("",p.length);f.replaceSelections(k),m=jn(p[0].head,p[0].anchor)}else{y=f.getRange(b,_);var S=w.lastEditInputState;if("moveByWords"==(null==S?void 0:S.motion)&&!H(y)){var E=/\s+$/.exec(y);E&&S.motionArgs&&S.motionArgs.forward&&(_=At(_,0,-E[0].length),y=y.slice(0,-E[0].length))}h.linewise&&(b=new e(b.line,ti(f.getLine(b.line))),_.line>b.line&&(_=new e(_.line-1,Number.MAX_VALUE))),f.replaceRange("",b,_),m=b}G.registerController.pushText(h.registerName,"change",y,h.linewise,p.length>1),ea.enterInsertMode(f,{head:m},f.state.vim)},delete:function(f,h,p){var m,y,w=f.state.vim;if(w.visualBlock){y=f.getSelection();var S=hA("",p.length);f.replaceSelections(S),m=jn(p[0].head,p[0].anchor)}else{var b=p[0].anchor,_=p[0].head;h.linewise&&_.line!=f.firstLine()&&b.line==f.lastLine()&&b.line==_.line-1&&(b.line==f.firstLine()?b.ch=0:b=new e(b.line-1,Bt(f,b.line-1))),y=f.getRange(b,_),f.replaceRange("",b,_),m=b,h.linewise&&(m=yi.moveToFirstNonWhiteSpaceCharacter(f,b))}return G.registerController.pushText(h.registerName,"delete",y,h.linewise,w.visualBlock),vn(f,m)},indent:function(f,h,p){var m=f.state.vim,y=m.visualMode?h.repeat||0:1;if(f.indentMore)for(var w=0;w<y;w++)h.indentRight?f.indentMore():f.indentLess();else{var _=m.visualBlock?p[p.length-1].anchor.line:p[0].head.line;h.linewise&&_--;for(var S=p[0].anchor.line;S<=_;S++)for(w=0;w<y;w++)f.indentLine(S,h.indentRight)}return yi.moveToFirstNonWhiteSpaceCharacter(f,p[0].anchor)},indentAuto:function(f,h,p){return f.execCommand("indentAuto"),yi.moveToFirstNonWhiteSpaceCharacter(f,p[0].anchor)},hardWrap:function(f,h,p,m){if(f.hardWrap){var y=p[0].anchor.line,w=p[0].head.line;h.linewise&&w--;var b=f.hardWrap({from:y,to:w});return b>y&&h.linewise&&b--,h.keepCursor?m:new e(b,0)}},changeCase:function(f,h,p,m,y){for(var w=f.getSelections(),b=[],_=h.toLower,S=0;S<w.length;S++){var E=w[S],k="";if(!0===_)k=E.toLowerCase();else if(!1===_)k=E.toUpperCase();else for(var O=0;O<E.length;O++){var P=E.charAt(O);k+=F(P)?P.toLowerCase():P.toUpperCase()}b.push(k)}return f.replaceSelections(b),h.shouldMoveCursor?y:!f.state.vim.visualMode&&h.linewise&&p[0].anchor.line+1==p[0].head.line?yi.moveToFirstNonWhiteSpaceCharacter(f,m):h.linewise?m:jn(p[0].anchor,p[0].head)},yank:function(f,h,p,m){var y=f.state.vim,w=f.getSelection(),b=y.visualMode?jn(y.sel.anchor,y.sel.head,p[0].head,p[0].anchor):m;return G.registerController.pushText(h.registerName,"yank",w,h.linewise,y.visualBlock),b}},ea={jumpListWalk:function(f,h,p){if(!p.visualMode){var m=h.repeat||1,b=G.jumpList.move(f,h.forward?m:-m),_=b?b.find():void 0;_=_||f.getCursor(),f.setCursor(_)}},scroll:function(f,h,p){if(!p.visualMode){var m=h.repeat||1,y=f.defaultTextHeight(),w=f.getScrollInfo().top,b=y*m,_=h.forward?w+b:w-b,S=Je(f.getCursor()),E=f.charCoords(S,"local");if(h.forward)_>E.top?(S.line+=(_-E.top)/y,S.line=Math.ceil(S.line),f.setCursor(S),E=f.charCoords(S,"local"),f.scrollTo(null,E.top)):f.scrollTo(null,_);else{var k=_+f.getScrollInfo().clientHeight;k<E.bottom?(S.line-=(E.bottom-k)/y,S.line=Math.floor(S.line),f.setCursor(S),E=f.charCoords(S,"local"),f.scrollTo(null,E.bottom-f.getScrollInfo().clientHeight)):f.scrollTo(null,_)}}},scrollToCursor:function(f,h){var p=f.getCursor().line,m=f.charCoords(new e(p,0),"local"),y=f.getScrollInfo().clientHeight,w=m.top;switch(h.position){case"center":w=m.bottom-y/2;break;case"bottom":var b=new e(p,f.getLine(p).length-1);w=w-y+(f.charCoords(b,"local").bottom-w)}f.scrollTo(null,w)},replayMacro:function(f,h,p){var m=h.selectedCharacter||"",y=h.repeat||1,w=G.macroModeState;for("@"==m?m=w.latestRegister:w.latestRegister=m;y--;)bW(f,p,w,m)},enterMacroRecordMode:function(f,h){var p=G.macroModeState,m=h.selectedCharacter;G.registerController.isValidRegister(m)&&p.enterMacroRecordMode(f,m)},toggleOverwrite:function(f){f.state.overwrite?(f.toggleOverwrite(!1),f.setOption("keyMap","vim-insert"),n.signal(f,"vim-mode-change",{mode:"insert"})):(f.toggleOverwrite(!0),f.setOption("keyMap","vim-replace"),n.signal(f,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(f,h,p){if(!f.getOption("readOnly")){p.insertMode=!0,p.insertModeRepeat=h&&h.repeat||1;var m=h?h.insertAt:null,y=p.sel,w=h.head||f.getCursor("head"),b=f.listSelections().length;if("eol"==m)w=new e(w.line,Bt(f,w.line));else if("bol"==m)w=new e(w.line,0);else if("charAfter"==m)w=t(f,w,At(w,0,1)).end;else if("firstNonBlank"==m)w=t(f,w,yi.moveToFirstNonWhiteSpaceCharacter(f,w)).end;else if("startOfSelectedArea"==m){if(!p.visualMode)return;p.visualBlock?(w=new e(Math.min(y.head.line,y.anchor.line),Math.min(y.head.ch,y.anchor.ch)),b=Math.abs(y.head.line-y.anchor.line)+1):w=y.head.line<y.anchor.line?y.head:new e(y.anchor.line,0)}else if("endOfSelectedArea"==m){if(!p.visualMode)return;p.visualBlock?(w=new e(Math.min(y.head.line,y.anchor.line),Math.max(y.head.ch,y.anchor.ch)+1),b=Math.abs(y.head.line-y.anchor.line)+1):w=y.head.line>=y.anchor.line?At(y.head,0,1):new e(y.anchor.line,0)}else if("inplace"==m){if(p.visualMode)return}else"lastEdit"==m&&(w=OA(f)||w);f.setOption("disableInput",!1),h&&h.replace?(f.toggleOverwrite(!0),f.setOption("keyMap","vim-replace"),n.signal(f,"vim-mode-change",{mode:"replace"})):(f.toggleOverwrite(!1),f.setOption("keyMap","vim-insert"),n.signal(f,"vim-mode-change",{mode:"insert"})),G.macroModeState.isPlaying||(f.on("change",RA),p.insertEnd&&p.insertEnd.clear(),p.insertEnd=f.setBookmark(w,{insertLeft:!0}),n.on(f.getInputField(),"keydown",VA)),p.visualMode&&ei(f),mA(f,w,b)}},toggleVisualMode:function(f,h,p){var w,m=h.repeat,y=f.getCursor();if(p.visualMode)p.visualLine!=!!h.linewise||p.visualBlock!=!!h.blockwise?(p.visualLine=!!h.linewise,p.visualBlock=!!h.blockwise,n.signal(f,"vim-mode-change",{mode:"visual",subMode:p.visualLine?"linewise":p.visualBlock?"blockwise":""}),ta(f)):ei(f);else{p.visualMode=!0,p.visualLine=!!h.linewise,p.visualBlock=!!h.blockwise;var b=t(f,y,w=vn(f,new e(y.line,y.ch+m-1)));p.sel={anchor:b.start,head:b.end},n.signal(f,"vim-mode-change",{mode:"visual",subMode:p.visualLine?"linewise":p.visualBlock?"blockwise":""}),ta(f),vi(f,p,"<",jn(y,w)),vi(f,p,">",es(y,w))}},reselectLastSelection:function(f,h,p){var m=p.lastSelection;if(p.visualMode&&yA(f,p),m){var y=m.anchorMark.find(),w=m.headMark.find();if(!y||!w)return;p.sel={anchor:y,head:w},p.visualMode=!0,p.visualLine=m.visualLine,p.visualBlock=m.visualBlock,ta(f),vi(f,p,"<",jn(y,w)),vi(f,p,">",es(y,w)),n.signal(f,"vim-mode-change",{mode:"visual",subMode:p.visualLine?"linewise":p.visualBlock?"blockwise":""})}},joinLines:function(f,h,p){var m,y;if(p.visualMode){if(m=f.getCursor("anchor"),ft(y=f.getCursor("head"),m)){var w=y;y=m,m=w}y.ch=Bt(f,y.line)-1}else{var b=Math.max(h.repeat,2);m=f.getCursor(),y=vn(f,new e(m.line+b-1,1/0))}for(var _=0,S=m.line;S<y.line;S++){_=Bt(f,m.line);var E="",k=0;if(!h.keepSpaces){var O=f.getLine(m.line+1);-1==(k=O.search(/\S/))?k=O.length:E=" "}f.replaceRange(E,new e(m.line,_),new e(m.line+1,k))}var P=vn(f,new e(m.line,_));p.visualMode&&ei(f,!1),f.setCursor(P)},newLineAndEnterInsertMode:function(f,h,p){p.insertMode=!0;var m=Je(f.getCursor());m.line!==f.firstLine()||h.after?(m.line=h.after?m.line:m.line-1,m.ch=Bt(f,m.line),f.setCursor(m),(n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent)(f)):(f.replaceRange("\n",new e(f.firstLine(),0)),f.setCursor(f.firstLine(),0)),this.enterInsertMode(f,{repeat:h.repeat},p)},paste:function(f,h,p){var m=G.registerController.getRegister(h.registerName);if("+"===h.registerName)navigator.clipboard.readText().then(w=>{this.continuePaste(f,h,p,w,m)});else{var y=m.toString();this.continuePaste(f,h,p,y,m)}},continuePaste:function(f,h,p,m,y){var w=Je(f.getCursor());if(m){if(h.matchIndent){var b=f.getOption("tabSize"),_=function(jt){var Ot=jt.split("\t").length-1,ni=jt.split(" ").length-1;return Ot*b+1*ni},S=f.getLine(f.getCursor().line),E=_(S.match(/^\s*/)[0]),k=m.replace(/\n$/,""),O=m!==k,P=_(m.match(/^\s*/)[0]);m=k.replace(/^\s*/gm,function(jt){var Ot=E+(_(jt)-P);if(Ot<0)return"";if(f.getOption("indentWithTabs")){var ni=Math.floor(Ot/b);return Array(ni+1).join("\t")}return Array(Ot+1).join(" ")}),m+=O?"\n":""}h.repeat>1&&(m=Array(h.repeat+1).join(m));var j,I=y.linewise,T=y.blockwise;if(T){m=m.split("\n"),I&&m.pop();for(var R=0;R<m.length;R++)m[R]=""==m[R]?" ":m[R];w.ch+=h.after?1:0,w.ch=Math.min(Bt(f,w.line),w.ch)}else I?p.visualMode?m=p.visualLine?m.slice(0,-1):"\n"+m.slice(0,m.length-1)+"\n":h.after?(m="\n"+m.slice(0,m.length-1),w.ch=Bt(f,w.line)):w.ch=0:w.ch+=h.after?1:0;if(p.visualMode){p.lastPastedText=m;var te,J=function(f,h){var p=h.lastSelection;return h.visualMode?function(){var w=f.listSelections(),b=w[0],_=w[w.length-1];return[ft(b.anchor,b.head)?b.anchor:b.head,ft(_.anchor,_.head)?_.head:_.anchor]}():function(){var w=f.getCursor(),b=f.getCursor(),_=p.visualBlock;if(_){b=new e(w.line+_.height,w.ch+_.width);for(var k=[],O=w.line;O<b.line;O++){var P=new e(O,w.ch),I=new e(O,b.ch);k.push({anchor:P,head:I})}f.setSelections(k)}else{var R=p.anchorMark.find(),j=p.headMark.find(),te=j.line-R.line;b={line:b.line+te,ch:te?b.ch:j.ch-R.ch+b.ch},p.visualLine&&(w=new e(w.line,0),b=new e(b.line,Bt(f,b.line))),f.setSelection(w,b)}return[w,b]}()}(f,p),oe=J[0],Le=J[1],rn=f.getSelection(),kt=f.listSelections(),Ht=new Array(kt.length).join("1").split("1");p.lastSelection&&(te=p.lastSelection.headMark.find()),G.registerController.unnamedRegister.setText(rn),T?(f.replaceSelections(Ht),Le=new e(oe.line+m.length-1,oe.ch),f.setCursor(oe),gA(f,Le),f.replaceSelections(m),j=oe):p.visualBlock?(f.replaceSelections(Ht),f.setCursor(oe),f.replaceRange(m,oe,oe),j=oe):(f.replaceRange(m,oe,Le),j=f.posFromIndex(f.indexFromPos(oe)+m.length-1)),te&&(p.lastSelection.headMark=f.setBookmark(te)),I&&(j.ch=0)}else if(T){for(f.setCursor(w),R=0;R<m.length;R++)(Se=w.line+R)>f.lastLine()&&f.replaceRange("\n",new e(Se,0)),Bt(f,Se)<w.ch&&G4(f,Se,w.ch);f.setCursor(w),gA(f,new e(w.line+m.length-1,w.ch)),f.replaceSelections(m),j=w}else if(f.replaceRange(m,w),I){var Se;j=new e(Se=h.after?w.line+1:w.line,ti(f.getLine(Se)))}else j=Je(w),/\n/.test(m)||(j.ch+=m.length-(h.after?1:0));p.visualMode&&ei(f,!1),f.setCursor(j)}},undo:function(f,h){f.operation(function(){dA(f,n.commands.undo,h.repeat)(),f.setCursor(vn(f,f.getCursor("start")))})},redo:function(f,h){dA(f,n.commands.redo,h.repeat)()},setRegister:function(f,h,p){p.inputState.registerName=h.selectedCharacter},insertRegister:function(f,h,p){var y=G.registerController.getRegister(h.selectedCharacter),w=y&&y.toString();w&&f.replaceSelection(w)},oneNormalCommand:function(f,h,p){ns(f,!0),p.insertModeReturn=!0,n.on(f,"vim-command-done",function m(){p.visualMode||(p.insertModeReturn&&(p.insertModeReturn=!1,p.insertMode||ea.enterInsertMode(f,{},p)),n.off(f,"vim-command-done",m))})},setMark:function(f,h,p){var m=h.selectedCharacter;m&&vi(f,p,m,f.getCursor())},replace:function(f,h,p){var w,b,m=h.selectedCharacter||"",y=f.getCursor(),_=f.listSelections();if(p.visualMode)y=f.getCursor("start"),b=f.getCursor("end");else{var S=f.getLine(y.line);(w=y.ch+h.repeat)>S.length&&(w=S.length),b=new e(y.line,w)}var E=t(f,y,b);if(y=E.start,b=E.end,"\n"==m)p.visualMode||f.replaceRange("",y,b),(n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent)(f);else{var k=f.getRange(y,b);if(k=(k=k.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,m)).replace(/[^\n]/g,m),p.visualBlock){var O=new Array(f.getOption("tabSize")+1).join(" "),P=(k=(k=f.getSelection()).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,m)).replace(/\t/g,O).replace(/[^\n]/g,m).split("\n");f.replaceSelections(P)}else f.replaceRange(k,y,b);p.visualMode?(y=ft(_[0].anchor,_[0].head)?_[0].anchor:_[0].head,f.setCursor(y),ei(f,!1)):f.setCursor(At(b,0,-1))}},incrementNumberToken:function(f,h){for(var w,b,_,S,p=f.getCursor(),m=f.getLine(p.line),y=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi;null!==(w=y.exec(m))&&!(p.ch<(_=(b=w.index)+w[0].length)););if(h.backtrack||!(_<=p.ch)){if(!w)return;var E=w[2]||w[4],k=w[3]||w[5],O=h.increase?1:-1,P={"0b":2,0:8,"":10,"0x":16}[E.toLowerCase()];S=(parseInt(w[1]+k,P)+O*h.repeat).toString(P);var T=E?new Array(k.length-S.length+1+w[1].length).join("0"):"";S="-"===S.charAt(0)?"-"+E+T+S.substr(1):E+T+S;var R=new e(p.line,b),j=new e(p.line,_);f.replaceRange(S,R,j),f.setCursor(new e(p.line,b+S.length-1))}},repeatLastEdit:function(f,h,p){var m=p.lastEditInputState;if(m){var y=h.repeat;y&&h.repeatIsExplicit?m.repeatOverride=y:y=m.repeatOverride||y,BA(f,p,y,!1)}},indent:function(f,h){f.indentLine(f.getCursor().line,h.indentRight)},exitInsertMode:function(f,h){ns(f)}};function vn(f,h,p){var m=f.state.vim,y=m.insertMode||m.visualMode,w=Math.min(Math.max(f.firstLine(),h.line),f.lastLine()),b=f.getLine(w),_=b.length-1+Number(!!y),S=Math.min(Math.max(0,h.ch),_),E=b.charCodeAt(S);if(56320<=E&&E<=57343){var k=1;p&&p.line==w&&p.ch>S&&(k=-1),(S+=k)>_&&(S-=2)}return new e(w,S)}function Bf(f){var h={};for(var p in f)f.hasOwnProperty(p)&&(h[p]=f[p]);return h}function At(f,h,p){return"object"==typeof h&&(p=h.ch,h=h.line),new e(f.line+h,f.ch+p)}function $4(f,h){const p="<character>"==h.slice(-11),m="<register>"==h.slice(-10);if(p||m){var y=h.length-(p?11:10),w=f.slice(0,y),b=h.slice(0,y);return w==b&&f.length>y?"full":0==b.indexOf(w)&&"partial"}return f==h?"full":0==h.indexOf(f)&&"partial"}function dA(f,h,p){return function(){for(var m=0;m<p;m++)h(f)}}function Je(f){return new e(f.line,f.ch)}function sr(f,h){return f.ch==h.ch&&f.line==h.line}function ft(f,h){return f.line<h.line||f.line==h.line&&f.ch<h.ch}function jn(f,h){return arguments.length>2&&(h=jn.apply(void 0,Array.prototype.slice.call(arguments,1))),ft(f,h)?f:h}function es(f,h){return arguments.length>2&&(h=es.apply(void 0,Array.prototype.slice.call(arguments,1))),ft(f,h)?h:f}function pA(f,h,p){var m=ft(f,h),y=ft(h,p);return m&&y}function Bt(f,h){return f.getLine(h).length}function yy(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function G4(f,h,p){var m=Bt(f,h),y=new Array(p-m+1).join(" ");f.setCursor(new e(h,m)),f.replaceRange(y,f.getCursor())}function gA(f,h){var p=[],m=f.listSelections(),y=Je(f.clipPos(h)),w=!sr(h,y),_=function(f,h,p){for(var m=0;m<f.length;m++){var y=sr(f[m].anchor,h),w=sr(f[m].head,h);if(y||w)return m}return-1}(m,f.getCursor("head")),S=sr(m[_].head,m[_].anchor),E=m.length-1,k=E-_>_?E:0,O=m[k].anchor,P=Math.min(O.line,y.line),I=Math.max(O.line,y.line),T=O.ch,R=y.ch,j=m[k].head.ch-T,te=R-T;j>0&&te<=0?(T++,w||R--):j<0&&te>=0?(T--,S||R++):j<0&&-1==te&&(T--,R++);for(var J=P;J<=I;J++){var oe={anchor:new e(J,T),head:new e(J,R)};p.push(oe)}return f.setSelections(p),h.ch=R,O.ch=T,O}function mA(f,h,p){for(var m=[],y=0;y<p;y++){var w=At(h,y,0);m.push({anchor:w,head:w})}f.setSelections(m,0)}function yA(f,h){var p=h.sel.anchor,m=h.sel.head;h.lastPastedText&&(m=f.posFromIndex(f.indexFromPos(p)+h.lastPastedText.length),h.lastPastedText=null),h.lastSelection={anchorMark:f.setBookmark(p),headMark:f.setBookmark(m),anchor:Je(p),head:Je(m),visualMode:h.visualMode,visualLine:h.visualLine,visualBlock:h.visualBlock}}function ta(f,h,p){var m=f.state.vim;p||(p=m.visualLine?"line":m.visualBlock?"block":"char");var y=vy(f,h=h||m.sel,p);f.setSelections(y.ranges,y.primary)}function vy(f,h,p,m){var y=Je(h.head),w=Je(h.anchor);if("char"==p){var b=m||ft(h.head,h.anchor)?0:1,_=ft(h.head,h.anchor)?1:0;return y=At(h.head,0,b),{ranges:[{anchor:w=At(h.anchor,0,_),head:y}],primary:0}}if("line"==p){if(ft(h.head,h.anchor))y.ch=0,w.ch=Bt(f,w.line);else{w.ch=0;var S=f.lastLine();y.line>S&&(y.line=S),y.ch=Bt(f,y.line)}return{ranges:[{anchor:w,head:y}],primary:0}}if("block"==p){var E=Math.min(w.line,y.line),k=w.ch,O=Math.max(w.line,y.line),P=y.ch;k<P?P+=1:k+=1;for(var I=O-E+1,T=y.line==E?0:I-1,R=[],j=0;j<I;j++)R.push({anchor:new e(E+j,k),head:new e(E+j,P)});return{ranges:R,primary:T}}throw"never happens"}function ei(f,h){var p=f.state.vim;!1!==h&&f.setCursor(vn(f,p.sel.head)),yA(f,p),p.visualMode=!1,p.visualLine=!1,p.visualBlock=!1,p.insertMode||n.signal(f,"vim-mode-change",{mode:"normal"})}function ti(f){if(!f)return 0;var h=f.search(/\S/);return-1==h?f.length:h}function wy(f,{inclusive:h,innerWord:p,bigWord:m,noSymbol:y,multiline:w},b){var I,_=b||function(f){var h=f.getCursor("head");return 1==f.getSelection().length&&(h=jn(h,f.getCursor("anchor"))),h}(f),S=f.getLine(_.line),E=S,k=_.line,O=k,P=_.ch,T=y?d[0]:g[0];if(p&&/\s/.test(S.charAt(P)))T=function(Le){return/\s/.test(Le)};else{for(;!T(S.charAt(P));)if(++P>=S.length){if(!w)return null;P--,I=bA(f,_,!0,m,!0);break}m?T=g[0]:(T=d[0])(S.charAt(P))||(T=d[1])}for(var R=P,j=P;T(S.charAt(j))&&j>=0;)j--;if(j++,I)R=I.to,!(E=f.getLine(O=I.line))&&0==R&&R++;else for(;T(S.charAt(R))&&R<S.length;)R++;if(h){var te=R,J=_.ch<=j&&/\s/.test(S.charAt(_.ch));if(!J)for(;/\s/.test(E.charAt(R))&&R<E.length;)R++;if(te==R||J){for(var oe=j;/\s/.test(S.charAt(j-1))&&j>0;)j--;!j&&!J&&(j=oe)}}return{start:new e(k,j),end:new e(O,R)}}function vA(f,h,p){sr(h,p)||G.jumpList.add(f,h,p)}function wA(f,h){G.lastCharacterSearch.increment=f,G.lastCharacterSearch.forward=h.forward,G.lastCharacterSearch.selectedCharacter=h.selectedCharacter}var X4={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},CA={bracket:{isComplete:function(f){if(f.nextCh===f.symb){if(f.depth++,f.depth>=1)return!0}else f.nextCh===f.reverseSymb&&f.depth--;return!1}},section:{init:function(f){f.curMoveThrough=!0,f.symb=(f.forward?"]":"[")===f.symb?"{":"}"},isComplete:function(f){return 0===f.index&&f.nextCh===f.symb}},comment:{isComplete:function(f){var h="*"===f.lastCh&&"/"===f.nextCh;return f.lastCh=f.nextCh,h}},method:{init:function(f){f.symb="m"===f.symb?"{":"}",f.reverseSymb="{"===f.symb?"}":"{"},isComplete:function(f){return f.nextCh===f.symb}},preprocess:{init:function(f){f.index=0},isComplete:function(f){if("#"===f.nextCh){var h=f.lineText.match(/^#(\w+)/)[1];if("endif"===h){if(f.forward&&0===f.depth)return!0;f.depth++}else if("if"===h){if(!f.forward&&0===f.depth)return!0;f.depth--}if("else"===h&&0===f.depth)return!0}return!1}}};function bA(f,h,p,m,y){var w=h.line,b=h.ch,_=f.getLine(w),S=p?1:-1,E=m?g:d;if(y&&""==_){if(_=f.getLine(w+=S),!x(f,w))return null;b=p?0:_.length}for(;;){if(y&&""==_)return{from:0,to:0,line:w};for(var k=S>0?_.length:-1,O=k,P=k;b!=k;){for(var I=!1,T=0;T<E.length&&!I;++T)if(E[T](_.charAt(b))){for(O=b;b!=k&&E[T](_.charAt(b));)b+=S;if(I=O!=(P=b),O==h.ch&&w==h.line&&P==O+S)continue;return{from:Math.min(O,P+1),to:Math.max(O,P),line:w}}I||(b+=S)}if(!x(f,w+=S))return null;_=f.getLine(w),b=S>0?0:_.length}}function DA(f,h,p,m,y){var b=new e(h.line+p.repeat-1,1/0),_=f.clipPos(b);return _.ch--,y||(m.lastHPos=1/0,m.lastHSPos=f.charCoords(_,"div").left),b}function Cy(f,h,p,m,y){if(m){for(var _,w=y||f.getCursor(),b=w.ch,S=0;S<h;S++){if(-1==(_=rW(b,f.getLine(w.line),m,p,!0)))return;b=_}if(null!=_)return new e(f.getCursor().line,_)}}function vi(f,h,p,m){!ie(p,v)&&!D.test(p)||(h.marks[p]&&h.marks[p].clear(),h.marks[p]=f.setBookmark(m))}function rW(f,h,p,m,y){var w;return m?-1!=(w=h.indexOf(p,f+1))&&!y&&(w-=1):-1!=(w=h.lastIndexOf(p,f-1))&&!y&&(w+=1),w}function _A(f,h,p,m,y){var E,w=h.line,b=f.firstLine(),_=f.lastLine(),k=w;function O(j){return!f.getLine(j)}function P(j,te,J){return J?O(j)!=O(j+te):!O(j)&&O(j+te)}if(m){for(;b<=k&&k<=_&&p>0;)P(k,m)&&p--,k+=m;return{start:new e(k,0),end:h}}var I=f.state.vim;if(I.visualLine&&P(w,1,!0)){var T=I.sel.anchor;P(T.line,-1,!0)&&(!y||T.line!=w)&&(w+=1)}var R=O(w);for(k=w;k<=_&&p;k++)P(k,1,!0)&&(!y||O(k)!=R)&&p--;for(E=new e(k,0),k>_&&!R?R=!0:y=!1,k=w;k>b&&(y&&O(k)!=R&&k!=w||!P(k,-1,!0));k--);return{start:new e(k,0),end:E}}function MA(f,h,p,m,y){function w(E){E.pos+E.dir<0||E.pos+E.dir>=E.line.length?E.line=null:E.pos+=E.dir}function b(E,k,O,P){var T={line:E.getLine(k),ln:k,pos:O,dir:P};if(""===T.line)return{ln:T.ln,pos:T.pos};var R=T.pos;for(w(T);null!==T.line;){if(R=T.pos,U(T.line[T.pos])){if(y){for(w(T);null!==T.line&&H(T.line[T.pos]);)R=T.pos,w(T);return{ln:T.ln,pos:R+1}}return{ln:T.ln,pos:T.pos+1}}w(T)}return{ln:T.ln,pos:R+1}}function _(E,k,O,P){var I=E.getLine(k),T={line:I,ln:k,pos:O,dir:P};if(""===T.line)return{ln:T.ln,pos:T.pos};var R=T.pos;for(w(T);null!==T.line;){if(H(T.line[T.pos])||U(T.line[T.pos])){if(U(T.line[T.pos]))return y&&H(T.line[T.pos+1])?{ln:T.ln,pos:T.pos+1}:{ln:T.ln,pos:R}}else R=T.pos;w(T)}return T.line=I,y&&H(T.line[T.pos])?{ln:T.ln,pos:T.pos}:{ln:T.ln,pos:R}}for(var S={ln:h.line,pos:h.ch};p>0;)S=m<0?_(f,S.ln,S.pos,m):b(f,S.ln,S.pos,m),p--;return new e(S.ln,S.pos)}function SA(f,h,p,m){var y=h,w={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[p],b={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[p],S=f.getLine(y.line).charAt(y.ch)===b?1:0,E=f.scanForBracket(new e(y.line,y.ch+S),-1,void 0,{bracketRegex:w}),k=f.scanForBracket(new e(y.line,y.ch+S),1,void 0,{bracketRegex:w});if(!E||!k)return null;var O=E.pos,P=k.pos;if(O.line==P.line&&O.ch>P.ch||O.line>P.line){var I=O;O=P,P=I}return m?P.ch+=1:O.ch+=1,{start:O,end:P}}ae("pcre",!0,"boolean");class oW{getQuery(){return G.query}setQuery(h){G.query=h}getOverlay(){return this.searchOverlay}setOverlay(h){this.searchOverlay=h}isReversed(){return G.isReversed}setReversed(h){G.isReversed=h}getScrollbarAnnotate(){return this.annotate}setScrollbarAnnotate(h){this.annotate=h}}function Dr(f){var h=f.state.vim;return h.searchState_||(h.searchState_=new oW)}function xA(f,h){var p=EA(f,h)||[];if(!p.length)return[];var m=[];if(0===p[0]){for(var y=0;y<p.length;y++)"number"==typeof p[y]&&m.push(f.substring(p[y]+1,p[y+1]));return m}}function EA(f,h){h||(h="/");for(var p=!1,m=[],y=0;y<f.length;y++){var w=f.charAt(y);!p&&w==h&&m.push(y),p=!p&&"\\"==w}return m}var AA={"\\n":"\n","\\r":"\r","\\t":"\t"},kA={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t","\\&":"&"};function ts(f){"string"==typeof f&&(f=document.createElement(f));for(var h,p=1;p<arguments.length;p++)if(h=arguments[p])if("object"!=typeof h&&(h=document.createTextNode(h)),h.nodeType)f.appendChild(h);else for(var m in h)!Object.prototype.hasOwnProperty.call(h,m)||("$"===m[0]?f.style[m.slice(1)]=h[m]:f.setAttribute(m,h[m]));return f}function Fe(f,h){var p=ts("div",{$color:"red",$whiteSpace:"pre",class:"cm-vim-message"},h);f.openNotification?f.openNotification(p,{bottom:!0,duration:5e3}):alert(p.innerText)}function Wl(f,h){if(Et.length)return h.value||(h.value=""),void(We=h);var p=function(f,h){return ts("div",{$display:"flex"},ts("span",{$fontFamily:"monospace",$whiteSpace:"pre",$flex:1},f,ts("input",{type:"text",autocorrect:"off",autocapitalize:"off",spellcheck:"false",$width:"100%"})),h&&ts("span",{$color:"#888"},h))}(h.prefix,h.desc);if(f.openDialog)f.openDialog(p,h.onClose,{onKeyDown:h.onKeyDown,onKeyUp:h.onKeyUp,bottom:!0,selectValueOnOpen:!1,value:h.value});else{var m="";"string"!=typeof h.prefix&&h.prefix&&(m+=h.prefix.textContent),h.desc&&(m+=" "+h.desc),h.onClose(prompt(m,""))}}function Gl(f,h,p,m){if(h){var y=Dr(f),w=function(f,h,p){if(G.registerController.getRegister("/").setText(f),f instanceof RegExp)return f;var w,b,y=function(f){return EA(f,"/")}(f);return y.length?(w=f.substring(0,y[0]),b=-1!=f.substring(y[0]).indexOf("i")):w=f,w?(X("pcre")||(w=function(f){for(var m=!1,y=[],w=-1;w<f.length;w++){var b=f.charAt(w)||"",_=f.charAt(w+1)||"",S=_&&-1!="|(){".indexOf(_);m?(("\\"!==b||!S)&&y.push(b),m=!1):"\\"===b?(m=!0,_&&-1!="}".indexOf(_)&&(S=!0),(!S||"\\"===_)&&y.push(b)):(y.push(b),S&&"\\"!==_&&y.push("\\"))}return y.join("")}(w)),p&&(h=/^[^A-Z]*$/.test(w)),new RegExp(w,h||b?"im":"m")):null}(h,!!p,!!m);if(w)return TA(f,w),function(f,h){if(f instanceof RegExp&&h instanceof RegExp){for(var p=["global","multiline","ignoreCase","source"],m=0;m<p.length;m++){var y=p[m];if(f[y]!==h[y])return!1}return!0}return!1}(w,y.getQuery())||y.setQuery(w),w}}var zl=0;function TA(f,h){clearTimeout(zl),Dr(f).highlightTimeout=zl,zl=setTimeout(function(){if(f.state.vim){var m=Dr(f);m.highlightTimeout=null;var y=m.getOverlay();(!y||h!=y.query)&&(y&&f.removeOverlay(y),y=function(f){if("^"==f.source.charAt(0))var h=!0;return{token:function(p){if(!h||p.sol()){var m=p.match(f,!1);if(m)return 0==m[0].length?(p.next(),"searching"):p.sol()||(p.backUp(1),f.exec(p.next()+m[0]))?(p.match(f),"searching"):(p.next(),null);for(;!p.eol()&&(p.next(),!p.match(f,!1)););}else p.skipToEnd()},query:f}}(h),f.addOverlay(y),f.showMatchesOnScrollbar&&(m.getScrollbarAnnotate()&&m.getScrollbarAnnotate().clear(),m.setScrollbarAnnotate(f.showMatchesOnScrollbar(h))),m.setOverlay(y))}},50)}function IA(f,h,p,m){return f.operation(function(){void 0===m&&(m=1);for(var y=f.getCursor(),w=f.getSearchCursor(p,y),b=0;b<m;b++){var _=w.find(h);if(0==b&&_&&sr(w.from(),y)){var S=h?w.from():w.to();(_=w.find(h))&&!_[0]&&sr(w.from(),S)&&f.getLine(S.line).length==S.ch&&(_=w.find(h))}if(!_&&!(w=f.getSearchCursor(p,h?new e(f.lastLine()):new e(f.firstLine(),0))).find(h))return}return w.from()})}function by(f){var h=Dr(f);h.highlightTimeout&&(clearTimeout(h.highlightTimeout),h.highlightTimeout=null),f.removeOverlay(Dr(f).getOverlay()),h.setOverlay(null),h.getScrollbarAnnotate()&&(h.getScrollbarAnnotate().clear(),h.setScrollbarAnnotate(null))}function yW(f,h,p){return"number"!=typeof f&&(f=f.line),h instanceof Array?ie(f,h):"number"==typeof p?f>=h&&f<=p:f==h}function Dy(f){var h=f.getScrollInfo(),y=f.coordsChar({left:0,top:6+h.top},"local"),b=f.coordsChar({left:0,top:h.clientHeight-10+h.top},"local");return{top:y.line,bottom:b.line}}function Hf(f,h,p){if("'"==p||"`"==p)return G.jumpList.find(f,-1)||new e(0,0);if("."==p)return OA(f);var m=h.marks[p];return m&&m.find()}function OA(f){if(f.getLastEditEnd)return f.getLastEditEnd();for(var h=f.doc.history.done,p=h.length;p--;)if(h[p].changes)return Je(h[p].changes[0].to)}var NA={colorscheme:function(f,h){!h.args||h.args.length<1?Fe(f,f.getOption("theme")):f.setOption("theme",h.args[0])},map:function(f,h,p,m){var y=h.args;!y||y.length<2?f&&Fe(f,"Invalid mapping: "+h.input):_r.map(y[0],y[1],p,m)},imap:function(f,h){this.map(f,h,"insert")},nmap:function(f,h){this.map(f,h,"normal")},vmap:function(f,h){this.map(f,h,"visual")},omap:function(f,h){this.map(f,h,"operatorPending")},noremap:function(f,h){this.map(f,h,void 0,!0)},inoremap:function(f,h){this.map(f,h,"insert",!0)},nnoremap:function(f,h){this.map(f,h,"normal",!0)},vnoremap:function(f,h){this.map(f,h,"visual",!0)},onoremap:function(f,h){this.map(f,h,"operatorPending",!0)},unmap:function(f,h,p){var m=h.args;(!m||m.length<1||!_r.unmap(m[0],p))&&f&&Fe(f,"No such mapping: "+h.input)},mapclear:function(f,h){Ie.mapclear()},imapclear:function(f,h){Ie.mapclear("insert")},nmapclear:function(f,h){Ie.mapclear("normal")},vmapclear:function(f,h){Ie.mapclear("visual")},omapclear:function(f,h){Ie.mapclear("operatorPending")},move:function(f,h){Ts.processCommand(f,f.state.vim,{keys:"",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:h.line+1})},set:function(f,h){var p=h.args,m=h.setCfg||{};if(!p||p.length<1)f&&Fe(f,"Invalid mapping: "+h.input);else{var y=p[0].split("="),w=y.shift()||"",b=y.length>0?y.join("="):void 0,_=!1,S=!1;if("?"==w.charAt(w.length-1)){if(b)throw Error("Trailing characters: "+h.argString);w=w.substring(0,w.length-1),_=!0}else"!"==w.charAt(w.length-1)&&(w=w.substring(0,w.length-1),S=!0);void 0===b&&"no"==w.substring(0,2)&&(w=w.substring(2),b=!1);var E=re[w]&&"boolean"==re[w].type;if(E&&(S?b=!X(w,f,m):null==b&&(b=!0)),!E&&void 0===b||_){var k=X(w,f,m);k instanceof Error?Fe(f,k.message):Fe(f,!0===k||!1===k?" "+(k?"":"no")+w:"  "+w+"="+k)}else{var O=le(w,b,f,m);O instanceof Error&&Fe(f,O.message)}}},setlocal:function(f,h){h.setCfg={scope:"local"},this.set(f,h)},setglobal:function(f,h){h.setCfg={scope:"global"},this.set(f,h)},registers:function(f,h){var p=h.args,m=G.registerController.registers,y="----------Registers----------\n\n";if(p)for(var _=p.join(""),S=0;S<_.length;S++){var w=_.charAt(S);G.registerController.isValidRegister(w)&&(y+='"'+w+"    "+(m[w]||new Xr).toString()+"\n")}else for(var w in m){var b=m[w].toString();b.length&&(y+='"'+w+"    "+b+"\n")}Fe(f,y)},sort:function(f,h){var p,m,y,w,b,S=function(){if(h.argString){var Se=new n.StringStream(h.argString);if(Se.eat("!")&&(p=!0),Se.eol())return;if(!Se.eatSpace())return"Invalid arguments";var Te=Se.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!Te||!Se.eol())return"Invalid arguments";if(Te[1]){m=-1!=Te[1].indexOf("i"),y=-1!=Te[1].indexOf("u");var wn=-1!=Te[1].indexOf("d")||-1!=Te[1].indexOf("n"),jt=-1!=Te[1].indexOf("x"),Ot=-1!=Te[1].indexOf("o");if(Number(wn)+Number(jt)+Number(Ot)>1)return"Invalid arguments";w=(wn?"decimal":jt&&"hex")||Ot&&"octal"}Te[2]&&(b=new RegExp(Te[2].substr(1,Te[2].length-2),m?"i":""))}}();if(S)Fe(f,S+": "+h.argString);else{var E=h.line||f.firstLine(),k=h.lineEnd||h.line||f.lastLine();if(E!=k){var O=new e(E,0),P=new e(k,Bt(f,k)),I=f.getRange(O,P).split("\n"),T="decimal"==w?/(-?)([\d]+)/:"hex"==w?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==w?/([0-7]+)/:null,R="decimal"==w?10:"hex"==w?16:"octal"==w?8:void 0,j=[],te=[];if(w||b)for(var J=0;J<I.length;J++){var oe=b?I[J].match(b):null;oe&&""!=oe[0]?j.push(oe):T&&T.exec(I[J])?j.push(I[J]):te.push(I[J])}else te=I;if(j.sort(b?function(Se,Te){var wn;return p&&(wn=Se,Se=Te,Te=wn),m&&(Se[0]=Se[0].toLowerCase(),Te[0]=Te[0].toLowerCase()),Se[0]<Te[0]?-1:1}:Le),b)for(J=0;J<j.length;J++)j[J]=j[J].input;else w||te.sort(Le);if(I=p?j.concat(te):te.concat(j),y){var Ht,kt=I;for(I=[],J=0;J<kt.length;J++)kt[J]!=Ht&&I.push(kt[J]),Ht=kt[J]}f.replaceRange(I.join("\n"),O,P)}}function Le(Se,Te){var wn;p&&(wn=Se,Se=Te,Te=wn),m&&(Se=Se.toLowerCase(),Te=Te.toLowerCase());var jt=T&&T.exec(Se),Ot=T&&T.exec(Te);return jt&&Ot?parseInt((jt[1]+jt[2]).toLowerCase(),R)-parseInt((Ot[1]+Ot[2]).toLowerCase(),R):Se<Te?-1:1}},vglobal:function(f,h){this.global(f,h)},normal:function(f,h){var p=h.argString;if(p&&"!"==p[0]&&(p=p.slice(1),nn=!0),p=p.trimStart()){var m=h.line;if("number"==typeof m)for(var y=isNaN(h.lineEnd)?m:h.lineEnd,w=m;w<=y;w++)f.setCursor(w,0),Zr(f,h.argString.trimStart()),f.state.vim.insertMode&&ns(f,!0);else Zr(f,h.argString.trimStart()),f.state.vim.insertMode&&ns(f,!0)}else Fe(f,"Argument is required.")},global:function(f,h){var p=h.argString;if(p){var m="v"===h.commandName[0];"!"===p[0]&&"g"===h.commandName[0]&&(m=!0,p=p.slice(1));var y=void 0!==h.line?h.line:f.firstLine(),w=h.lineEnd||h.line||f.lastLine(),b=function(f){return xA(f,"/")}(p),_=p,S="";if(b&&b.length&&(_=b[0],S=b.slice(1,b.length).join("/")),_)try{Gl(f,_,!0,!0)}catch(j){return void Fe(f,"Invalid regex: "+_)}for(var E=Dr(f).getQuery(),k=[],O=y;O<=w;O++){var P=f.getLine(O);E.test(P)!==m&&k.push(S?f.getLineHandle(O):P)}if(S){var T=0,R=function(){if(T<k.length){var j=k[T++],te=f.getLineNumber(j);if(null==te)return void R();_r.processCommand(f,te+1+S,{callback:R})}else f.releaseLineHandles&&f.releaseLineHandles()};R()}else Fe(f,k.join("\n"))}else Fe(f,"Regular Expression missing from global")},substitute:function(f,h){if(!f.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var b,_,S,p=h.argString,m=p?xA(p,p[0]):[],y="",w="",E=!1,k=!1;if(m&&m.length)y=m[0],X("pcre")&&""!==y&&(y=new RegExp(y).source),void 0!==(w=m[1])&&(w=X("pcre")?function(f){for(var h=new n.StringStream(f),p=[];!h.eol();){for(;h.peek()&&"\\"!=h.peek();)p.push(h.next());var m=!1;for(var y in kA)if(h.match(y,!0)){m=!0,p.push(kA[y]);break}m||p.push(h.next())}return p.join("")}(w.replace(/([^\\])&/g,"$1$$&")):function(f){for(var h=!1,p=[],m=-1;m<f.length;m++){var y=f.charAt(m)||"",w=f.charAt(m+1)||"";AA[y+w]?(p.push(AA[y+w]),m++):h?(p.push(y),h=!1):"\\"===y?(h=!0,L(w)||"$"===w?p.push("$"):"/"!==w&&"\\"!==w&&p.push("\\")):("$"===y&&p.push("$"),p.push(y),"/"===w&&p.push("\\"))}return p.join("")}(w),G.lastSubstituteReplacePart=w),b=m[2]?m[2].split(" "):[];else if(p&&p.length)return void Fe(f,"Substitutions should be of the form :s/pattern/replace/");if(b&&(_=b[0],S=parseInt(b[1]),_&&(-1!=_.indexOf("c")&&(E=!0),-1!=_.indexOf("g")&&(k=!0),y=X("pcre")?y+"/"+_:y.replace(/\//g,"\\/")+"/"+_)),y)try{Gl(f,y,!0,!0)}catch(te){return void Fe(f,"Invalid regex: "+y)}if(void 0!==(w=w||G.lastSubstituteReplacePart)){var P=Dr(f).getQuery(),I=void 0!==h.line?h.line:f.getCursor().line,T=h.lineEnd||I;I==f.firstLine()&&T==f.lastLine()&&(T=1/0),S&&(T=(I=T)+S-1);var R=vn(f,new e(I,0)),j=f.getSearchCursor(P,R);!function(f,h,p,m,y,w,b,_,S){f.state.vim.exMode=!0;var k,O,P,E=!1;function I(){f.operation(function(){for(;!E;)T(),j();te()})}function T(){var Le=f.getRange(w.from(),w.to()).replace(b,_),rn=w.to().line;w.replace(Le),O=w.to().line,y+=O-rn,P=O<rn}function j(){for(;oe=void 0,Le=void 0,oe=k&&Je(w.to()),(Le=w.findNext())&&!Le[0]&&oe&&sr(w.from(),oe)&&(Le=w.findNext()),Le&&yW(w.from(),m,y);)if(p||w.from().line!=O||P)return f.scrollIntoView(w.from(),30),f.setSelection(w.from(),w.to()),k=w.from(),void(E=!1);var oe,Le;E=!0}function te(oe){if(oe&&oe(),f.focus(),k){f.setCursor(k);var Le=f.state.vim;Le.exMode=!1,Le.lastHPos=Le.lastHSPos=k.ch}S&&S()}if(j(),!E)return h?void Wl(f,{prefix:ts("span","replace with ",ts("strong",_)," (y/n/a/q/l)"),onKeyDown:function(oe,Le,rn){switch(n.e_stop(oe),Ul(oe)){case"y":T(),j();break;case"n":j();break;case"a":var Ht=S;S=void 0,f.operation(I),S=Ht;break;case"l":T();case"q":case"<Esc>":case"<C-c>":case"<C-[>":te(rn)}return E&&te(rn),!0}}):(I(),void(S&&S()));Fe(f,"No matches for "+b.source)}(f,E,k,I,T,j,P,w,h.callback)}else Fe(f,"No previous substitute regular expression")},startinsert:function(f,h){Zr(f,"!"==h.argString?"A":"i",{})},redo:n.commands.redo,undo:n.commands.undo,write:function(f){n.commands.save?n.commands.save(f):f.save&&f.save()},nohlsearch:function(f){by(f)},yank:function(f){var h=Je(f.getCursor()),m=f.getLine(h.line);G.registerController.pushText("0","yank",m,!0,!0)},delete:function(f,h){var p=h.selectionLine,m=isNaN(h.selectionLineEnd)?p:h.selectionLineEnd;my.delete(f,{linewise:!0},[{anchor:new e(p,0),head:new e(m+1,0)}])},join:function(f,h){var p=h.selectionLine,m=isNaN(h.selectionLineEnd)?p:h.selectionLineEnd;f.setCursor(new e(p,0)),ea.joinLines(f,{repeat:m-p},f.state.vim)},delmarks:function(f,h){if(h.argString&&yy(h.argString))for(var p=f.state.vim,m=new n.StringStream(yy(h.argString));!m.eol();){m.eatSpace();var y=m.pos;if(!m.match(/[a-zA-Z]/,!1))return void Fe(f,"Invalid argument: "+h.argString.substring(y));var w=m.next();if(m.match("-",!0)){if(!m.match(/[a-zA-Z]/,!1))return void Fe(f,"Invalid argument: "+h.argString.substring(y));var b=w,_=m.next();if(!b||!_||A(b)!=A(_))return void Fe(f,"Invalid argument: "+b+"-");var S=b.charCodeAt(0),E=_.charCodeAt(0);if(S>=E)return void Fe(f,"Invalid argument: "+h.argString.substring(y));for(var k=0;k<=E-S;k++){var O=String.fromCharCode(S+k);delete p.marks[O]}}else w&&delete p.marks[w]}else Fe(f,"Argument required")}},_r=new class{constructor(){this.buildCommandMap_()}processCommand(h,p,m){var y=this;h.operation(function(){h.curOp.isVimOp=!0,y._processCommand(h,p,m)})}_processCommand(h,p,m){var y=h.state.vim,w=G.registerController.getRegister(":"),b=w.toString(),_=new n.StringStream(p);w.setText(p);var E,k,S=m||{};S.input=p;try{this.parseInput_(h,_,S)}catch(O){throw Fe(h,O+""),O}if(y.visualMode&&ei(h),S.commandName){if(E=this.matchCommand_(S.commandName)){if(k=E.name,E.excludeFromCommandHistory&&w.setText(b),this.parseCommandArgs_(_,S,E),"exToKey"==E.type)return void Zr(h,E.toKeys,E);if("exToEx"==E.type)return void this.processCommand(h,E.toInput)}}else void 0!==S.line&&(k="move");if(k)try{NA[k](h,S),(!E||!E.possiblyAsync)&&S.callback&&S.callback()}catch(O){throw Fe(h,O+""),O}else Fe(h,'Not an editor command ":'+p+'"')}parseInput_(h,p,m){var w,b;p.eatWhile(":"),p.eat("%")?(m.line=h.firstLine(),m.lineEnd=h.lastLine()):(m.line=this.parseLineSpec_(h,p),void 0!==m.line&&p.eat(",")&&(m.lineEnd=this.parseLineSpec_(h,p))),null==m.line?h.state.vim.visualMode?(m.selectionLine=null==(w=Hf(h,h.state.vim,"<"))?void 0:w.line,m.selectionLineEnd=null==(b=Hf(h,h.state.vim,">"))?void 0:b.line):m.selectionLine=h.getCursor().line:(m.selectionLine=m.line,m.selectionLineEnd=m.lineEnd);var y=p.match(/^(\w+|!!|@@|[!#&*<=>@~])/);return m.commandName=y?y[1]:p.match(/.*/)[0],m}parseLineSpec_(h,p){var m=p.match(/^(\d+)/);if(m)return parseInt(m[1],10)-1;switch(p.next()){case".":return this.parseLineSpecOffset_(p,h.getCursor().line);case"$":return this.parseLineSpecOffset_(p,h.lastLine());case"'":var y=p.next(),w=Hf(h,h.state.vim,y);if(!w)throw new Error("Mark not set");return this.parseLineSpecOffset_(p,w.line);case"-":case"+":return p.backUp(1),this.parseLineSpecOffset_(p,h.getCursor().line);default:return void p.backUp(1)}}parseLineSpecOffset_(h,p){var m=h.match(/^([+-])?(\d+)/);if(m){var y=parseInt(m[2],10);"-"==m[1]?p-=y:p+=y}return p}parseCommandArgs_(h,p,m){if(!h.eol()){p.argString=h.match(/.*/)[0];var y=m.argDelimiter||/\s+/,w=yy(p.argString).split(y);w.length&&w[0]&&(p.args=w)}}matchCommand_(h){for(var p=h.length;p>0;p--){var m=h.substring(0,p);if(this.commandMap_[m]){var y=this.commandMap_[m];if(0===y.name.indexOf(h))return y}}return null}buildCommandMap_(){this.commandMap_={};for(var h=0;h<s.length;h++){var p=s[h];this.commandMap_[p.shortName||p.name]=p}}map(h,p,m,y){if(":"!=h&&":"==h.charAt(0)){if(m)throw Error("Mode not supported for ex mappings");var w=h.substring(1);this.commandMap_[w]=":"!=p&&":"==p.charAt(0)?{name:w,type:"exToEx",toInput:p.substring(1),user:!0}:{name:w,type:"exToKey",toKeys:p,user:!0}}else{var b={keys:h,type:"keyToKey",toKeys:p,noremap:!!y};m&&(b.context=m),r.unshift(b)}}unmap(h,p){if(":"!=h&&":"==h.charAt(0)){if(p)throw Error("Mode not supported for ex mappings");var m=h.substring(1);if(this.commandMap_[m]&&this.commandMap_[m].user)return delete this.commandMap_[m],!0}else for(var y=h,w=0;w<r.length;w++)if(y==r[w].keys&&r[w].context===p)return r.splice(w,1),!0}};function ns(f,h){var p=f.state.vim,m=G.macroModeState,y=G.registerController.getRegister("."),w=m.isPlaying,b=m.lastInsertModeChanges;w||(f.off("change",RA),p.insertEnd&&p.insertEnd.clear(),p.insertEnd=void 0,n.off(f.getInputField(),"keydown",VA)),!w&&p.insertModeRepeat>1&&(BA(f,p,p.insertModeRepeat-1,!0),p.lastEditInputState.repeatOverride=p.insertModeRepeat),delete p.insertModeRepeat,p.insertMode=!1,h||f.setCursor(f.getCursor().line,f.getCursor().ch-1),f.setOption("keyMap","vim"),f.setOption("disableInput",!0),f.toggleOverwrite(!1),y.setText(b.changes.join("")),n.signal(f,"vim-mode-change",{mode:"normal"}),m.isRecording&&function(f){if(!f.isPlaying){var p=G.registerController.getRegister(f.latestRegister);p&&p.pushInsertModeChanges&&p.pushInsertModeChanges(f.lastInsertModeChanges)}}(m)}function PA(f){r.unshift(f)}function bW(f,h,p,m){var y=G.registerController.getRegister(m);if(":"==m)return y.keyBuffer[0]&&_r.processCommand(f,y.keyBuffer[0]),void(p.isPlaying=!1);var w=y.keyBuffer,b=0;p.isPlaying=!0,p.replaySearchQueries=y.searchQueries.slice(0);for(var _=0;_<w.length;_++)for(var E,S=w[_],O=/<(?:[CSMA]-)*\w+>|./gi;E=O.exec(S);)if(Ie.handleKey(f,E[0],"macro"),h.insertMode){var P=y.insertModeChanges[b++].changes;G.macroModeState.lastInsertModeChanges.changes=P,jA(f,P,1),ns(f)}p.isPlaying=!1}function RA(f,h){var p=G.macroModeState,m=p.lastInsertModeChanges;if(!p.isPlaying)for(var y=f.state.vim;h;){if(m.expectCursorActivityForChange=!0,m.ignoreCount>1)m.ignoreCount--;else if("+input"==h.origin||"paste"==h.origin||void 0===h.origin){var w=f.listSelections().length;w>1&&(m.ignoreCount=w);var b=h.text.join("\n");if(m.maybeReset&&(m.changes=[],m.maybeReset=!1),b)if(f.state.overwrite&&!/\n/.test(b))m.changes.push([b]);else{if(b.length>1){var _=y&&y.insertEnd&&y.insertEnd.find(),S=f.getCursor();if(_&&_.line==S.line){var E=_.ch-S.ch;E>0&&E<b.length&&(m.changes.push([b,E]),b="")}}b&&m.changes.push(b)}}h=h.next}}function FA(f){var y,h=f.state.vim;if(h.insertMode){var p=G.macroModeState;if(p.isPlaying)return;var m=p.lastInsertModeChanges;m.expectCursorActivityForChange?m.expectCursorActivityForChange=!1:(m.maybeReset=!0,h.insertEnd&&h.insertEnd.clear(),h.insertEnd=f.setBookmark(f.getCursor(),{insertLeft:!0}))}else(null==(y=f.curOp)?void 0:y.isVimOp)||LA(f,h)}function LA(f,h){var p=f.getCursor("anchor"),m=f.getCursor("head");if(h.visualMode&&!f.somethingSelected()?ei(f,!1):!h.visualMode&&!h.insertMode&&f.somethingSelected()&&(h.visualMode=!0,h.visualLine=!1,n.signal(f,"vim-mode-change",{mode:"visual"})),h.visualMode){var y=ft(m,p)?0:-1,w=ft(m,p)?-1:0;m=At(m,0,y),p=At(p,0,w),h.sel={anchor:p,head:m},vi(f,h,"<",jn(m,p)),vi(f,h,">",es(m,p))}else h.insertMode||(h.lastHPos=f.getCursor().ch)}function _y(f,h){this.keyName=f,this.key=h.key,this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.metaKey=h.metaKey,this.shiftKey=h.shiftKey}function VA(f){var p=G.macroModeState.lastInsertModeChanges,m=n.keyName?n.keyName(f):f.key;!m||(-1!=m.indexOf("Delete")||-1!=m.indexOf("Backspace"))&&(p.maybeReset&&(p.changes=[],p.maybeReset=!1),p.changes.push(new _y(m,f)))}function BA(f,h,p,m){var y=G.macroModeState;y.isPlaying=!0;var w=h.lastEditActionCommand,b=h.inputState;function _(){w?Ts.processAction(f,h,w):Ts.evalInput(f,h)}function S(k){y.lastInsertModeChanges.changes.length>0&&jA(f,y.lastInsertModeChanges.changes,k=h.lastEditActionCommand?k:1)}if(h.inputState=h.lastEditInputState,w&&w.interlaceInsertRepeat)for(var E=0;E<p;E++)_(),S(1);else m||_(),S(p);h.inputState=b,h.insertMode&&!m&&ns(f),y.isPlaying=!1}function HA(f,h){n.lookupKey(h,"vim-insert",function(m){return"string"==typeof m?n.commands[m](f):m(f),!0})}function jA(f,h,p){var m=f.getCursor("head"),y=G.macroModeState.lastInsertModeChanges.visualBlock;y&&(mA(f,m,y+1),p=f.listSelections().length,f.setCursor(m));for(var w=0;w<p;w++){y&&f.setCursor(At(m,w,0));for(var b=0;b<h.length;b++){var _=h[b];if(_ instanceof _y)HA(f,_.keyName);else if("string"==typeof _)f.replaceSelection(_);else{var S=f.getCursor(),E=At(S,0,_[0].length-(_[1]||0));f.replaceRange(_[0],S,_[1]?S:E),f.setCursor(E)}}}y&&f.setCursor(At(m,0,1))}function My(f){var h=new f.constructor;return Object.keys(f).forEach(function(p){if("insertEnd"!=p){var m=f[p];Array.isArray(m)?m=m.slice():m&&"object"==typeof m&&m.constructor!=Object&&(m=My(m)),h[p]=m}}),f.sel&&(h.sel={head:f.sel.head&&Je(f.sel.head),anchor:f.sel.anchor&&Je(f.sel.anchor)}),h}return ae("insertModeEscKeysTimeout",200,"number"),tn(),Ie}function Hn(n,e){var t=e.ch,r=e.line+1;r<1&&(r=1,t=0),r>n.lines&&(r=n.lines,t=Number.MAX_VALUE);var i=n.line(r);return Math.min(i.from+Math.max(0,t),i.to)}function rr(n,e){let t=n.lineAt(e);return{line:t.number-1,ch:e-t.from}}class Jr{constructor(e,t){this.line=e,this.ch=t}}function YE(n,e,t){if(n.addEventListener)n.addEventListener(e,t,!1);else{var r=n._handlers||(n._handlers={});r[e]=(r[e]||[]).concat(t)}}function JE(n,e,t){if(n.removeEventListener)n.removeEventListener(e,t,!1);else{var r=n._handlers,i=r&&r[e];if(i){var s=i.indexOf(t);s>-1&&(r[e]=i.slice(0,s).concat(i.slice(s+1)))}}}function ZE(n,e,...t){var r,i=null===(r=n._handlers)||void 0===r?void 0:r[e];if(i)for(var s=0;s<i.length;++s)i[s](...t)}function XE(n,...e){if(n)for(var t=0;t<n.length;++t)n[t](...e)}let py;try{py=new RegExp("[\\w\\p{Alphabetic}\\p{Number}_]","u")}catch(n){py=/[\w]/}function $l(n,e){var t=n.cm6;if(!t.state.readOnly){var r="input.type.compose";if(n.curOp&&(n.curOp.lastChange||(r="input.type.compose.start")),e.annotations)try{e.annotations.some(function(i){"input"==i.value&&(i.value=r)})}catch(i){console.error(i)}else e.userEvent=r;return t.dispatch(e)}}function eA(n,e){var t;n.curOp&&(n.curOp.$changeStart=void 0),(e?Ym:Cf)(n.cm6);let r=null===(t=n.curOp)||void 0===t?void 0:t.$changeStart;null!=r&&n.cm6.dispatch({selection:{anchor:r}})}class ve{constructor(e){this.state={},this.marks=Object.create(null),this.$mid=0,this.options={},this._handlers={},this.$lastChangeEndOffset=0,this.virtualSelection=null,this.cm6=e,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this)}openDialog(e,t,r){return function(n,e,t,r){r||(r={}),rA(n,void 0);var i=nA(0,e),s=!1;function o(l){if("string"==typeof l)a.value=l;else{if(s)return;s=!0,sA(n,i),n.state.dialog||n.focus(),r.onClose&&r.onClose(i)}}iA(n,i);var a=i.getElementsByTagName("input")[0];return a&&(r.value&&(a.value=r.value,!1!==r.selectValueOnOpen&&a.select()),r.onInput&&ve.on(a,"input",function(l){r.onInput(l,a.value,o)}),r.onKeyUp&&ve.on(a,"keyup",function(l){r.onKeyUp(l,a.value,o)}),ve.on(a,"keydown",function(l){r&&r.onKeyDown&&r.onKeyDown(l,a.value,o)||(13==l.keyCode&&t(a.value),(27==l.keyCode||!1!==r.closeOnEnter&&13==l.keyCode)&&(a.blur(),ve.e_stop(l),o()))}),!1!==r.closeOnBlur&&ve.on(a,"blur",function(){setTimeout(function(){document.activeElement!==a&&o()})}),a.focus()),o}(this,e,t,r)}openNotification(e,t){return function(n,e,t){rA(n,a);var s,r=nA(0,e),i=!1,o=t&&void 0!==t.duration?t.duration:5e3;function a(){i||(i=!0,clearTimeout(s),r.remove(),sA(n,r))}return r.onclick=function(l){l.preventDefault(),a()},iA(n,r),o&&(s=setTimeout(a,o)),a}(this,e,t)}on(e,t){YE(this,e,t)}off(e,t){JE(this,e,t)}signal(e,t,r){ZE(this,e,t,r)}indexFromPos(e){return Hn(this.cm6.state.doc,e)}posFromIndex(e){return rr(this.cm6.state.doc,e)}foldCode(e){let t=this.cm6,r=t.state.selection.ranges,s=Hn(this.cm6.state.doc,e),o=V.create([V.range(s,s)],0).ranges;t.state.selection.ranges=o,(n=>{for(let e of function(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(r=>r.from<=t&&r.to>=t)||e.push(n.lineBlockAt(t));return e}(n)){let t=Pl(n.state,e.from,e.to);if(t)return n.dispatch({effects:Pm(n.state,[Rl.of(t),yf(n,t)])}),!0}})(t),t.state.selection.ranges=r}firstLine(){return 0}lastLine(){return this.cm6.state.doc.lines-1}lineCount(){return this.cm6.state.doc.lines}setCursor(e,t){"object"==typeof e&&(t=e.ch,e=e.line);var r=Hn(this.cm6.state.doc,{line:e,ch:t||0});this.cm6.dispatch({selection:{anchor:r}},{scrollIntoView:!this.curOp}),this.curOp&&!this.curOp.isVimOp&&this.onBeforeEndOperation()}getCursor(e){var t=this.cm6.state.selection.main,r="head"!=e&&e?"anchor"==e?t.anchor:"start"==e?t.from:"end"==e?t.to:null:t.head;if(null==r)throw new Error("Invalid cursor type");return this.posFromIndex(r)}listSelections(){var e=this.cm6.state.doc;return this.cm6.state.selection.ranges.map(t=>({anchor:rr(e,t.anchor),head:rr(e,t.head)}))}setSelections(e,t){var r=this.cm6.state.doc,i=e.map(s=>{var o=Hn(r,s.head),a=Hn(r,s.anchor);return o==a?V.cursor(o,1):V.range(a,o)});this.cm6.dispatch({selection:V.create(i,t)})}setSelection(e,t,r){this.setSelections([{anchor:e,head:t}],0),r&&"*mouse"==r.origin&&this.onBeforeEndOperation()}getLine(e){return e<0||e>=this.cm6.state.doc.lines?"":this.cm6.state.doc.line(e+1).text}getLineHandle(e){return this.$lineHandleChanges||(this.$lineHandleChanges=[]),{row:e,index:this.indexFromPos(new Jr(e,0))}}getLineNumber(e){var t=this.$lineHandleChanges;if(!t)return null;for(var r=e.index,i=0;i<t.length;i++)if(null==(r=t[i].changes.mapPos(r,1,gn.TrackAfter)))return null;var s=this.posFromIndex(r);return 0==s.ch?s.line:null}releaseLineHandles(){this.$lineHandleChanges=void 0}getRange(e,t){var r=this.cm6.state.doc;return this.cm6.state.sliceDoc(Hn(r,e),Hn(r,t))}replaceRange(e,t,r,i){r||(r=t);var s=this.cm6.state.doc;$l(this,{changes:{from:Hn(s,t),to:Hn(s,r),insert:e}})}replaceSelection(e){$l(this,this.cm6.state.replaceSelection(e))}replaceSelections(e){$l(this,{changes:this.cm6.state.selection.ranges.map((i,s)=>({from:i.from,to:i.to,insert:e[s]||""}))})}getSelection(){return this.getSelections().join("\n")}getSelections(){var e=this.cm6;return e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to))}somethingSelected(){return this.cm6.state.selection.ranges.some(e=>!e.empty)}getInputField(){return this.cm6.contentDOM}clipPos(e){var t=this.cm6.state.doc,r=e.ch,i=e.line+1;i<1&&(i=1,r=0),i>t.lines&&(i=t.lines,r=Number.MAX_VALUE);var s=t.line(i);return r=Math.min(Math.max(0,r),s.to-s.from),new Jr(i-1,r)}getValue(){return this.cm6.state.doc.toString()}setValue(e){var t=this.cm6;return t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e},selection:V.range(0,0)})}focus(){return this.cm6.focus()}blur(){return this.cm6.contentDOM.blur()}defaultTextHeight(){return this.cm6.defaultLineHeight}findMatchingBracket(e,t){var r=this.cm6.state,i=Hn(r.doc,e),s=er(r,i+1,-1);return s&&s.end||(s=er(r,i,1))&&s.end?{to:rr(r.doc,s.end.from)}:{to:void 0}}scanForBracket(e,t,r,i){return function(n,e,t,r,i){for(var s=i&&i.maxScanLineLength||1e4,o=i&&i.maxScanLines||1e3,a=[],l=function(n){return n&&n.bracketRegex||/[(){}[\]]/}(i),u=t>0?Math.min(e.line+o,n.lastLine()+1):Math.max(n.firstLine()-1,e.line-o),c=e.line;c!=u;c+=t){var d=n.getLine(c);if(d){var g=t>0?0:d.length-1,v=t>0?d.length:-1;if(!(d.length>s))for(c==e.line&&(g=e.ch-(t<0?1:0));g!=v;g+=t){var C=d.charAt(g);if(l.test(C)){var D=i4[C];if(D&&">"==D.charAt(1)==t>0)a.push(C);else{if(!a.length)return{pos:new Jr(c,g),ch:C};a.pop()}}}}}return c-t!=(t>0?n.lastLine():n.firstLine())&&null}(this,e,t,0,i)}indentLine(e,t){t?this.indentMore():this.indentLess()}indentMore(){kf(this.cm6)}indentLess(){ry(this.cm6)}execCommand(e){if("indentAuto"==e)ve.commands.indentAuto(this);else if("goLineLeft"==e)fE(this.cm6);else if("goLineRight"==e){cE(this.cm6);let t=this.cm6.state,r=t.selection.main.head;r<t.doc.length&&"\n"!==t.sliceDoc(r,r+1)&&Df(this.cm6,!1)}else console.log(e+" is not implemented")}setBookmark(e,t){var r=(null==t?void 0:t.insertLeft)?1:-1,i=this.indexFromPos(e);return new u4(this,i,r)}addOverlay({query:e}){let t=new ly({regexp:!0,search:e.source,caseSensitive:!/i/.test(e.flags)});if(t.valid){t.forVim=!0,this.cm6Query=t;let r=Zi.of(t);return this.cm6.dispatch({effects:r}),t}}removeOverlay(e){if(!this.cm6Query)return;this.cm6Query.forVim=!1;let t=Zi.of(this.cm6Query);this.cm6.dispatch({effects:t})}getSearchCursor(e,t){var r=this,i=null,s=null;null==t.ch&&(t.ch=Number.MAX_VALUE);var o=Hn(r.cm6.state.doc,t),a=e.source.replace(/(\\.|{(?:\d+(?:,\d*)?|,\d+)})|[{}]/g,function(g,v){return v||"\\"+g});function l(g,v=0,C=g.length){return new sy(g,a,{ignoreCase:e.ignoreCase},v,C)}return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(g){var v=r.cm6.state.doc;return i=g?function(g,v){var C=r.cm6.state.doc;for(let D=1;;D++){let M=Math.max(0,v-1e4*D),x=l(C,M,v),A=null;for(;!x.next().done;)A=x.value;if(A&&(0==M||A.from>M+10))return A;if(0==M)return null}}(0,i?i.from==i.to?i.to-1:i.from:o):function(g){var v=r.cm6.state.doc;if(g>v.length)return null;let C=l(v,g).next();return C.done?null:C.value}(i?i.from==i.to?i.to+1:i.to:o),s=i&&{from:rr(v,i.from),to:rr(v,i.to),match:i.match},i&&i.match},from:function(){return null==s?void 0:s.from},to:function(){return null==s?void 0:s.to},replace:function(g){i&&($l(r,{changes:{from:i.from,to:i.to,insert:g}}),i.to=i.from+g.length,s&&(s.to=rr(r.cm6.state.doc,i.to)))}}}findPosV(e,t,r,i){let{cm6:s}=this;const o=s.state.doc;let a="page"==r?s.dom.clientHeight:0;const l=Hn(o,e);let u=V.cursor(l,1,void 0,i),c=Math.round(Math.abs(t));for(let g=0;g<c;g++)"page"==r?u=s.moveVertically(u,t>0,a):"line"==r&&(u=s.moveVertically(u,t>0));let d=rr(o,u.head);return(t<0&&0==u.head&&0!=i&&0==e.line&&0!=e.ch||t>0&&u.head==o.length&&d.ch!=i&&e.line==d.line)&&(d.hitSide=!0),d}charCoords(e,t){var r=this.cm6.contentDOM.getBoundingClientRect(),i=Hn(this.cm6.state.doc,e),s=this.cm6.coordsAtPos(i),o=-r.top;return{left:((null==s?void 0:s.left)||0)-r.left,top:((null==s?void 0:s.top)||0)+o,bottom:((null==s?void 0:s.bottom)||0)+o}}coordsChar(e,t){var r=this.cm6.contentDOM.getBoundingClientRect(),i=this.cm6.posAtCoords({x:e.left+r.left,y:e.top+r.top})||0;return rr(this.cm6.state.doc,i)}getScrollInfo(){var e=this.cm6.scrollDOM;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight,width:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}scrollTo(e,t){null!=e&&(this.cm6.scrollDOM.scrollLeft=e),null!=t&&(this.cm6.scrollDOM.scrollTop=t)}scrollIntoView(e,t){if(e){var r=this.indexFromPos(e);this.cm6.dispatch({effects:he.scrollIntoView(r)})}else this.cm6.dispatch({scrollIntoView:!0,userEvent:"scroll"})}getWrapperElement(){return this.cm6.dom}getMode(){return{name:this.getOption("mode")}}setSize(e,t){this.cm6.dom.style.width=e+4+"px",this.cm6.dom.style.height=t+"px",this.refresh()}refresh(){this.cm6.measure()}destroy(){this.removeOverlay()}getLastEditEnd(){return this.posFromIndex(this.$lastChangeEndOffset)}onChange(e){this.$lineHandleChanges&&this.$lineHandleChanges.push(e);for(let r in this.marks)this.marks[r].update(e.changes);this.virtualSelection&&(this.virtualSelection.ranges=this.virtualSelection.ranges.map(r=>r.map(e.changes)));var t=this.curOp=this.curOp||{};e.changes.iterChanges((r,i,s,o,a)=>{(null==t.$changeStart||t.$changeStart>s)&&(t.$changeStart=s),this.$lastChangeEndOffset=o;var l={text:a.toJSON()};t.lastChange?t.lastChange.next=t.lastChange=l:t.lastChange=t.change=l},!0),t.changeHandlers||(t.changeHandlers=this._handlers.change&&this._handlers.change.slice())}onSelectionChange(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._handlers.cursorActivity&&this._handlers.cursorActivity.slice()),this.curOp.cursorActivity=!0}operation(e,t){this.curOp||(this.curOp={$d:0}),this.curOp.$d++;try{var r=e()}finally{this.curOp&&(this.curOp.$d--,this.curOp.$d||this.onBeforeEndOperation())}return r}onBeforeEndOperation(){var e=this.curOp,t=!1;e&&(e.change&&XE(e.changeHandlers,this,e.change),e&&e.cursorActivity&&(XE(e.cursorActivityHandlers,this,null),e.isVimOp&&(t=!0)),this.curOp=null),t&&this.scrollIntoView()}moveH(e,t){if("char"==t){var r=this.getCursor();this.setCursor(r.line,r.ch+e)}}setOption(e,t){switch(e){case"keyMap":this.state.keyMap=t;break;case"textwidth":this.state.textwidth=t}}getOption(e){switch(e){case"firstLineNumber":return 1;case"tabSize":return this.cm6.state.tabSize||4;case"readOnly":return this.cm6.state.readOnly;case"indentWithTabs":return"\t"==this.cm6.state.facet(Ol);case"indentUnit":return this.cm6.state.facet(Ol).length||2;case"textwidth":return this.state.textwidth;case"keyMap":return this.state.keyMap||"vim"}}toggleOverwrite(e){this.state.overwrite=e}getTokenTypeAt(e){var t,r=this.indexFromPos(e),i=Tm(this.cm6.state,r),s=null==i?void 0:i.resolve(r),o=(null===(t=null==s?void 0:s.type)||void 0===t?void 0:t.name)||"";return/comment/i.test(o)?"comment":/string/i.test(o)?"string":""}overWriteSelection(e){var t=this.cm6.state.doc,r=this.cm6.state.selection,i=r.ranges.map(s=>{if(s.empty){var o=s.to<t.length?t.sliceString(s.from,s.to+1):"";if(o&&!/\n/.test(o))return V.range(s.from,s.to+1)}return s});this.cm6.dispatch({selection:V.create(i,r.mainIndex)}),this.replaceSelection(e)}isInMultiSelectMode(){return this.cm6.state.selection.ranges.length>1}virtualSelectionMode(){return!!this.virtualSelection}forEachSelection(e){var t=this.cm6.state.selection;this.virtualSelection=V.create(t.ranges,t.mainIndex);for(var r=0;r<this.virtualSelection.ranges.length;r++){var i=this.virtualSelection.ranges[r];!i||(this.cm6.dispatch({selection:V.create([i])}),e(),this.virtualSelection.ranges[r]=this.cm6.state.selection.ranges[0])}this.cm6.dispatch({selection:this.virtualSelection}),this.virtualSelection=null}hardWrap(e){return function(n,e){for(var t,r=e.column||n.getOption("textwidth")||80,i=0!=e.allowMerge,s=Math.min(e.from,e.to),o=Math.max(e.from,e.to);s<=o;){var a=n.getLine(s);if(a.length>r){if(l=C(a,r,5)){var u=null===(t=/^\s*/.exec(a))||void 0===t?void 0:t[0];n.replaceRange("\n"+u,new Jr(s,l.start),new Jr(s,l.end))}o++}else if(i&&/\S/.test(a)&&s!=o){var c=n.getLine(s+1);if(c&&/\S/.test(c)){var l,d=a.replace(/\s+$/,""),g=c.replace(/^\s+/,""),v=d+" "+g;(l=C(v,r,5))&&l.start>d.length||v.length<r?(n.replaceRange(" ",new Jr(s,d.length),new Jr(s+1,c.length-g.length)),s--,o--):d.length<a.length&&n.replaceRange("",new Jr(s,d.length),new Jr(s,a.length))}}s++}return s;function C(D,M,x){if(!(D.length<M)){var A=D.slice(0,M),N=D.slice(M),L=/^(?:(\s+)|(\S+)(\s+))/.exec(N),F=/(?:(\s+)|(\s+)(\S+))$/.exec(A),H=0,U=0;if(F&&!F[2]&&(H=M-F[1].length,U=M),L&&!L[2]&&(H||(H=M),U=M+L[1].length),H)return{start:H,end:U};if(F&&F[2]&&F.index>x)return{start:F.index,end:F.index+F[2].length};if(L&&L[2])return{start:H=M+L[2].length,end:H+L[3].length}}}}(this,e)}}function nA(n,e,t){var r=document.createElement("div");return r.appendChild(e),r}function rA(n,e){n.state.currentNotificationClose&&n.state.currentNotificationClose(),n.state.currentNotificationClose=e}function iA(n,e){var t=n.state.dialog;n.state.dialog=e,e&&t!==e&&(t&&t.contains(document.activeElement)&&n.focus(),t&&t.parentElement?t.parentElement.replaceChild(e,t):t&&t.remove(),ve.signal(n,"dialog"))}function sA(n,e){n.state.dialog==e&&(n.state.dialog=null,ve.signal(n,"dialog"))}ve.isMac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ve.Pos=Jr,ve.StringStream=Hm,ve.commands={cursorCharLeft:function(n){Xm(n.cm6)},redo:function(n){eA(n,!1)},undo:function(n){eA(n,!0)},newlineAndIndent:function(n){OE({state:n.cm6.state,dispatch:e=>$l(n,e)})},indentAuto:function(n){PE(n.cm6)},newlineAndIndentContinueComment:void 0,save:void 0},ve.isWordChar=function(n){return py.test(n)},ve.keys={},ve.addClass=function(n,e){},ve.rmClass=function(n,e){},ve.e_preventDefault=function(n){n.preventDefault()},ve.e_stop=function(n){var e,t;null===(e=null==n?void 0:n.stopPropagation)||void 0===e||e.call(n),null===(t=null==n?void 0:n.preventDefault)||void 0===t||t.call(n)},ve.lookupKey=function(e,t,r){var i=ve.keys[e];i&&r(i)},ve.on=YE,ve.off=JE,ve.signal=ZE,ve.findMatchingTag=function(n,e){},ve.findEnclosingTag=function(n,e){var t,r,i=n.cm6.state,s=n.indexFromPos(e);s<i.doc.length&&"<"==i.sliceDoc(s,s+1)&&s++;for(var a=Tm(i,s),l=(null==a?void 0:a.resolve(s))||null;l;){if("OpenTag"==(null===(t=l.firstChild)||void 0===t?void 0:t.type.name)&&"CloseTag"==(null===(r=l.lastChild)||void 0===r?void 0:r.type.name))return{open:oA(i.doc,l.firstChild),close:oA(i.doc,l.lastChild)};l=l.parent}},ve.keyName=void 0;var i4={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function oA(n,e){return{from:rr(n,e.from),to:rr(n,e.to)}}class u4{constructor(e,t,r){this.cm=e,this.id=e.$mid++,this.offset=t,this.assoc=r,e.marks[this.id]=this}clear(){delete this.cm.marks[this.id]}find(){return null==this.offset?null:this.cm.posFromIndex(this.offset)}update(e){null!=this.offset&&(this.offset=e.mapPos(this.offset,this.assoc,gn.TrackDel))}}let gy=function(n){return n.facet(Bo)}||function(){let n={cursorBlinkRate:1200};return function(){return n}}();class f4{constructor(e,t,r,i,s,o,a,l,u,c){this.left=e,this.top=t,this.height=r,this.fontFamily=i,this.fontSize=s,this.fontWeight=o,this.color=a,this.className=l,this.letter=u,this.partial=c}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}}class h4{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.cm=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let t=gy(this.cm.cm6.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=t+"ms"}update(e){var n;(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),gy((n=e).startState)!=gy(n.state)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let r of e.selection.ranges){let s=y4(this.cm,this.view,r,r==e.selection.main);s&&t.push(s)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,r)=>!t.eq(this.cursors[r]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const r of e)this.cursorLayer.appendChild(r.draw())}else e.forEach((r,i)=>r.adjust(t[i]));this.cursors=e}}destroy(){this.cursorLayer.remove()}}const g4=bs.highest(he.theme({".cm-vimMode .cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}}));function y4(n,e,t,r){var i,s;let o=t.head,a=!1,l=1,u=n.state.vim;if(u&&(!u.insertMode||n.state.overwrite)){if(a=!0,u.visualBlock&&!r)return null;t.anchor<t.head&&o--,n.state.overwrite?l=.2:u.status&&(l=.5)}if(a){let d=o<e.state.doc.length&&e.state.sliceDoc(o,o+1);d&&/[\uDC00-\uDFFF]/.test(d)&&o>1&&(o--,d=e.state.sliceDoc(o,o+1));let g=e.coordsAtPos(o,1);if(!g)return null;let v=function(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==$e.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}(e),C=e.domAtPos(o),D=C?C.node:e.contentDOM;for(;C&&C.node instanceof HTMLElement;)D=C.node,C={node:C.node.childNodes[C.offset],offset:0};if(!(D instanceof HTMLElement)){if(!D.parentNode)return null;D=D.parentNode}let M=getComputedStyle(D),x=g.left,A=null===(s=(i=e).coordsForChar)||void 0===s?void 0:s.call(i,o);if(A&&(x=A.left),d&&"\n"!=d&&"\r"!=d)if("\t"==d){d="\xa0";var c=e.coordsAtPos(o+1,-1);c&&(x=c.left-(c.left-g.left)/parseInt(M.tabSize))}else/[\uD800-\uDBFF]/.test(d)&&o<e.state.doc.length-1&&(d+=e.state.sliceDoc(o+1,o+2));else d="\xa0";let N=g.bottom-g.top;return new f4(x-v.left,g.top-v.top+N*(1-l),N*l,M.fontFamily,M.fontSize,M.fontWeight,M.color,r?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",d,1!=l)}return null}var v4="undefined"!=typeof navigator&&/linux/i.test(navigator.platform)&&/ Gecko\/\d+/.exec(navigator.userAgent);const ir=t4(ve),C4=he.baseTheme({".cm-vimMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"0px 10px",fontFamily:"monospace",minHeight:"1.3em"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"inherit"},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"}}),b4=ct.fromClass(class{constructor(n){this.status="",this.query=null,this.decorations=Z.none,this.waitForCopy=!1,this.lastKeydown="",this.useNextTextInput=!1,this.compositionText="",this.view=n;const e=this.cm=new ve(n);ir.enterVimMode(this.cm),this.view.cm=this.cm,this.cm.state.vimPlugin=this,this.blockCursor=new h4(n,e),this.updateClass(),this.cm.on("vim-command-done",()=>{e.state.vim&&(e.state.vim.status=""),this.blockCursor.scheduleRedraw(),this.updateStatus()}),this.cm.on("vim-mode-change",t=>{!e.state.vim||(e.state.vim.mode=t.mode,t.subMode&&(e.state.vim.mode+=" block"),e.state.vim.status="",this.blockCursor.scheduleRedraw(),this.updateClass(),this.updateStatus())}),this.cm.on("dialog",()=>{this.cm.state.statusbar?this.updateStatus():n.dispatch({effects:aA.of(!!this.cm.state.dialog)})}),this.dom=document.createElement("span"),this.dom.style.cssText="position: absolute; right: 10px; top: 1px",this.statusButton=document.createElement("span"),this.statusButton.onclick=t=>{ir.handleKey(this.cm,"<Esc>","user"),this.cm.focus()},this.statusButton.style.cssText="cursor: pointer"}update(n){var e;if((n.viewportChanged||n.docChanged)&&this.query&&this.highlight(this.query),n.docChanged&&this.cm.onChange(n),n.selectionSet&&this.cm.onSelectionChange(),this.cm.curOp&&!this.cm.curOp.isVimOp&&this.cm.onBeforeEndOperation(),n.transactions)for(let t of n.transactions)for(let r of t.effects)if(r.is(Zi))if(null===(e=r.value)||void 0===e?void 0:e.forVim){let s=r.value.create();this.highlight(s)}else this.highlight(null);this.blockCursor.update(n)}updateClass(){const n=this.cm.state;!n.vim||n.vim.insertMode&&!n.overwrite?this.view.scrollDOM.classList.remove("cm-vimMode"):this.view.scrollDOM.classList.add("cm-vimMode")}updateStatus(){let n=this.cm.state.statusbar,e=this.cm.state.vim;if(!n||!e)return;let t=this.cm.state.dialog;if(t)t.parentElement!=n&&(n.textContent="",n.appendChild(t));else{n.textContent="";var r=(e.mode||"normal").toUpperCase();e.insertModeReturn&&(r+="(C-O)"),this.statusButton.textContent=`--${r}--`,n.appendChild(this.statusButton)}this.dom.textContent=e.status,n.appendChild(this.dom)}destroy(){ir.leaveVimMode(this.cm),this.updateClass(),this.blockCursor.destroy(),delete this.view.cm}highlight(n){if(this.query=n,!n)return this.decorations=Z.none;let{view:e}=this,t=new di;for(let r=0,i=e.visibleRanges,s=i.length;r<s;r++){let{from:o,to:a}=i[r];for(;r<s-1&&a>i[r+1].from-500;)a=i[++r].to;n.highlight(e.state,o,a,(l,u)=>{t.add(l,u,_4)})}return this.decorations=t.finish()}handleKey(n,e){const t=this.cm;let r=t.state.vim;if(!r)return;const i=ir.vimKeyFromEvent(n,r);if(ve.signal(this.cm,"inputEvent",{type:"handleKey",key:i}),!i)return;if("<Esc>"==i&&!r.insertMode&&!r.visualMode&&this.query){const a=r.searchState_;a&&(t.removeOverlay(a.getOverlay()),a.setOverlay(null))}if("<C-c>"===i&&!ve.isMac&&t.somethingSelected())return this.waitForCopy=!0,!0;r.status=(r.status||"")+i;let o=ir.multiSelectHandleKey(t,i,"user");return r=ir.maybeInitVimState_(t),!o&&r.insertMode&&t.state.overwrite&&(n.key&&1==n.key.length&&!/\n/.test(n.key)?(o=!0,t.overWriteSelection(n.key)):"Backspace"==n.key&&(o=!0,ve.commands.cursorCharLeft(t))),o&&(ve.signal(this.cm,"vim-keypress",i),n.preventDefault(),n.stopPropagation(),this.blockCursor.scheduleRedraw()),this.updateStatus(),!!o}},{eventHandlers:{copy:function(n,e){!this.waitForCopy||(this.waitForCopy=!1,Promise.resolve().then(()=>{var t=this.cm,r=t.state.vim;!r||(r.insertMode?t.setSelection(t.getCursor(),t.getCursor()):t.operation(()=>{t.curOp&&(t.curOp.isVimOp=!0),ir.handleKey(t,"<Esc>","user")}))}))},compositionstart:function(n,e){this.useNextTextInput=!0,ve.signal(this.cm,"inputEvent",n)},compositionupdate:function(n,e){ve.signal(this.cm,"inputEvent",n)},compositionend:function(n,e){ve.signal(this.cm,"inputEvent",n)},keypress:function(n,e){ve.signal(this.cm,"inputEvent",n),"Dead"==this.lastKeydown&&this.handleKey(n,e)},keydown:function(n,e){ve.signal(this.cm,"inputEvent",n),this.lastKeydown=n.key,"Unidentified"==this.lastKeydown||"Process"==this.lastKeydown||"Dead"==this.lastKeydown?this.useNextTextInput=!0:(this.useNextTextInput=!1,this.handleKey(n,e))}},provide:()=>[he.inputHandler.of((n,e,t,r)=>{var i,s,o=function(n){return n.cm||null}(n);if(!o)return!1;var a=null===(i=o.state)||void 0===i?void 0:i.vim,l=o.state.vimPlugin;if(a&&!a.insertMode&&!(null===(s=o.curOp)||void 0===s?void 0:s.isVimOp)){if("\0\0"===r)return!0;if(ve.signal(o,"inputEvent",{type:"text",text:r,from:e,to:t}),1==r.length&&l.useNextTextInput){if(a.expectLiteralNext&&n.composing)return l.compositionText=r,!1;if(l.compositionText){var u=l.compositionText;l.compositionText="";var c=n.state.selection.main.head;if(u===n.state.sliceDoc(c-u.length,c)){var g=o.getCursor();o.replaceRange("",o.posFromIndex(c-u.length),g)}}return l.handleKey({key:r,preventDefault:()=>{},stopPropagation:()=>{}}),function(n){var e=n.scrollDOM.parentElement;if(e){if(v4)return n.contentDOM.textContent="\0\0",void n.contentDOM.dispatchEvent(new CustomEvent("compositionend"));var t=n.scrollDOM.nextSibling,r=window.getSelection(),i=r&&{anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset};n.scrollDOM.remove(),e.insertBefore(n.scrollDOM,t);try{i&&r&&(r.setPosition(i.anchorNode,i.anchorOffset),i.focusNode&&r.extend(i.focusNode,i.focusOffset))}catch(s){console.error(s)}n.focus(),n.contentDOM.dispatchEvent(new CustomEvent("compositionend"))}}(n),!0}}return!1})],decorations:n=>n.decorations}),_4=Z.mark({class:"cm-searchMatch"}),aA=st.define(),M4=Mn.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(aA)&&(n=t.value);return n},provide:n=>Ho.from(n,e=>e?S4:null)});function S4(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.dialog&&e.appendChild(t.state.dialog),{top:!1,dom:e}}function x4(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.statusbar=e,t.state.vimPlugin.updateStatus(),{dom:e}}function E4(n={}){return[C4,b4,g4,n.status?Ho.of(x4):M4]}const k4=["editorContainer"];function T4(n,e){1&n&&(ca(),fa(),Ee(0,"div",11),Ee(1,"ul"),Ee(2,"li"),Ee(3,"kbd"),lt(4,"When typing:"),Ae(),Ae(),Ee(5,"li"),Ee(6,"kbd"),lt(7,"CMD"),Ae(),lt(8,"/"),Ee(9,"kbd"),lt(10,"CTRL"),Ae(),lt(11," + "),Ee(12,"kbd"),lt(13,"S"),Ae(),lt(14," = save"),Ae(),Ee(15,"li"),Ee(16,"kbd"),lt(17,"CMD"),Ae(),lt(18,"/"),Ee(19,"kbd"),lt(20,"CTRL"),Ae(),lt(21," + "),Ee(22,"kbd"),lt(23,"Z"),Ae(),lt(24," = undo"),Ae(),Ae(),Ae())}function I4(n,e){if(1&n){const t=B();ca(),fa(),Ee(0,"div",12),Ee(1,"label"),Ee(2,"input",13),fn("ngModelChange",function(i){return la(t),vo().keyMappingUpEnabled=i})("change",function(){return la(t),vo().toggleKeyUpMapping()}),Ae(),lt(3," Enable 'up' through every line "),Ae(),Ee(4,"label"),Ee(5,"input",13),fn("ngModelChange",function(i){return la(t),vo().keyMappingDownEnabled=i})("change",function(){return la(t),vo().toggleKeyDownMapping()}),Ae(),lt(6," Enable 'down' through every line "),Ae(),Ee(7,"label"),Ee(8,"label",14),lt(9,"Click "),Ee(10,"a",15),lt(11,"for more Vim keybindings"),Ae(),lt(12,"):"),Ae(),Ae(),Ae()}if(2&n){const t=vo();Ia(2),yo("ngModel",t.keyMappingUpEnabled),Ia(3),yo("ngModel",t.keyMappingDownEnabled)}}let O4=(()=>{class n{constructor(){this.isShortcutsListVisible=!1,this.isVimListVisible=!1,this.keyMappingUpEnabled=!1,this.keyMappingDownEnabled=!1,this.text="FADE IN:\n\nEXT. A CITY STREET - DAY\n\nCamera tracks down a snow-covered New York City street. We hold on a typical Brownstone. As we push in on an upstairs bedroom window, we hear the sounds of a video game in progress.\n\nA sick coughing sound is heard.\n\nINT. BROWNSTONE - BEDROOM\n\nThis kid lying in bed, coughing. Pale, one sick cookie. Maybe he's seven or eight or nine. He holds a remote in one hand, presses it, and the video game moves a little bit. Then he's hit by another spasm of coughing, sets the remote down.\n\nHis room is monochromatic, greys and blues, mildly high-tech. \n\nThe Kid's MOTHER enters, goes to him, fluffs his pillows, kisses him, and briefly feels his forehead. She's worried, it doesn't show. \n\nMOTHER\nYou feeling any better?\n\nTHE KID\nA little bit.\n\nMOTHER\nGuess what.\n\nTHE KID\nWhat?\n\nMOTHER\nYour grandfather's here.\n\nTHE KID\n(not overjoyed)\nMom, can't you tell him that I'm sick?\n\nMOTHER\nYou are sick, that's why he's here.\n\nTHE KID\nHe'll pinch my cheek. I hate that.\n\nMOTHER\nMaybe he won't.\n\nThe Kid shoots her an \"I'm sure\" look, as the Kid's GRANDFATHER bursts into the room. Kind of rumpled. But the eyes are bright. He has a wrapped package tucked under one arm as he immediately goes to The Kid, pinches his cheek.\n\nGRANDFATHER\nHey! How's the sickie? Heh?\n\nThe Kid gives his Mother an \"I told you so\" look. The Mother ignores it, beats a retreat.\n\nMOTHER\nI think I'll leave you two pals.\n\nAnd she is gone. There's an uncomfortable silence, then...\n\nGRANDFATHER\nI brought you a special present.\n\nTHE KID\nWhat is it?\n\nGRANDFATHER\nOpen it up.\n\nThe Kid does. He does his best to smile.\n\nTHE KID\nA book?\n\nGRANDFATHER\nThat's right. When I was your age, television was called books. And this is a special book. It was the book my father used to read to me when I was sick, and I used to read it to your father. And today, I'm gonna read it to you.\n\nTHE KID\nHas it got any sports in it?\n\nThe Grandfather suddenly passionate.\n\nGRANDFATHER\nAre you kidding? Fencing. Fighting. Torture. Revenge. Giants. Monsters. Chases. Escapes. True love. Miracles.  \n\t\nThe Grandfather sits in a chair by the bed.\n\t\nTHE KID\n(manages a shrug)\nIt doesn't sound too bad. I'll try and stay awake.\n\nGRANDFATHER\nOh. Well, thank you very much.  It's very nice of you. Your vote of confidence is overwhelming.  All right.  \n(he begins to read.) \nThe Princess Bride, by S.  Morgenstern. Chapter One.  Buttercup was raised on a small farm in the country of Florin.\n\nDISSOLVE TO:\n\nEXT. COUNTRYSIDE - DAY\nAs he reads, the monochromatic look of the bedroom is replaced by the dazzling color of the English countryside.\n\nGRANDFATHER (O.S.)\nHer favorite pastimes were riding her horse and tormenting the farm boy that worked there. His name was Westley, but she never called him that.\n(to the kid)\nIsn't that a wonderful beginning?\n\nTHE KID (O.S.)\n(doing his best)\nYeah. It's really good.\n\nGRANDFATHER (O.S.)\n(off-screen reading)\nNothing gave Buttercup as much pleasure as ordering Westley around."}toggleShortcutsList(){this.isShortcutsListVisible=!this.isShortcutsListVisible}toggleVimList(){this.isVimListVisible=!this.isVimListVisible}ngAfterViewInit(){this.editorView=this.setupEditor(),ir.map("jj","<Esc>","insert"),this.editorView.focus()}toggleKeyUpMapping(){this.keyMappingUpEnabled?ir.map("k","gk"):ir.unmap("k"),this.editorView.update([])}toggleKeyDownMapping(){this.keyMappingDownEnabled?ir.map("j","gj"):ir.unmap("j"),this.editorView.update([])}setupEditor(){const t=he.theme({"&":{margin:"auto"},"& .cm-line":{paddingLeft:"10em",paddingRight:"10em"},"&.cm-focused":{outline:"none"}}),r=vr.create({doc:this.text,extensions:[he.lineWrapping,new T3(EU),E4(),TU,Px(AU),t,lm.of([...RE,{key:"Mod-s",run:()=>(this.saveToFile(),!0)}])]});return new he({state:r,parent:this.editorContainer.nativeElement})}saveToFile(){if(this.editorView){const t=this.editorView.state.doc.toString();if(t){const r=new Blob([t],{type:"text/plain"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download="screenplay.fountain",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}else console.error("Editor content is empty.")}else console.error("Editor is not initialized.")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=lh({type:n,selectors:[["app-root"]],viewQuery:function(t,r){if(1&t&&Kb(k4,5),2&t){let i;qb(i=function(){return n=B(),e=Dv(),n[19].queries[e].queryList;var n,e}())&&(r.editorContainer=i.first)}},decls:20,vars:2,consts:[[1,"htmlContainer"],[1,"dropdown-container"],[1,"dropdown"],[1,"shortcut","filter-button",3,"click"],[1,"dropdown-arrow"],["focusable","false","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M7 10l5 5 5-5z"],["class","shortcuts-list",4,"ngIf"],["class","vim-list",4,"ngIf"],[1,"editContainer"],["editorContainer",""],[1,"shortcuts-list"],[1,"vim-list"],["type","checkbox",3,"ngModel","ngModelChange","change"],["for","inputField"],["href","https://codemirror.net/5/keymap/vim.js","target","_blank"]],template:function(t,r){1&t&&(Ee(0,"div",0),Ee(1,"h1"),lt(2,"Screen Writer + VIM "),Ae(),Ee(3,"div",1),Ee(4,"div",2),Ee(5,"button",3),fn("click",function(){return r.toggleShortcutsList()}),lt(6," Shortcuts "),Ee(7,"span",4),ca(),Ee(8,"svg",5),Bu(9,"path",6),Ae(),Ae(),Ae(),Fd(10,T4,25,0,"div",7),Ae(),fa(),Ee(11,"div",2),Ee(12,"button",3),fn("click",function(){return r.toggleVimList()}),lt(13," Vim Options "),Ee(14,"span",4),ca(),Ee(15,"svg",5),Bu(16,"path",6),Ae(),Ae(),Ae(),Fd(17,I4,13,2,"div",8),Ae(),Ae(),fa(),Bu(18,"section",9,10),Ae()),2&t&&(Ia(10),yo("ngIf",r.isShortcutsListVisible),Ia(7),yo("ngIf",r.isVimListVisible))},directives:[ZD,zp,H_,cg],styles:['h1[_ngcontent-%COMP%]{text-align:left;margin:.5em 0 .5em .5em;width:8.75em;letter-spacing:.05em;padding:0 0 0 .5em;font-size:2em;font-family:din-round,sans-serif;border:solid 3px black}.filter-button[_ngcontent-%COMP%], .shortcut[_ngcontent-%COMP%]{background-color:transparent;border:none;color:#3c4043;padding:8px 16px;border-radius:4px;font-size:14px;line-height:1.5;cursor:pointer;display:flex;align-items:center;transition:box-shadow .3s,background-color .3s}.filter-button[_ngcontent-%COMP%]{color:#3c4043;padding:8px 16px;border-radius:4px;font-size:14px;line-height:1.5;cursor:pointer;display:flex;align-items:center;border:2px solid black}.filter-button[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{margin-left:0}.filter-button[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#5f6368;width:20px;height:20px}.filter-button[_ngcontent-%COMP%], .shortcut[_ngcontent-%COMP%]{background-color:transparent;border:2px solid black;color:#3c4043;padding:8px 16px;border-radius:4px;font-size:14px;line-height:1.5;cursor:pointer;display:flex;align-items:center;transition:box-shadow .3s,background-color .3s}.filter-button[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%], .shortcut[_ngcontent-%COMP%]   .dropdown-arrow[_ngcontent-%COMP%]{margin-left:5px}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block;align-items:left}.dropdown-arrow[_ngcontent-%COMP%]{margin-left:5px;height:30px;line-height:30px;width:30px;display:flex;align-items:center;cursor:pointer}.dropdown-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#5f6368;width:100%;height:100%;pointer-events:none}.dropdown-container[_ngcontent-%COMP%]{display:flex;justify-content:start;margin:0 0 0 1em}.dropdown[_ngcontent-%COMP%]:hover   .shortcuts-list[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]:hover   .vim-list[_ngcontent-%COMP%]{display:block}.shortcut[_ngcontent-%COMP%]{align-items:center;appearance:button;border:solid transparent;border-radius:16px;border-width:0 0 4px;box-sizing:border-box;color:#000;cursor:pointer;display:flex;font-family:din-round,sans-serif;font-size:12px;font-weight:700;letter-spacing:.8px;line-height:10px;outline:none;overflow:visible;padding:0 16px;text-align:center;text-transform:uppercase;touch-action:manipulation;transform:translateZ(0);transition:filter .2s;-webkit-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;width:11em}.shortcut[_ngcontent-%COMP%]:after{background-clip:padding-box;border:solid transparent;border-radius:16px;border-width:0 0 4px;bottom:-4px;content:"";left:0;position:absolute;right:0;top:0;z-index:-1}.shortcut[_ngcontent-%COMP%]:main, .shortcut[_ngcontent-%COMP%]:focus{-webkit-user-select:auto;user-select:auto}.shortcut[_ngcontent-%COMP%]:disabled{cursor:auto}.shortcut[_ngcontent-%COMP%]:active{border-width:4px 0 0;background:none}.shortcuts-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0}.shortcuts-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px 0}.vim-list[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px;display:block}.editor-and-shortcuts[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.htmlContainer[_ngcontent-%COMP%]{position:relative}.editContainer[_ngcontent-%COMP%]{position:relative;z-index:1;font-size:20px;width:1300px;margin:auto;padding:0 4em}.shortcuts-list[_ngcontent-%COMP%], .vim-list[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;z-index:1000;width:260px;background-color:#fff;border:3px solid black;border-radius:0;padding:.5em 0 .5em .5em;display:none}']}),n})(),N4=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Di({type:n,bootstrap:[O4]}),n.\u0275inj=ii({providers:[],imports:[[n2,bH]]}),n})();AD=!1,e2().bootstrapModule(N4).catch(n=>console.error(n))}},xe=>{xe(xe.s=712)}]);